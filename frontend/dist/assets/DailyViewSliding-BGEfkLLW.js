import{o as c,d as u,e,u as me,i as ie,z as $,c as he,a as k,R as de,S as _e,a3 as pe,G as ce,U as W,m as se,q as d,x as j,g as r,L as g,f as D,v as fe,F as w,B as M,t as x,W as ee,M as V,V as E,N as ge,j as T,a4 as be,H as xe,C as te,J as ye,w as ne,a5 as ve}from"./index-DyikdeVs.js";import{s as we}from"./client-BmLc_bHX.js";import{r as ke}from"./program-BvKTe_J8.js";import{r as Ve,c as Se,e as $e,f as De,h as Me}from"./schedule-DRuf90Am.js";import{r as Ce}from"./MagnifyingGlassIcon-iw8J5XU6.js";function Ns(p,H){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}function js(p,H){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}function Ue(p,H){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"m5.433 13.917 1.262-3.155A4 4 0 0 1 7.58 9.42l6.92-6.918a2.121 2.121 0 0 1 3 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 0 1-.65-.65Z"}),e("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0 0 10 3H4.75A2.75 2.75 0 0 0 2 5.75v9.5A2.75 2.75 0 0 0 4.75 18h9.5A2.75 2.75 0 0 0 17 15.25V10a.75.75 0 0 0-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5Z"})])}function Es(p,H){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"})])}const Ie={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},Te={className:"border-b pb-2 mb-4"},He=e("h2",{class:"font-title font-bold"},"상담일정",-1),Le=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),Ne=[Le],je={class:"mb-4"},Ee=e("label",{class:"block text-sm font-medium text-gray-700"},"일정 유형",-1),Ae={class:"mt-2 flex gap-4"},Fe={class:"inline-flex items-center"},Oe=e("span",{class:"ml-2"},"재활",-1),ze={class:"inline-flex items-center"},Be=e("span",{class:"ml-2"},"상담/평가",-1),Ye={key:0,class:"grid gap-4"},qe={class:"mb-4"},Re=e("label",{for:"client-search",class:"block text-sm font-medium text-gray-700"},"내담자를 선택하세요.",-1),Ze={class:"relative mt-1"},Pe={class:"absolute inset-y-0 right-0 flex items-center pr-3"},We={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},Ge=["onClick"],Je={key:1,class:"absolute mt-2 text-sm text-gray-500"},Xe={class:"grid grid-cols-1 gap-4"},Qe={class:"mb-4"},Ke=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[T("상담사 "),e("span",{class:"text-red-500"},"*")],-1),et=e("option",{value:""},"상담사를 선택하세요.",-1),tt=["value"],st={key:1,class:"grid grid-cols-2 gap-4"},at=e("label",{class:"block mb-1 text-gray-700"},[T("내담자 이름 "),e("span",{class:"text-red-500"},"*")],-1),lt=e("label",{class:"block mb-1 text-gray-700"},[T("내담자 휴대전화번호 "),e("span",{class:"text-red-500"},"*")],-1),ot={key:2},nt={class:"mb-4"},rt=e("label",{for:"program_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[T("프로그램 "),e("span",{class:"text-red-500"},"*")],-1),it=e("option",{value:""},"프로그램을 선택하세요",-1),dt=["value"],ct={class:"mb-4"},ut=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"일정 반복 타입",-1),mt=e("option",{value:"1"},"매일",-1),ht=e("option",{value:"2"},"매주",-1),_t=e("option",{value:"3"},"매월",-1),pt={key:3,class:"mb-4"},ft=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"반복 요일",-1),gt={class:"flex gap-4 mt-2"},bt={class:"inline-flex items-center"},xt=e("span",{class:"ml-2"},"월",-1),yt={class:"inline-flex items-center"},vt=e("span",{class:"ml-2"},"화",-1),wt={class:"inline-flex items-center"},kt=e("span",{class:"ml-2"},"수",-1),Vt={class:"inline-flex items-center"},St=e("span",{class:"ml-2"},"목",-1),$t={class:"inline-flex items-center"},Dt=e("span",{class:"ml-2"},"금",-1),Mt={class:"inline-flex items-center"},Ct=e("span",{class:"ml-2"},"토",-1),Ut={class:"inline-flex items-center"},It=e("span",{class:"ml-2"},"일",-1),Tt={class:"grid grid-cols-2 gap-4"},Ht={class:"mb-4"},Lt=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[T("일정시작일 "),e("span",{class:"text-red-500"},"*")],-1),Nt={class:"mb-4 hidden"},jt=e("label",{for:"finish_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[T("일정종료일 "),e("span",{class:"text-red-500"},"*")],-1),Et={class:"grid grid-cols-2 gap-4"},At={class:"mb-4"},Ft=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[T("시작시간 "),e("span",{class:"text-red-500"},"*")],-1),Ot=["value"],zt={class:"mb-4"},Bt=e("label",{for:"finish_time",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[T("종료시간 "),e("span",{class:"text-red-500"},"*")],-1),Yt=["value"],qt=e("label",{class:"block mb-1 text-gray-700"},"메모",-1),Rt=e("div",{class:"text-right text-gray-500 text-sm"},"0 / 100",-1),Zt={class:"mb-4"},Pt=e("label",{for:"schedule_status",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"상태",-1),Wt=e("option",{value:"1"},"예정",-1),Gt=e("option",{value:"2"},"완료",-1),Jt=e("option",{value:"3"},"취소",-1),Xt={key:4,class:"mb-4"},Qt=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"일정 수정 범위",-1),Kt={class:"flex items-center space-x-4 mt-2"},es={class:"inline-flex items-center"},ts=e("span",{class:"ml-2"},"이번 일정만 변경",-1),ss={class:"inline-flex items-center"},as=e("span",{class:"ml-2"},"이후 반복일정 모두 변경",-1),ls={class:"flex justify-between mt-4"},os={class:"flex gap-2"},ns={type:"submit",class:"bg-green-600 text-white rounded-md p-2 w-[80px]"},As={__name:"ScheduleFormSliding",props:{isVisible:Boolean,scheduleId:String,scheduleListId:String,scheduleDate:{type:String,default:()=>{const p=new Date;return`${p.getFullYear()}-${String(p.getMonth()+1).padStart(2,"0")}-${String(p.getDate()).padStart(2,"0")}`}},scheduleTime:{type:String,default:()=>`${new Date().getHours().toString().padStart(2,"0")}:00}`}},emits:["close"],setup(p,{emit:H}){const A=me(),S=ie("showModal"),L=H,o=p,C=$(""),G=$([]),N=$([]),ae=$({}),q=$([]),R=$([]),F=new Date,le=async()=>{const l=C.value.toLowerCase();if(!l){N.value=[];return}try{const s=await we(l);G.value=s.data,N.value=G.value}catch(s){console.error("Error fetching clients:",s)}},oe=async l=>{if(ae.value=l,C.value=l.client_name,t.client_id=l.id,t.client_name=l.client_name,t.phone_number=l.phone_number,N.value=[],l.consultant)try{const s=await be(l.consultant);t.teacher_username=s.username,await z()}catch(s){console.error("Error fetching consultant info:",s)}},J=$([]),i=$([]),m=()=>{const l=[];let s=F;for(s.setHours(9,0,0,0);s.getHours()<18;)l.push(_(s)),s.setMinutes(s.getMinutes()+10);return l},_=l=>{const s=l.getHours().toString().padStart(2,"0"),a=l.getMinutes().toString().padStart(2,"0");return`${s}:${a}`};function h(l){if(!l){const v=new Date,I=v.getHours().toString().padStart(2,"0"),K=v.getMinutes();let Y;return K>=40?Y="40":K>=20?Y="20":Y="00",`${I}:${Y}`}const s=String(l);if(!s.includes(":")){const v=parseInt(s);return v<10?`0${v}:00`:`${s}:00`}const[a,f]=s.split(":"),y=parseInt(a);return y<10?`0${y}:${f}`:`${a}:${f}`}const b=(l=!1)=>{if(!t.start_time)return;const[s,a]=t.start_time.split(":").map(Number),f=new Date(F);f.setHours(s,a,0,0);const y=[],v=new Date(f);v.setHours(f.getHours()+1);let I=new Date(f);for(I.setMinutes(I.getMinutes()+10);I<=v;)y.push(_(I)),I.setMinutes(I.getMinutes()+10);if(i.value=y,!l&&!t.finish_time){const[K,Y]=t.start_time.split(":").map(Number),re=new Date;re.setHours(K,Y+50),t.finish_time=_(re)}},U=he({teacher_username:k().required("상담사를 선택해주세요."),client_name:k().required("내담자를 선택해주세요."),phone_number:k().required("휴대전화번호를 입력하세요."),program_id:k().when("teacher_username",{is:l=>l&&l.length>0,then:()=>k().required("프로그램을 선택해주세요."),otherwise:()=>k()}),start_date:k().required("일정시작일을 선택해주세요."),finish_date:k().transform((l,s,a)=>{var y;const f=(y=a==null?void 0:a.parent)==null?void 0:y.start_date;if(f){const v=new Date(f);return v.setFullYear(v.getFullYear()+1),v.toISOString().split("T")[0]}return l}),start_time:k().required("시작시간을 선택해주세요."),finish_time:k().required("종료시간을 선택해주세요."),repeat_type:k().required("반복 타입을 선택해주세요.")}),t=de({id:"",teacher_username:"",client_id:"",schedule_type:1,client_name:"",program_id:"",repeat_type:1,repeat_days:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1},schedule_status:1,start_date:o.scheduleDate,finish_date:o.scheduleDate,start_time:h(o.scheduleTime),finish_time:h(o.scheduleTime),memo:"",teacher:{},update_range:"single"}),n=()=>{L("close")},Z=l=>{const s=["sun","mon","tue","wed","thu","fri","sat"],a=new Date(l),f=s[a.getDay()];return{mon:f==="mon",tue:f==="tue",wed:f==="wed",thu:f==="thu",fri:f==="fri",sat:f==="sat",sun:f==="sun"}},X=l=>{const s={mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1};if(!l)return s;if(typeof l=="object"&&!Array.isArray(l))return l;if(typeof l=="string")try{return JSON.parse(l.replace(/'/g,'"').replace(/True/g,"true").replace(/False/g,"false"))}catch{return s}return s},P=()=>{t.id="",t.teacher_username="",t.client_id="",t.schedule_type=1,t.client_name="",t.program_id="",t.repeat_type=2,t.repeat_days=Z(o.scheduleDate),t.schedule_status=1,t.start_date=o.scheduleDate,t.finish_date=o.scheduleDate,t.start_time=o.scheduleTime?h(o.scheduleTime):h(F.getHours()),t.finish_time="",t.memo="",t.update_range="single"},O=async()=>{if(!o.scheduleListId){P(),b();return}try{const l=await Ve(o.scheduleListId),{clientinfo:s,teacher:a,schedule:f,...y}=l;Object.assign(t,y,f),t.memo=y.schedule_memo||"",t.schedule_type=f.schedule_type||1,t.client_name=(s==null?void 0:s.client_name)||"",t.phone_number=(s==null?void 0:s.phone_number)||"",t.teacher_username=(a==null?void 0:a.username)||"",t.start_time=y.schedule_time||h(F.getHours()),t.finish_time=y.schedule_finish_time||"",t.teacher_username&&await z(),b(!0),t.repeat_days=X(t.repeat_days)}catch(l){console.error("Error fetching schedule info:",l),S("일정 정보를 불러오는 중 오류가 발생했습니다.")}},Q=async()=>{try{const l=await xe();q.value=l.map(s=>({value:s.username,text:s.full_name}))}catch(l){console.error("Error fetching teacher list:",l)}},z=async()=>{try{const l=await ke(1,100,"",t.teacher_username);console.log("response:",l),R.value=l.items.map(s=>({value:s.id,text:s.program_name}))}catch(l){console.error("프로그램 목록 조회 중 오류:",l)}};_e(()=>{O(),Q()}),pe(()=>{if(C.value="",!t.start_date){const l=new Date().toISOString().split("T")[0];t.start_date=l,t.finish_date=l}t.start_time||(t.start_time=h(new Date().getHours())),t.start_time>="18:00"&&(t.start_time="17:50"),b()}),ce(()=>{J.value=m()});const B=async l=>{try{const s={...l,repeat_days:t.repeat_days,finish_date:new Date(new Date(l.start_date).setFullYear(new Date(l.start_date).getFullYear()+1)).toISOString().split("T")[0],update_range:t.update_range};if(delete s.created_at,delete s.updated_at,delete s.deleted_at,t.id){const a=t.update_range==="all"?"이 일정과 향후 모든 반복 일정이 수정됩니다. 계속하시겠습니까?":"이 일정만 수정됩니다. 계속하시겠습니까?";if(!confirm(a))return;await Se(t.id,o.scheduleListId,s),S("상담일정 정보가 수정되었습니다.")}else await $e(s),S("상담일정 정보가 등록되었습니다.");P()}catch(s){S("상담일정 정보 저장 중 오류가 발생했습니다."),console.error("Error registering schedule data:",s)}L("close")};W(()=>o.isVisible,l=>{l&&O()}),W(()=>o.scheduleListId,(l,s)=>{l!==s&&O()}),W(()=>o.scheduleDate,(l,s)=>{l!==s&&(t.start_date=l,t.finish_date=l,!o.scheduleListId&&l&&(t.repeat_days=Z(l)))}),W(()=>o.scheduleTime,l=>{l&&(t.start_time=h(l),b())});const ue=async()=>{try{if(!o.scheduleListId)return;const l=t.update_range==="all"?"이 일정과 향후 모든 반복 일정이 삭제됩니다. 계속하시겠습니까?":"이 일정만 삭제됩니다. 계속하시겠습니까?";if(!confirm(l))return;await De(t.id,o.scheduleListId,t.update_range),S("일정이 삭제되었습니다."),L("close")}catch(l){console.error("Error deleting schedule:",l),S("일정 삭제 중 오류가 발생했습니다.")}};return(l,s)=>(c(),u(w,null,[e("div",se({onClick:n},l.$attrs,{class:["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000 z-49",{"opacity-100 block":p.isVisible,"opacity-0 hidden":!p.isVisible}]}),null,16),e("div",se(l.$attrs,{class:["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!p.isVisible,"translate-x-0":p.isVisible}]}),[e("div",Ie,[e("div",Te,[e("div",{class:"flex items-center justify-evenly mb-2"},[He,e("button",{class:"ml-auto",onClick:n},Ne)]),d(r(ge),{onSubmit:B,"validation-schema":r(U),"initial-values":t,class:"space-y-4 text-sm"},{default:j(()=>[d(r(g),{type:"hidden",name:"id",modelValue:t.id,"onUpdate:modelValue":s[0]||(s[0]=a=>t.id=a)},null,8,["modelValue"]),d(r(g),{type:"hidden",name:"client_id",modelValue:t.client_id,"onUpdate:modelValue":s[1]||(s[1]=a=>t.client_id=a)},null,8,["modelValue"]),e("div",je,[Ee,e("div",Ae,[e("label",Fe,[d(r(g),{type:"radio",name:"schedule_type",value:1,modelValue:t.schedule_type,"onUpdate:modelValue":s[2]||(s[2]=a=>t.schedule_type=a),class:"form-radio text-indigo-600"},null,8,["modelValue"]),Oe]),e("label",ze,[d(r(g),{type:"radio",name:"schedule_type",value:2,modelValue:t.schedule_type,"onUpdate:modelValue":s[3]||(s[3]=a=>t.schedule_type=a),class:"form-radio text-indigo-600"},null,8,["modelValue"]),Be])])]),!o.scheduleId&&!o.scheduleListId?(c(),u("div",Ye,[e("div",qe,[Re,e("div",Ze,[D(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>C.value=a),onInput:le,type:"text",id:"client-search",placeholder:"내담자 검색...",class:"block w-full py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,544),[[fe,C.value]]),e("div",Pe,[d(r(Ce),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),e("div",null,[N.value.length>0?(c(),u("ul",We,[(c(!0),u(w,null,M(N.value,a=>(c(),u("li",{key:a.id,onClick:f=>oe(a),class:"cursor-pointer px-3 py-2 hover:bg-indigo-600 hover:text-white"},x(a.client_name),9,Ge))),128))])):(c(),u("p",Je,"검색 결과가 없습니다."))])])])])):ee("",!0),e("div",Xe,[e("div",Qe,[Ke,d(r(g),{name:"teacher_username",modelValue:t.teacher_username,"onUpdate:modelValue":s[5]||(s[5]=a=>t.teacher_username=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",onChange:z},{default:j(()=>[et,(c(!0),u(w,null,M(q.value,a=>(c(),u("option",{key:a.value,value:a.value},x(a.text),9,tt))),128))]),_:1},8,["modelValue"]),d(r(V),{name:"teacher_username",class:"text-red-500 text-xs italic mt-2"})])]),r(A).user.user_type==1&&r(A).user.is_superuser==1?(c(),u("div",st,[e("div",null,[at,d(r(g),{name:"client_name",as:"input",type:"text",modelValue:t.client_name,"onUpdate:modelValue":s[6]||(s[6]=a=>t.client_name=a),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 이름을 입력하세요."},null,8,["modelValue"]),d(r(V),{name:"client_name",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[lt,d(r(g),{name:"phone_number",as:"input",type:"text",modelValue:t.phone_number,"onUpdate:modelValue":s[7]||(s[7]=a=>t.phone_number=a),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 휴대전화번호를 입력하세요."},null,8,["modelValue"]),d(r(V),{name:"phone_number",class:"text-red-500 text-xs italic mt-2"})])])):(c(),u("div",ot,[d(r(g),{name:"client_name",type:"hidden",modelValue:t.client_name,"onUpdate:modelValue":s[8]||(s[8]=a=>t.client_name=a)},null,8,["modelValue"]),d(r(g),{name:"phone_number",type:"hidden",modelValue:t.phone_number,"onUpdate:modelValue":s[9]||(s[9]=a=>t.phone_number=a)},null,8,["modelValue"])])),e("div",null,[e("div",nt,[rt,d(r(g),{name:"program_id",modelValue:t.program_id,"onUpdate:modelValue":s[10]||(s[10]=a=>t.program_id=a),as:"select",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},{default:j(()=>[it,(c(!0),u(w,null,M(R.value,a=>(c(),u("option",{key:a.value,value:a.value},x(a.text),9,dt))),128))]),_:1},8,["modelValue"]),d(r(V),{name:"program_id",class:"text-red-500 text-xs italic mt-2"})])]),e("div",ct,[ut,d(r(g),{name:"repeat_type",modelValue:t.repeat_type,"onUpdate:modelValue":s[11]||(s[11]=a=>t.repeat_type=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:j(()=>[mt,ht,_t]),_:1},8,["modelValue"]),d(r(V),{name:"repeat_type",class:"text-red-500 text-xs italic mt-2"})]),t.repeat_type=="2"?(c(),u("div",pt,[ft,e("div",gt,[e("label",bt,[D(e("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=a=>t.repeat_days.mon=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[E,t.repeat_days.mon]]),xt]),e("label",yt,[D(e("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=a=>t.repeat_days.tue=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[E,t.repeat_days.tue]]),vt]),e("label",wt,[D(e("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=a=>t.repeat_days.wed=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[E,t.repeat_days.wed]]),kt]),e("label",Vt,[D(e("input",{type:"checkbox","onUpdate:modelValue":s[15]||(s[15]=a=>t.repeat_days.thu=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[E,t.repeat_days.thu]]),St]),e("label",$t,[D(e("input",{type:"checkbox","onUpdate:modelValue":s[16]||(s[16]=a=>t.repeat_days.fri=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[E,t.repeat_days.fri]]),Dt]),e("label",Mt,[D(e("input",{type:"checkbox","onUpdate:modelValue":s[17]||(s[17]=a=>t.repeat_days.sat=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[E,t.repeat_days.sat]]),Ct]),e("label",Ut,[D(e("input",{type:"checkbox","onUpdate:modelValue":s[18]||(s[18]=a=>t.repeat_days.sun=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[E,t.repeat_days.sun]]),It])])])):ee("",!0),e("div",Tt,[e("div",Ht,[Lt,d(r(g),{type:"date",name:"start_date",modelValue:t.start_date,"onUpdate:modelValue":s[19]||(s[19]=a=>t.start_date=a),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),d(r(V),{name:"start_date",class:"text-red-500 text-xs italic mt-2"})]),e("div",Nt,[jt,d(r(g),{type:"date",name:"finish_date",modelValue:t.finish_date,"onUpdate:modelValue":s[20]||(s[20]=a=>t.finish_date=a),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),d(r(V),{name:"finish_date",class:"text-red-500 text-xs italic mt-2"})])]),e("div",Et,[e("div",At,[Ft,d(r(g),{name:"start_time",id:"start_time",modelValue:t.start_time,"onUpdate:modelValue":s[21]||(s[21]=a=>t.start_time=a),as:"select",onChange:b,class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:j(()=>[(c(!0),u(w,null,M(J.value,a=>(c(),u("option",{key:a,value:a},x(a),9,Ot))),128))]),_:1},8,["modelValue"]),d(r(V),{name:"start_time",class:"text-red-500 text-xs italic mt-2"})]),e("div",zt,[Bt,d(r(g),{name:"finish_time",id:"finish_time",modelValue:t.finish_time,"onUpdate:modelValue":s[22]||(s[22]=a=>t.finish_time=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:j(()=>[(c(!0),u(w,null,M(i.value,a=>(c(),u("option",{key:a,value:a},x(a),9,Yt))),128))]),_:1},8,["modelValue"]),d(r(V),{name:"finish_time",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[qt,d(r(g),{name:"memo",as:"textarea",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",rows:"3",modelValue:t.memo,"onUpdate:modelValue":s[23]||(s[23]=a=>t.memo=a),placeholder:"내담자의 상담정보를 메모해보세요. 최대 100자 까지 입력하실 수 있습니다."},null,8,["modelValue"]),d(r(V),{name:"memo",class:"text-red-500 text-xs italic mt-2"}),Rt]),e("div",Zt,[Pt,d(r(g),{name:"schedule_status",id:"schedule_status",modelValue:t.schedule_status,"onUpdate:modelValue":s[24]||(s[24]=a=>t.schedule_status=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:j(()=>[Wt,Gt,Jt]),_:1},8,["modelValue"])]),o.scheduleId&&o.scheduleListId?(c(),u("div",Xt,[Qt,e("div",Kt,[e("label",es,[d(r(g),{type:"radio",name:"update_range",value:"single",modelValue:t.update_range,"onUpdate:modelValue":s[25]||(s[25]=a=>t.update_range=a),class:"form-radio"},null,8,["modelValue"]),ts]),e("label",ss,[d(r(g),{type:"radio",name:"update_range",value:"all",modelValue:t.update_range,"onUpdate:modelValue":s[26]||(s[26]=a=>t.update_range=a),class:"form-radio"},null,8,["modelValue"]),as])])])):ee("",!0),e("div",ls,[e("div",null,[e("button",{type:"button",onClick:n,class:"bg-gray-400 text-white rounded-md p-2 w-[80px]"}," 취소 ")]),e("div",os,[o.scheduleListId?(c(),u("button",{key:0,type:"button",onClick:ue,class:"bg-red-600 text-white rounded-md p-2 w-[80px]"}," 삭제 ")):ee("",!0),e("button",ns,x(o.scheduleListId?"수정":"등록"),1)])])]),_:1},8,["validation-schema","initial-values"])])])],16)],64))}},rs={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},is={className:"border-b pb-2 mb-4"},ds=e("h2",{class:"font-title font-bold"},"상담일정",-1),cs=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),us=[cs],ms={class:"text-lg font-semibold text-gray-500 flex items-center justify-center"},hs={class:"grid grid-cols-1"},_s={class:"w-12 text-xs font-semibold"},ps={class:"w-full min-h-24 relative"},fs=e("div",{class:"absolute left-0 w-full border-t border-gray-200 top-1/3"},null,-1),gs=e("div",{class:"absolute left-0 w-full border-t border-gray-200 top-2/3"},null,-1),bs={class:"relative w-full"},xs=["onClick"],ys=["onClick"],vs={class:"inline-block font-semibold"},ws={class:"ml-auto inline-block whitespace-nowrap overflow-hidden text-ellipsis"},ks={class:"transition-all duration-300 ease-in-out"},Vs=e("span",{class:"inline-block"},"상담사",-1),Ss={class:"ml-auto inline-block"},$s=e("span",{class:"inline-block"},"상담시간",-1),Ds={class:"ml-auto inline-block font-semibold"},Ms={class:"flex justify-center items-center px-1 h-8"},Cs=["onClick"],Fs={__name:"DailyViewSliding",props:{isDailyViewSlidingVisible:Boolean,scheduleDate:String,scheduleTime:String},emits:["close","clickCalendarSchedule"],setup(p,{emit:H}){ie("showModal");const A=p,S=H,L=$([]),o=de({}),C=(i,m,_)=>{console.log("zoom index:",i,"item_index:",m),_.stopPropagation(),o[i]||(o[i]={}),o[i][m]=!o[i][m],console.log("isZoomed:",o[i][m]),Object.keys(o).forEach(h=>{Object.keys(o[h]).forEach(b=>{h!==i&&b!==m&&(o[h][b]=!1)})}),console.log("isZoomed:",o[i][m])},G=(i,m,_)=>{S("clickCalendarSchedule",i,m,_)};function N(i){const m=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],_=new Date(i);return m[_.getDay()]}const ae=i=>{const m=i>=12?"PM":"AM";return`${i%12||12} ${m}`},q=()=>{S("close")},R=async()=>{if(!A.scheduleDate)return;const[i,m,_]=A.scheduleDate.split("-");try{const h=await Me(i,m,_);L.value=h.data,console.log("daily sliding schedule_data:",L.value)}catch(h){console.error("Error fetching monthly schedule data:",h)}};ce(()=>{R()}),W(()=>A.scheduleDate,(i,m)=>{i!==m&&R()});const F=(i,m)=>{const[_,h]=i.split(":").map(Number),[b,U]=m.split(":").map(Number);return(b-_)*60+(U-h)},le=i=>i.reduce((m,_,h)=>{const b=_.schedule_time,U=m.find(t=>t.some(n=>n.schedule_time===b));return U?U.push({..._,index:h}):m.push([{..._,index:h}]),m},[]),oe=(i,m)=>{const _=F(i,m),h=90;return _>=50?h:Math.max(_/50*h,30)},J=i=>{const[m,_]=i.split(":").map(Number),h=_,b=50/90;return h*(1/b)};return(i,m)=>(c(),u(w,null,[e("div",se({onClick:q,class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000 z-39"},i.$attrs,{class:{"opacity-100 block":p.isDailyViewSlidingVisible,"opacity-0 hidden":!p.isDailyViewSlidingVisible}}),null,16),e("div",se({class:"fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-40 transition-transform duration-1000 ease-in-out"},i.$attrs,{class:{"translate-x-full":!p.isDailyViewSlidingVisible,"translate-x-0":p.isDailyViewSlidingVisible}}),[e("div",rs,[e("div",is,[e("div",{class:"flex items-center justify-evenly mb-2"},[ds,e("button",{class:"ml-auto",onClick:q},us)]),e("div",null,[e("div",ms,[e("span",null,x(p.scheduleDate)+"("+x(N(p.scheduleDate))+")",1)])]),e("div",hs,[(c(!0),u(w,null,M(L.value,(_,h)=>(c(),u("div",{key:h,class:"flex text-gray-500 border-b min-h-24 flex items-center pl-2 divide-x divide-gray-300 w-full"},[e("div",_s,x(ae(h)),1),e("div",ps,[fs,gs,(c(!0),u(w,null,M(_,(b,U)=>(c(),u("div",{key:U,class:"flex-row items-center justify-between w-full"},[e("div",bs,[(c(!0),u(w,null,M(le(b),t=>(c(),u(w,{key:t[0].schedule_time},[(c(!0),u(w,null,M(t,(n,Z)=>{var X,P,O,Q,z;return c(),u("div",{key:n.index,class:te(["flex-row text-xs text-black border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(X=o[n.schedule_time])!=null&&X[n.index]?"scale-105":"scale-100"]]),style:ye({backgroundColor:(P=o[n.schedule_time])!=null&&P[n.index]?"rgb(255, 255, 255)":`${n.teacher_usercolor}`,position:"absolute",zIndex:(O=o[n.schedule_time])!=null&&O[n.index]?10:1,left:`${Z*15}%`,width:(Q=o[n.schedule_time])!=null&&Q[n.index]?"85%":`${85-Z*15}%`,height:`${oe(n.schedule_time,n.schedule_finish_time)}px`,top:`${J(n.schedule_time)}px`,right:"auto"}),onClick:ne(B=>C(n.schedule_time,n.index,B),["stop"])},[e("div",{class:te(["flex justify-between items-center px-1 h-6",{"line-through":n.schedule_status==="3"}]),onClick:ne(B=>C(n.schedule_time,n.index,B),["stop"])},[e("span",vs,x(n.schedule_time),1),e("span",ws," ["+x(n.client_name)+"] "+x(n.teacher_expertise),1)],10,ys),D(e("div",ks,[e("div",{class:te(["flex justify-between items-center px-1 h-6",{"line-through":n.schedule_status==="3"}])},[Vs,e("span",Ss,x(n.teacher_fullname),1)],2),e("div",{class:te(["flex justify-between items-center px-1 h-6",{"line-through":n.schedule_status==="3"}])},[$s,e("span",Ds,x(n.schedule_time)+" ~ "+x(n.schedule_finish_time),1)],2),e("div",Ms,[e("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:ne(B=>G(n.schedule_id,n.id,n.schedule_date),["stop"])},[d(r(Ue),{class:"w-4 h-4"})],8,Cs)])],512),[[ve,(z=o[n.schedule_time])==null?void 0:z[n.index]]])],14,xs)}),128))],64))),128))])]))),128))])]))),128))])])])],16)],64))}};export{As as _,Fs as a,js as b,Ue as c,Es as d,Ns as r};
