import{s as F,u as L,i as z,J as A,n as P,L as D,l as g,o as _,c as h,b as e,G as E,t as w,j as o,k as I,e as l,x as m,F as U,p as q,E as b,y as K,g as $,d as j,v as O,M as T,z as B,N as G}from"./index-ROuoOsid.js";import{_ as J}from"./PaginationView-TYKK9RVg.js";import{c as Q,a as u}from"./index.esm-M1_3KTZr.js";import{r as Z}from"./CheckIcon-n4r2g0cw.js";const H=async r=>{try{return(await F.post("/client",r)).data}catch(n){throw console.error("Error registering client info:",n),n}},R=async r=>{try{return(await F.get(`/client/${r}`)).data}catch(n){throw console.error("Error reading client info:",n),n}},N=async(r=1,n=10,d="")=>{try{return await F.get("/client",{params:{page:r,size:n,search_qry:d}})}catch(p){throw console.error("Error reading client infos:",p),p}},W=async(r,n)=>{try{return(await F.put(`/client/${r}/consultant_status/${n}`)).data}catch(d){throw console.error("Error updating client info:",d),d}},X={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},Y={className:"border-b pb-2 mb-4"},ee={class:"flex items-center justify-evenly mb-2"},te={class:"font-title font-bold"},se=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),ae=[se],oe=e("label",{class:"block mb-1 text-gray-700"},[$("상담사 "),e("span",{class:"text-red-500"},"*")],-1),le=e("option",{value:""},"상담사를 선택하세요.",-1),ne=["value"],re={class:"grid grid-cols-2 gap-4"},de=e("label",{class:"block mb-1 text-gray-700"},[$("내담자 이름 "),e("span",{class:"text-red-500"},"*")],-1),ie=e("label",{class:"block mb-1 text-gray-700"},[$("내담자 휴대전화번호 "),e("span",{class:"text-red-500"},"*")],-1),ce=e("label",{class:"block mb-1 text-gray-700"},"관련 태그 입력",-1),ue=e("label",{class:"block mb-1 text-gray-700"},"메모(주소소 문제)",-1),me=e("div",{class:"text-right text-gray-500 text-sm"},"0 / 100",-1),pe={class:"grid grid-cols-2 gap-4"},be=e("label",{class:"block mb-1 text-gray-700"},"생년월일",-1),ge=e("label",{class:"block mb-1 text-gray-700"},"성별",-1),_e=e("option",{value:""},"성별을 선택하세요.",-1),he=e("option",{value:"M"},"남성",-1),xe=e("option",{value:"F"},"여성",-1),ye=e("label",{class:"block mb-1 text-gray-700"},"이메일 주소",-1),ve=e("label",{class:"block mb-1 text-gray-700"},"주소",-1),fe={class:"grid grid-cols-2 gap-4"},we=e("label",{class:"block mb-1 text-gray-700"},[$("상담 신청 경로 "),e("span",{class:"text-red-500"},"*")],-1),ke=e("option",{value:""},"상담 신청 경로를 선택하세요.",-1),Ve=e("option",{value:"1"},"가족/지인추천",-1),$e=e("option",{value:"2"},"병원/상담센터를 통해",-1),Ce=e("option",{value:"3"},"PC/모바일광고",-1),Ie=e("option",{value:"4"},"카페/커뮤니티",-1),Ue=e("button",{type:"submit",class:"bg-green-600 text-white rounded-md p-2 w-[80px]"}," 확인 ",-1),Fe={__name:"ClientFormSliding",props:{isVisible:Boolean,clientId:String},emits:["close"],setup(r,{emit:n}){const d=L(),p=r,f=z("showModal"),x=n,k=Q({consultant:u().required("상담사를 선택하세요."),consultant_status:u().required("상담상태를 선택하세요."),client_name:u().required("내담자 이름을 입력하세요."),phone_number:u().required("내담자 휴대전화번호를 입력하세요."),tags:u(),memo:u().max(100,"최대 100자까지 입력할 수 있습니다."),birth_date:u(),gendar:u(),email_address:u().email("올바른 이메일 주소를 입력하세요."),address_region:u(),address_city:u(),family_members:u(),consultation_path:u().required("상담 신청 경로를 선택하세요."),center_username:u()}),a=A({consultant:"",consultant_status:"1",client_name:"",phone_number:"",tags:"",memo:"",birth_date:"",gender:"",email_address:"",address_region:"",address_city:"",family_members:"",consultation_path:"",center_username:d.user.center_username}),y=()=>{x("close")},v=async()=>{if(p.clientId){console.log("props.clientId: ",p.clientId);try{const i=await R(p.clientId);console.log("clientInfo:",i),Object.assign(a,i)}catch(i){console.error("Error fetching client:",i)}}},V=async()=>{try{await H(a),f("내담자 정보가 등록되었습니다.")}catch(i){f("내담자 정보 등록 중 오류가 발생했습니다."),console.error("Error registering client data:",i)}};P(()=>{v(),console.log("userStore.user.center_username 1111: ",d.user.center_username)});const M=async i=>{console.log("submitting:",i),Object.assign(a,i),await V(),x("close")};D(()=>p.clientId,(i,t)=>{i!==t&&v()});const S=g([{value:"field1",text:"Field 1"},{value:"field2",text:"Field 2"},{value:"field3",text:"Field 3"}]);return(i,t)=>(_(),h(U,null,[e("div",{onClick:y,class:E(["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000",{"opacity-100 block":r.isVisible,"opacity-0 hidden":!r.isVisible}])},null,2),e("div",{class:E(["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!r.isVisible,"translate-x-0":r.isVisible}])},[e("div",X,[e("div",Y,[e("div",ee,[e("h2",te,"내담자 등록 "+w(r.clientId),1),e("button",{class:"ml-auto",onClick:y},ae)]),o(l(K),{onSubmit:M,"validation-schema":l(k),"initial-values":a,class:"space-y-4 text-sm"},{default:I(()=>[o(l(m),{name:"family_members",as:"input",type:"hidden"}),o(l(m),{name:"center_username",as:"input",type:"hidden"}),e("div",null,[oe,o(l(m),{name:"consultant",modelValue:a.consultant,"onUpdate:modelValue":t[0]||(t[0]=s=>a.consultant=s),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:I(()=>[le,(_(!0),h(U,null,q(S.value,s=>(_(),h("option",{key:s.value,value:s.value},w(s.text),9,ne))),128))]),_:1},8,["modelValue"]),o(l(b),{name:"consultant_options",class:"text-red-500 text-xs italic mt-2"})]),e("div",re,[e("div",null,[de,o(l(m),{name:"client_name",as:"input",type:"text",modelValue:a.client_name,"onUpdate:modelValue":t[1]||(t[1]=s=>a.client_name=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 이름을 입력하세요."},null,8,["modelValue"]),o(l(b),{name:"client_name",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[ie,o(l(m),{name:"phone_number",as:"input",type:"text",modelValue:a.phone_number,"onUpdate:modelValue":t[2]||(t[2]=s=>a.phone_number=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 휴대전화번호를 입력하세요."},null,8,["modelValue"]),o(l(b),{name:"phone_number",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[ce,o(l(m),{name:"tags",as:"input",type:"text",modelValue:a.tags,"onUpdate:modelValue":t[3]||(t[3]=s=>a.tags=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),o(l(b),{name:"tags",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[ue,o(l(m),{name:"memo",as:"textarea",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",rows:"3",modelValue:a.memo,"onUpdate:modelValue":t[4]||(t[4]=s=>a.memo=s),placeholder:"내담자의 주소 문제를 메모해보세요. 최대 100자 까지 입력하실 수 있습니다."},null,8,["modelValue"]),o(l(b),{name:"memo",class:"text-red-500 text-xs italic mt-2"}),me]),e("div",pe,[e("div",null,[be,o(l(m),{name:"birth_date",as:"input",type:"date",modelValue:a.birth_date,"onUpdate:modelValue":t[5]||(t[5]=s=>a.birth_date=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"2000.01.01"},null,8,["modelValue"]),o(l(b),{name:"birth_date",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[ge,o(l(m),{modelValue:a.gender,"onUpdate:modelValue":t[6]||(t[6]=s=>a.gender=s),name:"gender",as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:I(()=>[_e,he,xe]),_:1},8,["modelValue"]),o(l(b),{name:"gender",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[ye,o(l(m),{name:"email_address",as:"input",type:"email",modelValue:a.email_address,"onUpdate:modelValue":t[7]||(t[7]=s=>a.email_address=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),o(l(b),{name:"email_address",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[ve,e("div",fe,[o(l(m),{name:"address_region",as:"input",modelValue:a.address_region,"onUpdate:modelValue":t[8]||(t[8]=s=>a.address_region=s),class:"bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),o(l(m),{name:"address_city",as:"input",modelValue:a.address_city,"onUpdate:modelValue":t[9]||(t[9]=s=>a.address_city=s),class:"bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"])]),o(l(b),{name:"address_region",class:"text-red-500 text-xs italic mt-2"}),o(l(b),{name:"address_city",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[we,o(l(m),{name:"consultation_path",as:"select",modelValue:a.consultation_path,"onUpdate:modelValue":t[10]||(t[10]=s=>a.consultation_path=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:I(()=>[ke,Ve,$e,Ce,Ie]),_:1},8,["modelValue"]),o(l(b),{name:"consultation_path",class:"text-red-500 text-xs italic mt-2"})]),e("div",{class:"flex justify-between mt-4"},[e("button",{type:"button",onClick:y,class:"bg-gray-400 text-white rounded-md p-2 w-[80px]"}," 취소 "),Ue])]),_:1},8,["validation-schema","initial-values"])])])],2)],64))}},Me=e("section",null,[e("div",{class:"w-full sm:container"},[e("div",{class:"border-black border-l-[5px] pl-5"},[e("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"내담자 관리")])])],-1),Se={class:"lg:flex lg:items-center lg:justify-between mb-2"},Ee={class:"min-w-0 flex-1"},je={class:"relative"},Be=e("div",{class:"absolute inset-y-0 rtl:inset-r-0 start-0 flex items-center ps-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1),Ne={class:"mt-5 flex lg:ml-4 lg:mt-0"},ze={class:"sm:ml-3"},Pe={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},qe={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},Le=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"내담자명"),e("th",{scope:"col",class:"px-6 py-3"},"내담자 휴대전화"),e("th",{scope:"col",class:"px-6 py-3"},"내담자 이메일"),e("th",{scope:"col",class:"px-6 py-3"},"상담사"),e("th",{scope:"col",class:"px-6 py-3"},"상담상태"),e("th",{scope:"col",class:"px-6 py-3"},"Action")])],-1),Ae={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},De={class:"px-6 py-4"},Ke={class:"px-6 py-4"},Oe={class:"px-6 py-4"},Te={key:0,class:"flex items-center"},Ge={key:1,class:"flex items-center"},Je=["onClick"],Qe={class:"px-6 py-4"},Ze=["onUpdate:modelValue","onChange"],He=e("option",{value:"1"},"상담진행",-1),Re=e("option",{value:"2"},"상담보류",-1),We=e("option",{value:"3"},"상담종결",-1),Xe=[He,Re,We],Ye={class:"px-6 py-4"},et={class:"flex items-center space-x-2"},tt=["onClick"],st=e("a",{href:"#",class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"상담관리",-1),rt={__name:"ClientList",setup(r){const n=z("showModal"),d=g(1),p=g(10),f=g(0),x=g(!1),k=g(""),a=g(""),y=g([]),v=t=>{k.value=String(t),x.value=!x.value,x.value||(k.value="",V(d.value))},V=async t=>{const s=await N(t);y.value=s.items,d.value=s.page,p.value=s.size,f.value=s.total},M=async()=>{try{const t=await N(1,10,a.value);y.value=t.items,d.value=t.page,p.value=t.size,f.value=t.total}catch(t){console.error("Error fetching clients:",t)}},S=t=>{V(t),d.value=t},i=async t=>{console.log("client:",t);try{await W(t.id,t.consultant_status),n("상담상태 정보가 수정되었습니다.")}catch(s){n("상담상태 정보 등록 중 오류가 발생했습니다."),console.error("Error registering client data:",s)}};return P(V),(t,s)=>(_(),h(U,null,[Me,e("div",Se,[e("div",Ee,[e("div",je,[Be,j(e("input",{type:"text",id:"table-search-users",name:"search-text","onUpdate:modelValue":s[0]||(s[0]=c=>a.value=c),class:"block pt-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"내담자 검색",onKeyup:T(M,["enter"])},null,544),[[O,a.value]])])]),e("div",Ne,[e("span",ze,[e("button",{type:"button",onClick:v,class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[o(l(Z),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),$(" 내담자 등록 ")])])])]),e("div",Pe,[e("table",qe,[Le,e("tbody",null,[(_(!0),h(U,null,q(y.value,c=>(_(),h("tr",{key:c.id,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("th",Ae,w(c.client_name),1),e("td",De,w(c.phone_number),1),e("td",Ke,w(c.email_address),1),e("td",Oe,[c.consultant?(_(),h("div",Te,w(c.consultant),1)):B("",!0),c.consultant?B("",!0):(_(),h("div",Ge,[e("button",{class:"text-blue-600 dark:text-blue-500 hover:underline font-semibold border py-1 px-3 rounded-lg bg-blue-100 dark:bg-blue-800 dark:border-blue-600 dark:hover:bg-blue-700 dark:hover:border-blue-700 dark:text-white dark:hover:text-white dark:hover:bg-blue-700 dark:hover:border-blue-700",onClick:C=>v(c.id)}," 상담자배정 ",8,Je)]))]),e("td",Qe,[j(e("select",{class:"w-24 bg-gray-100 border border-gray-300 rounded-md px-2","onUpdate:modelValue":C=>c.consultant_status=C,onChange:C=>i(c)},Xe,40,Ze),[[G,c.consultant_status]])]),e("td",Ye,[e("div",et,[e("a",{href:"#",onClick:C=>v(c.id),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"내담자정보",8,tt),st])])]))),128))])]),o(J,{"total-items":f.value,"current-page":d.value,"items-per-page":p.value,onPageChanged:S},null,8,["total-items","current-page","items-per-page"]),o(Fe,{isVisible:x.value,clientId:k.value,onClose:v},null,8,["isVisible","clientId"])])],64))}};export{rt as default};
