import{l as V,z as h,A as f,G as Y,O as E,x as G,o as a,e as t,t as i,d as n,B as S,C as N,F as D}from"./index-DyikdeVs.js";import{M as R}from"./MobileLayout-CeX199-E.js";import{g as W}from"./schedule-DRuf90Am.js";import{u as q}from"./teacherStore-BQywt_cN.js";const H={class:"p-4"},J={class:"bg-white rounded-lg shadow-sm p-4 mb-4"},K={class:"flex items-center justify-between"},Q=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})],-1),U=[Q],X={class:"font-semibold text-lg"},Z=t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-5 h-5"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1),ee=[Z],te={class:"bg-white rounded-lg shadow-sm p-4 mb-4"},se=t("div",{class:"grid grid-cols-7 gap-1 mb-2"},[t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"일"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"월"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"화"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"수"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"목"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"금"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"토")],-1),oe={class:"grid grid-cols-7 gap-1"},ae=["onClick"],ne={class:"bg-white rounded-lg shadow-sm p-4"},le=t("h3",{class:"font-semibold text-lg mb-3"},"일정 목록",-1),re={key:0,class:"text-center py-8"},ce=t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),ie=t("p",{class:"mt-2 text-sm text-gray-500"},"일정을 불러오는 중...",-1),de=[ce,ie],ue={key:1,class:"text-center py-8"},he={class:"text-red-500 mb-2"},ge={key:2,class:"text-center py-8 text-gray-500"},ve={key:3,class:"space-y-3"},pe=["onClick"],ye={class:"text-sm text-gray-500"},me={class:"font-semibold"},xe={class:"text-sm text-gray-600 mt-1"},Me={__name:"ScheduleView",setup(_e){const m=V(),x=q(),c=h(new Date),b=h(new Date),l=h([]),_=h(!1),g=h(""),M=f(()=>{const e=c.value;return`${e.getFullYear()}년 ${String(e.getMonth()+1).padStart(2,"0")}월`}),v=f(()=>{const e=c.value;return{year:e.getFullYear(),month:e.getMonth()+1}}),k=f(()=>{const e=v.value.year,r=v.value.month,s=new Date(e,r-1,1),F=new Date(e,r,0).getDate(),L=s.getDay(),d=[],$=new Date().toISOString().split("T")[0],j=new Date(e,r-2,0);for(let o=L-1;o>=0;o--){const u=new Date(e,r-2,j.getDate()-o);d.push({date:u.toISOString().split("T")[0],day:u.getDate(),isCurrentMonth:!1,isToday:!1,isSelected:!1,hasSchedule:!1})}for(let o=1;o<=F;o++){const y=new Date(e,r-1,o).toISOString().split("T")[0];d.push({date:y,day:o,isCurrentMonth:!0,isToday:y===$,isSelected:y===b.value.toISOString().split("T")[0],hasSchedule:l.value.some(P=>P.date===y)})}const z=42-d.length;for(let o=1;o<=z;o++){const u=new Date(e,r,o);d.push({date:u.toISOString().split("T")[0],day:o,isCurrentMonth:!1,isToday:!1,isSelected:!1,hasSchedule:!1})}return d}),C=()=>{const e=new Date(c.value);e.setMonth(e.getMonth()-1),c.value=e,p()},T=()=>{const e=new Date(c.value);e.setMonth(e.getMonth()+1),c.value=e,p()},B=e=>{b.value=new Date(e),m.push({name:"MobileScheduleList",params:{date:e}})},O=()=>{},I=()=>{m.push({name:"MobileScheduleForm"})},A=e=>{m.push({name:"MobileScheduleDetail",params:{id:e.id}})},p=async()=>{_.value=!0,g.value="";try{(!x.selectedTeachers||x.selectedTeachers.length===0)&&x.loadSelectedTeachers();const e=await W(v.value.year,v.value.month);Array.isArray(e)?l.value=e:e&&e.data?l.value=Array.isArray(e.data)?e.data:[]:l.value=[]}catch(e){console.error("일정 조회 오류:",e),e.response&&e.response.status!==401&&(g.value="일정을 불러오는 중 오류가 발생했습니다."),l.value=[]}finally{_.value=!1}};return Y(()=>{p()}),(e,r)=>(a(),E(R,{"header-title":"일정","show-menu":!0,"show-plus":!0,"active-tab":"calendar",onMenu:O,onPlus:I},{default:G(()=>[t("div",H,[t("div",J,[t("div",K,[t("button",{onClick:C,class:"p-2"},U),t("h2",X,i(M.value),1),t("button",{onClick:T,class:"p-2"},ee)])]),t("div",te,[se,t("div",oe,[(a(!0),n(D,null,S(k.value,s=>(a(),n("div",{key:s.date,onClick:w=>B(s.date),class:N(["text-center py-2 rounded-lg cursor-pointer text-sm",s.isCurrentMonth?"text-gray-900":"text-gray-400",s.isToday?"bg-blue-100 text-blue-600 font-semibold":"",s.isSelected?"bg-blue-600 text-white font-semibold":"",s.hasSchedule?"font-semibold":""])},i(s.day),11,ae))),128))])]),t("div",ne,[le,_.value?(a(),n("div",re,de)):g.value?(a(),n("div",ue,[t("p",he,i(g.value),1),t("button",{onClick:p,class:"text-blue-600 hover:text-blue-800 text-sm font-semibold"}," 다시 시도 ")])):l.value.length===0?(a(),n("div",ge," 등록된 일정이 없습니다. ")):(a(),n("div",ve,[(a(!0),n(D,null,S(l.value,s=>(a(),n("div",{key:s.id,onClick:w=>A(s),class:"border-l-4 border-blue-600 pl-4 py-2 cursor-pointer hover:bg-gray-50 rounded-r-lg"},[t("div",ye,i(s.time),1),t("div",me,i(s.title),1),t("div",xe,i(s.content),1)],8,pe))),128))]))])])]),_:1}))}};export{Me as default};
