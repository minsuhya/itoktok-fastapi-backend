import{l as z,z as m,A as b,G as P,O as V,x as $,o,e as t,d as n,B as S,C as E,t as d,F as D}from"./index-DyikdeVs.js";import{M as G}from"./MobileLayout-CeX199-E.js";import{g as H}from"./schedule-DRuf90Am.js";import{u as N}from"./teacherStore-BQywt_cN.js";const R={class:"p-4"},W={class:"bg-white rounded-lg shadow-sm p-4 mb-4"},Y=t("div",{class:"grid grid-cols-7 gap-1 mb-2"},[t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"일"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"월"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"화"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"수"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"목"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"금"),t("div",{class:"text-center text-xs font-semibold text-gray-500 py-2"},"토")],-1),j={class:"grid grid-cols-7 gap-1"},q=["onClick"],J={class:"bg-white rounded-lg shadow-sm p-4"},K=t("h3",{class:"font-semibold text-lg mb-3"},"일정 목록",-1),Q={key:0,class:"text-center py-8"},U=t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"},null,-1),X=t("p",{class:"mt-2 text-sm text-gray-500"},"일정을 불러오는 중...",-1),Z=[U,X],ee={key:1,class:"text-center py-8"},te={class:"text-red-500 mb-2"},se={key:2,class:"text-center py-8 text-gray-500"},ae={key:3,class:"space-y-3"},oe=["onClick"],ne={class:"text-sm text-gray-500"},le={class:"font-semibold"},re={class:"text-sm text-gray-600 mt-1"},me={__name:"HomeView",setup(ce){const p=z(),x=N(),g=m(new Date),l=m([]),v=m(!1),u=m(""),h=b(()=>{const e=g.value;return{year:e.getFullYear(),month:e.getMonth()+1}}),w=b(()=>{const e=h.value.year,r=h.value.month,s=new Date(e,r-1,1),O=new Date(e,r,0).getDate(),I=s.getDay(),c=[],A=new Date().toISOString().split("T")[0],B=new Date(e,r-2,0);for(let a=I-1;a>=0;a--){const i=new Date(e,r-2,B.getDate()-a);c.push({date:i.toISOString().split("T")[0],day:i.getDate(),isCurrentMonth:!1,isToday:!1,isSelected:!1,hasSchedule:!1})}for(let a=1;a<=O;a++){const y=new Date(e,r-1,a).toISOString().split("T")[0];c.push({date:y,day:a,isCurrentMonth:!0,isToday:y===A,isSelected:y===g.value.toISOString().split("T")[0],hasSchedule:l.value.some(L=>L.date===y)})}const F=42-c.length;for(let a=1;a<=F;a++){const i=new Date(e,r,a);c.push({date:i.toISOString().split("T")[0],day:a,isCurrentMonth:!1,isToday:!1,isSelected:!1,hasSchedule:!1})}return c}),M=e=>{g.value=new Date(e),p.push({name:"MobileScheduleList",params:{date:e}})},k=()=>{},C=()=>{p.push({name:"MobileScheduleForm"})},T=e=>{p.push({name:"MobileScheduleDetail",params:{id:e.id}})},_=async()=>{v.value=!0,u.value="";try{(!x.selectedTeachers||x.selectedTeachers.length===0)&&x.loadSelectedTeachers();const e=await H(h.value.year,h.value.month);Array.isArray(e)?l.value=e:e&&e.data?l.value=Array.isArray(e.data)?e.data:[]:l.value=[]}catch(e){console.error("일정 조회 오류:",e),e.response&&e.response.status!==401&&(u.value="일정을 불러오는 중 오류가 발생했습니다."),l.value=[]}finally{v.value=!1}};return P(()=>{_()}),(e,r)=>(o(),V(G,{"header-title":"2023년 09월","show-menu":!0,"show-plus":!0,"active-tab":"home",onMenu:k,onPlus:C},{default:$(()=>[t("div",R,[t("div",W,[Y,t("div",j,[(o(!0),n(D,null,S(w.value,s=>(o(),n("div",{key:s.date,onClick:f=>M(s.date),class:E(["text-center py-2 rounded-lg cursor-pointer text-sm",s.isCurrentMonth?"text-gray-900":"text-gray-400",s.isToday?"bg-blue-100 text-blue-600 font-semibold":"",s.isSelected?"bg-blue-600 text-white font-semibold":"",s.hasSchedule?"font-semibold":""])},d(s.day),11,q))),128))])]),t("div",J,[K,v.value?(o(),n("div",Q,Z)):u.value?(o(),n("div",ee,[t("p",te,d(u.value),1),t("button",{onClick:_,class:"text-blue-600 hover:text-blue-800 text-sm font-semibold"}," 다시 시도 ")])):l.value.length===0?(o(),n("div",se," 등록된 일정이 없습니다. ")):(o(),n("div",ae,[(o(!0),n(D,null,S(l.value,s=>(o(),n("div",{key:s.id,onClick:f=>T(s),class:"border-l-4 border-blue-600 pl-4 py-2 cursor-pointer hover:bg-gray-50 rounded-r-lg"},[t("div",ne,d(s.time),1),t("div",le,d(s.title),1),t("div",re,d(s.content),1)],8,oe))),128))]))])])]),_:1}))}};export{me as default};
