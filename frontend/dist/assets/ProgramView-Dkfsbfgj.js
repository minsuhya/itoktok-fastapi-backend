import{i as S,y as p,c as A,a as x,V as U,P as T,W as q,o as h,d as b,e,m as I,t as _,q as d,x as C,g as c,D as k,O as P,E as j,F as $,A as B,G as z,j as M,Q as O,f as N,v as K,$ as G,w as D}from"./index-CLeev8Ch.js";import{a as L,u as Q,c as W,r as F,d as Z}from"./program-C2YD2jlZ.js";import{r as H}from"./CheckIcon-w0ttoPCB.js";const J={class:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},R={class:"border-b pb-2 mb-4"},X={class:"flex items-center justify-between mb-2"},Y={class:"font-title font-bold"},ee=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),se=[ee],te={class:"space-y-4 text-sm"},ae=e("label",{class:"block mb-1 text-gray-700"},[M("프로그램 유형 "),e("span",{class:"text-red-500"},"*")],-1),re=e("option",{value:""},"프로그램 유형을 선택하세요",-1),oe=e("option",{value:"미술"},"미술",-1),le=e("option",{value:"음악"},"음악",-1),ne=e("option",{value:"무용"},"무용",-1),ie=e("option",{value:"기타"},"기타",-1),ce=e("label",{class:"block mb-1 text-gray-700"},[M("프로그램명 "),e("span",{class:"text-red-500"},"*")],-1),de=e("label",{class:"block mb-1 text-gray-700"},"담당 선생님",-1),ue={class:"mb-2"},me={class:"inline-flex items-center"},pe=e("span",{class:"ml-2"},"전체 선생님",-1),ge=e("option",{value:""},"담당 선생님을 선택하세요",-1),_e=["value"],he={class:"flex justify-between pt-4"},be={type:"submit",class:"bg-blue-600 text-white rounded-md px-4 py-2 hover:bg-blue-700"},ve={__name:"ProgramFormSliding",props:{isVisible:Boolean,programId:String},emits:["close"],setup(E,{emit:y}){const n=S("showModal"),o=E,u=y,g=p([]),i=p(!1),f=A({program_type:x().required("프로그램 유형을 선택하세요"),program_name:x().required("프로그램명을 입력하세요"),teacher_username:x().when("is_all_teachers",{is:!1,then:()=>x().required("담당 선생님을 선택하세요"),otherwise:()=>x().nullable()})}),a=U({program_type:"",program_name:"",is_all_teachers:!1,teacher_username:"",description:"",duration:60,max_participants:1,price:0}),V=t=>{const s=t.target.checked;s&&(a.teacher_username=null),a.is_all_teachers=s,i.value=s,console.log("formData.is_all_teachers:",a.is_all_teachers)},v=async()=>{try{const t=await O();g.value=t,console.log("teachers",g.value)}catch(t){console.error("Error fetching teachers:",t),n("선생님 목록을 불러오는데 실패했습니다.")}},w=async()=>{if(!o.programId){Object.assign(a,{program_type:"",program_name:"",is_all_teachers:!1,teacher_username:"",description:"",duration:60,max_participants:1,price:0}),i.value=!1;return}try{const t=await L(o.programId);Object.assign(a,t),i.value=a.is_all_teachers,console.log("loadProgram:",a)}catch(t){console.error("Error fetching program:",t),n("프로그램 정보를 불러오는데 실패했습니다.")}},r=async t=>{try{const s={...t,is_all_teachers:i.value,teacher_username:i.value?null:t.teacher_username};o.programId?(await Q(o.programId,s),n("프로그램이 수정되었습니다.")):(await W(s),n("프로그램이 등록되었습니다.")),u("close")}catch(s){console.error("Error saving program:",s),n("프로그램 저장 중 오류가 발생했습니다.")}};return T(()=>{v(),w()}),q(()=>o.isVisible,t=>{t&&(o.programId?(w(),console.log("프로그램 데이터 로드:",a)):(Object.assign(a,{program_type:"",program_name:"",is_all_teachers:!1,teacher_username:"",description:"",duration:60,max_participants:1,price:0}),i.value=!1,console.log("폼 초기화:",a)))}),(t,s)=>(h(),b($,null,[e("div",I(t.$attrs,{onClick:s[0]||(s[0]=m=>u("close")),class:["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000",{"opacity-100 block":o.isVisible,"opacity-0 hidden":!o.isVisible}]}),null,16),e("div",I(t.$attrs,{class:["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!o.isVisible,"translate-x-0":o.isVisible}]}),[e("div",J,[e("div",R,[e("div",X,[e("h2",Y,_(o.programId?"프로그램 수정":"프로그램 등록"),1),e("button",{class:"ml-auto",onClick:s[1]||(s[1]=m=>u("close"))},se)]),d(c(z),{onSubmit:r,"validation-schema":c(f),"initial-values":a},{default:C(({errors:m})=>[e("div",te,[e("div",null,[ae,d(c(k),{name:"program_type",as:"select",class:P(["w-full bg-neutral-50 border border-gray-300 rounded-md p-2",{"border-red-500":m.program_type}]),modelValue:a.program_type,"onUpdate:modelValue":s[2]||(s[2]=l=>a.program_type=l)},{default:C(()=>[re,oe,le,ne,ie]),_:2},1032,["modelValue","class"]),d(c(j),{name:"program_type",class:"text-red-500 text-xs mt-1"})]),e("div",null,[ce,d(c(k),{name:"program_name",type:"text",class:P(["w-full bg-neutral-50 border border-gray-300 rounded-md p-2",{"border-red-500":m.program_name}]),modelValue:a.program_name,"onUpdate:modelValue":s[3]||(s[3]=l=>a.program_name=l),placeholder:"프로그램명을 입력하세요"},null,8,["modelValue","class"]),d(c(j),{name:"program_name",class:"text-red-500 text-xs mt-1"})]),e("div",null,[de,e("div",ue,[e("label",me,[d(c(k),{name:"is_all_teachers",type:"checkbox",onChange:V,modelValue:a.is_all_teachers,"onUpdate:modelValue":s[4]||(s[4]=l=>a.is_all_teachers=l),value:!0},null,8,["modelValue"]),pe])]),d(c(k),{name:"teacher_username",as:"select",class:P(["w-full bg-neutral-50 border border-gray-300 rounded-md p-2",{"border-red-500":m.teacher_username}]),modelValue:a.teacher_username,"onUpdate:modelValue":s[5]||(s[5]=l=>a.teacher_username=l),disabled:i.value},{default:C(()=>[ge,(h(!0),b($,null,B(g.value,l=>(h(),b("option",{key:l.username,value:l.username},_(l.full_name),9,_e))),128))]),_:2},1032,["modelValue","class","disabled"]),d(c(j),{name:"teacher_username",class:"text-red-500 text-xs mt-1"})]),e("div",he,[e("button",{type:"button",onClick:s[6]||(s[6]=l=>u("close")),class:"bg-gray-400 text-white rounded-md px-4 py-2 hover:bg-gray-500"}," 취소 "),e("button",be,_(o.programId?"수정":"등록"),1)])])]),_:1},8,["validation-schema","initial-values"])])])],16)],64))}},xe=e("section",null,[e("div",{class:"w-full sm:container"},[e("div",{class:"border-black border-l-[5px] pl-5"},[e("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"프로그램 관리")])])],-1),ye={class:"lg:flex lg:items-center lg:justify-between mb-2"},fe={class:"min-w-0 flex-1"},we={class:"relative"},ke=e("div",{class:"absolute inset-y-0 rtl:inset-r-0 start-0 flex items-center ps-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1),$e={class:"mt-5 flex lg:ml-4 lg:mt-0"},Ve={class:"sm:ml-3"},Ce={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},Pe={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},je=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"프로그램 유형"),e("th",{scope:"col",class:"px-6 py-3"},"프로그램명"),e("th",{scope:"col",class:"px-6 py-3"},"담당 선생님"),e("th",{scope:"col",class:"px-6 py-3"},"등록일"),e("th",{scope:"col",class:"px-6 py-3"},"Action")])],-1),Me={class:"px-6 py-4"},Ee={class:"px-6 py-4"},Ie={class:"px-6 py-4"},De={class:"px-6 py-4"},Fe={class:"px-6 py-4"},Se={class:"flex items-center space-x-2"},Te=["onClick"],Be=["onClick"],ze={__name:"ProgramView",setup(E){const y=S("showModal"),n=p(!1),o=p(""),u=p(""),g=p([]),i=p(1),f=p(10),a=(r="")=>{n.value=!n.value,o.value=r?String(r):"",n.value||v()},V=async()=>{try{const r=await F(i.value,f.value,u.value);g.value=r.items}catch(r){console.error("Error searching programs:",r)}},v=async()=>{try{const r=await F(i.value,f.value);console.log("response:",r),g.value=r.items}catch(r){console.error("Error fetching programs:",r)}},w=async r=>{if(confirm("프로그램을 삭제하시겠습니까?"))try{await Z(r),y("프로그램이 삭제되었습니다."),v()}catch(t){console.error("Error deleting program:",t),y("프로그램 삭제 중 오류가 발생했습니다.")}};return T(v),(r,t)=>(h(),b($,null,[xe,e("div",ye,[e("div",fe,[e("div",we,[ke,N(e("input",{type:"text",id:"table-search-users","onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),name:"search-text",class:"block pt-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"프로그램 검색",onKeyup:G(V,["enter"])},null,544),[[K,u.value]])])]),e("div",$e,[e("span",Ve,[e("button",{type:"button",onClick:t[1]||(t[1]=s=>a()),class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[d(c(H),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),M(" 프로그램 등록 ")])])])]),e("div",Ce,[e("table",Pe,[je,e("tbody",null,[(h(!0),b($,null,B(g.value,s=>{var m;return h(),b("tr",{key:s.id,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("td",Me,_(s.program_type),1),e("td",Ee,_(s.program_name),1),e("td",Ie,_(s.is_all_teachers?"전체":(m=s.teacher)==null?void 0:m.full_name),1),e("td",De,_(s.created_at),1),e("td",Fe,[e("div",Se,[e("a",{href:"#",onClick:D(l=>a(s.id),["prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"}," 수정 ",8,Te),e("a",{href:"#",onClick:D(l=>w(s.id),["prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"}," 삭제 ",8,Be)])])])}),128))])])]),d(ve,{"is-visible":n.value,"program-id":o.value,onClose:a},null,8,["is-visible","program-id"])],64))}};export{ze as default};
