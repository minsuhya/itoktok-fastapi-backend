import{o as _,d as w,e as t,V as P,y as v,z as G,W as B,r as Q,q as m,x as z,O as k,g as y,t as d,F as j,A as T,B as R,S as U,w as f,j as X,H as K}from"./index-DKmjRwNS.js";import{_ as ee,a as te,g as se,r as le,b as oe,c as ne,d as ae,e as re}from"./DailyViewSliding-2KpxxwFg.js";import{u as ce,a as ie}from"./teacherStore-C4-Ezgdg.js";import"./client-DEiPUpvg.js";import"./program-BfI7pwnr.js";function ue(O,C){return _(),w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"fill-rule":"evenodd",d:"M8.75 1A2.75 2.75 0 0 0 6 3.75v.443c-.795.077-1.584.176-2.365.298a.75.75 0 1 0 .23 1.482l.149-.022.841 10.518A2.75 2.75 0 0 0 7.596 19h4.807a2.75 2.75 0 0 0 2.742-2.53l.841-10.52.149.023a.75.75 0 0 0 .23-1.482A41.03 41.03 0 0 0 14 4.193V3.75A2.75 2.75 0 0 0 11.25 1h-2.5ZM10 4c.84 0 1.673.025 2.5.075V3.75c0-.69-.56-1.25-1.25-1.25h-2.5c-.69 0-1.25.56-1.25 1.25v.325C8.327 4.025 9.16 4 10 4ZM8.58 7.72a.75.75 0 0 0-1.5.06l.3 7.5a.75.75 0 1 0 1.5-.06l-.3-7.5Zm4.34.06a.75.75 0 1 0-1.5-.06l-.3 7.5a.75.75 0 1 0 1.5.06l.3-7.5Z","clip-rule":"evenodd"})])}const de=t("section",null,[t("div",{class:"w-full sm:container"},[t("div",{class:"border-black border-l-[5px] pl-5"},[t("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"월간 일정")])])],-1),he={class:"max-w-full mx-auto p-4"},me={class:"flex justify-between items-center mb-4"},ve={class:"inline-flex rounded-lg border border-gray-200 bg-white p-1"},fe=t("span",{class:"text-sm font-medium"}," 주간 ",-1),pe=t("span",{class:"text-sm font-medium"}," 월간 ",-1),be={class:"flex items-center space-x-2"},ge={class:"text-xl font-semibold"},_e={class:"flex space-x-2 text-sm font-semibold"},we=t("span",null,"Today",-1),xe=[we],ke=R('<div class="grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-hidden text-sm"><div class="bg-white py-2 text-center text-sm font-medium">Mon</div><div class="bg-white py-2 text-center text-sm font-medium">Tue</div><div class="bg-white py-2 text-center text-sm font-medium">Wed</div><div class="bg-white py-2 text-center text-sm font-medium">Thu</div><div class="bg-white py-2 text-center text-sm font-medium">Fri</div><div class="bg-white py-2 text-center text-sm font-medium">Sat</div><div class="bg-white py-2 text-center text-sm font-medium">Sun</div></div>',1),ye={class:"grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-y-auto max-h-[calc(100vh-200px)] text-sm"},Ce=["onClick"],Me=["onClick"],Se=["onClick"],De={class:"inline-block"},$e={class:"ml-auto inline-block"},Ve=["onClick"],Ye=t("span",{class:"inline-block"},"상담사",-1),Fe={class:"ml-auto inline-block"},Ne=["onClick"],je=t("span",{class:"inline-block"},"상담시간",-1),Ae={class:"ml-auto inline-block"},Ee=["onClick"],Ie=["onClick"],Be=["onClick"],ze=["onClick"],We={__name:"MonthlyView",setup(O){const C=ce(),Z=ie(),u=P({}),M=v(!1),S=v(!1),V=v(""),Y=v(""),p=v(""),x=(e,s,n)=>{n.stopPropagation(),u[e]||(u[e]={}),u[e][s]=!u[e][s],Object.keys(u).forEach(l=>{Object.keys(u[l]).forEach(o=>{l!==e&&o!==s&&(u[l][o]=!1)})});const a=n.target.closest(".relative");if(a){const l=a.parentElement.children;for(let o of l)o!==a&&(o.style.display=u[e][s]?"none":"")}},D=()=>{M.value=!M.value,M.value||(V.value="",Y.value="",p.value=""),h(r.value.currentYear,r.value.currentMonth)},A=()=>{S.value=!S.value,S.value||(p.value=""),h(r.value.currentYear,r.value.currentMonth)},L=e=>{p.value=e,A()},J=e=>{p.value=e,D()},E=(e,s,n)=>{V.value=String(e),Y.value=String(s),p.value=n,D()},W=async e=>{if(confirm("해당 일정을 삭제하시겠습니까?")&&e)try{await re(e),h(r.value.currentYear,r.value.currentMonth)}catch(s){console.error("Error deleting schedule:",s)}},F=["January","February","March","April","May","June","July","August","September","October","November","December"],N=v([]),r=v({}),$=v(""),q=e=>{const s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${s}-${n}-${a}`};$.value=q(new Date),console.log("today:",$.value);const H=(e,s)=>{const n=new Date(e,s,1),a=n.getFullYear(),l=n.getMonth()+1;let o=a,c=l-1;c===0&&(c=12,o-=1);let b=a,g=l+1;return g===13&&(g=1,b+=1),console.log("currentYear:",a,"currentMonth:",l),{currentDate:n,currentYear:a,currentMonth:l,currentMonthName:F[l-1],prevYear:o,prevMonth:c,prevMonthName:F[c-1],nextYear:b,nextMonth:g,nextMonthName:F[g-1]}},h=async(e,s)=>{e||(e=new Date().getFullYear()),s||(s=new Date().getMonth()+1);try{const n=await se(e,s);Object.keys(n.data).forEach(a=>{n.data[a].sort((l,o)=>{const c=new Date(`2000-01-01 ${l.start_time}`),b=new Date(`2000-01-01 ${o.start_time}`);return c-b})}),N.value=n.data,I(e,s-1),console.log("schedule_data:",N.value)}catch(n){console.error("Error fetching monthly schedule data:",n)}},I=(e,s)=>{r.value=H(e,s)};return G(()=>{const e=new Date().getFullYear(),s=new Date().getMonth();I(e,s),h(r.value.currentYear,r.value.currentMonth)}),B(()=>C.selectedDate,e=>{e&&h(e.getFullYear(),e.getMonth()+1)}),B(()=>Z.selectedTeachers,e=>{e&&h(C.selectedDate.getFullYear(),C.selectedDate.getMonth()+1)}),(e,s)=>{const n=Q("router-link");return _(),w(j,null,[de,t("div",he,[t("div",me,[t("div",ve,[m(n,{to:"/admin/weekly",class:k(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/weekly"}])},{default:z(()=>[fe]),_:1},8,["class"]),m(n,{to:"/admin/monthly",class:k(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/monthly"||e.$route.path==="/admin"}])},{default:z(()=>[pe]),_:1},8,["class"])]),t("div",be,[t("button",{class:"p-2 rounded-full font-semibold",onClick:s[0]||(s[0]=a=>h(r.value.prevYear,r.value.prevMonth))},[m(y(le),{class:"w-6 h-6"})]),t("h2",ge,d(r.value.currentMonthName)+" "+d(r.value.currentYear),1),t("button",{class:"p-2 rounded-full font-semibold",onClick:s[1]||(s[1]=a=>h(r.value.nextYear,r.value.nextMonth))},[m(y(oe),{class:"w-6 h-6"})])]),t("div",_e,[t("button",{class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center",onClick:s[2]||(s[2]=a=>h())},xe),t("button",{class:"px-4 py-2 bg-blue-500 text-white rounded-md",onClick:D}," 상담 등록 ")])]),ke,t("div",ye,[(_(!0),w(j,null,T(N.value,(a,l)=>(_(),w("div",{class:k(["h-32 p-2",l===$.value?"bg-yellow-100":"bg-white"]),key:l,onClick:o=>J(l)},[t("span",{class:k({"block text-sm bg-sky-500 text-white ring rounded-full font-semibold w-5 text-center":l===$.value})},d(l.split("-")[2]),3),(_(!0),w(j,null,T(a.slice(0,2),(o,c)=>{var b,g;return _(),w("div",{class:k(["relative flex-row text-xs text-black border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(b=u[l])!=null&&b[c]?"scale-105 h-auto min-h-6 w-full pt-1":"scale-100 h-6"]]),key:c,style:U({backgroundColor:(g=u[l])!=null&&g[c]?"rgba(255, 255, 255, 1)":o.teacher_usercolor}),onClick:f(i=>x(l,c,i),["stop"])},[t("div",{class:"flex justify-between items-center px-1 h-full w-full",onClick:f(i=>x(l,c,i),["stop"])},[t("span",De,d(o.schedule_time),1),t("span",$e,"["+d(o.client_name)+"] "+d(o.program_name.length>10?o.program_name.slice(0,10)+"...":o.program_name),1)],8,Se),t("div",{class:"flex justify-between items-center px-1 h-full w-full",onClick:f(i=>x(l,c,i),["stop"])},[Ye,t("span",Fe,d(o.teacher_fullname),1)],8,Ve),t("div",{class:"flex justify-between items-center px-1 h-full w-full",onClick:f(i=>x(l,c,i),["stop"])},[je,t("span",Ae,d(o.start_time)+" ~ "+d(o.finish_time),1)],8,Ne),t("div",{class:"flex justify-center items-center px-1 h-full w-full",onClick:f(i=>x(l,c,i),["stop"])},[t("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:f(i=>E(o.schedule_id,o.id,o.schedule_date),["stop"])},[m(y(ne),{class:"w-4 h-4"})],8,Ie),t("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:f(i=>W(o.id),["stop"])},[m(y(ue),{class:"w-4 h-4"})],8,Be)],8,Ee)],14,Me)}),128)),a.length>2?(_(),w("div",{key:0,class:"mt-4 flex items-center justify-center text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:f(o=>L(l),["stop"])},[m(y(ae),{class:"w-4 h-4"}),X(" "+d(a.length-2)+" more ",1)],8,ze)):K("",!0)],10,Ce))),128))]),m(ee,{isVisible:M.value,scheduleId:V.value,scheduleListId:Y.value,scheduleDate:p.value,onClose:D,class:"z-20"},null,8,["isVisible","scheduleId","scheduleListId","scheduleDate"]),m(te,{isDailyViewSlidingVisible:S.value,scheduleDate:p.value,onClose:A,onClickCalendarSchedule:E,class:"z-10"},null,8,["isDailyViewSlidingVisible","scheduleDate"])])],64)}}};export{We as default};
