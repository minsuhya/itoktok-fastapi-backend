import{S as ae,y as w,z as oe,U as R,r as re,o as u,d as h,e as s,q as f,x as q,O as _,w as D,g as p,t as d,F as x,A as y,j as P,R as ne,H as ce}from"./index-C8JNOHQq.js";import{_ as ie,a as de,h as ue,r as he,b as be,c as ge,d as fe,e as pe,f as ve}from"./DailyViewSliding-CuqycyUP.js";import{u as me,a as we}from"./teacherStore-CiNX_JwY.js";import"./client-C0SgaBTb.js";import"./program-D-3ClrrB.js";const ke=s("section",null,[s("div",{class:"w-full sm:container"},[s("div",{class:"border-black border-l-[5px] pl-5"},[s("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"주간 일정")])])],-1),De={class:"max-w-full mx-auto p-4"},xe={class:"flex justify-between items-center"},_e={class:"inline-flex rounded-lg border border-gray-200 bg-white p-1"},ye=s("span",{class:"text-sm font-medium"}," 주간 ",-1),Se=s("span",{class:"text-sm font-medium"}," 월간 ",-1),Ce={class:"flex items-center space-x-2"},$e={class:"text-xl font-semibold"},Me={class:"flex space-x-2 text-sm font-semibold"},Ve=s("span",null,"Today",-1),Te=[Ve],Ye={class:"not-prose relative bg-slate-50 rounded-xl overflow-hidden w-full mx-auto dark:bg-slate-800/25"},Ee={class:"relative rounded-xl overflow-auto"},Fe={class:"mx-4 my-4 box-content bg-white dark:bg-slate-800 shadow-xl overflow-hidden"},je={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 h-auto"},ze=s("div",{class:"row-start-[1] col-start-[1] sticky top-0 bg-white dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2"},null,-1),We={class:"sm:inline-block rounded-full bg-slate-400 w-5 h-5 text-white font-semibold"},Be={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 max-h-full h-full"},Ne={class:"flex-row h-full"},He=["onClick"],Le=s("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[30px]"},null,-1),Oe=s("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[60px]"},null,-1),Ae=["onClick"],Ie={class:"flex justify-between items-center px-1 h-full w-full"},Re={class:"inline-block"},qe={class:"ml-auto inline-block whitespace-nowrap overflow-hidden text-ellipsis"},Pe={class:"flex justify-between items-center px-1 h-full w-full"},Ue=s("span",{class:"inline-block"},"상담사",-1),Ze={class:"ml-auto inline-block"},Ge={class:"flex justify-between items-center px-1 h-full w-full"},Je=s("span",{class:"inline-block"},"상담시간",-1),Ke={class:"ml-auto inline-block"},Qe={class:"flex justify-center items-center px-1 h-full w-full"},Xe=["onClick"],et=["onClick"],tt=["onClick"],st=s("div",{class:"absolute inset-0 pointer-events-none border border-black/5 rounded-xl dark:border-white/5"},null,-1),it={__name:"WeeklyView",setup(lt){const S=me(),U=we(),b=ae({}),C=w(!1),$=w(!1),E=w(""),z=w(""),v=w(""),k=w(""),F=w([]),r=w({}),M=new Date,Z=["Mon","Tue","Web","Thu","Fri","Sat","Sun"],G=(e,t,l,a)=>{a.stopPropagation(),b[e]||(b[e]={}),b[e][t]||(b[e][t]={}),b[e][t][l]=!b[e][t][l];const o=a.target.closest(".relative");if(o){const i=o.parentElement.children;for(let n of i)n!==o&&(n.style.display=b[e][t][l]?"none":"")}};function J(e){return e<10?`0${e}:00`:`${e}:00`}const V=e=>{const t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${l}-${a}`},K=e=>{const t=[];for(let l=0;l<7;l++){const a=new Date(e);a.setDate(e.getDate()+l);const o=a.getDay()-1;t.push({date:V(a),day:Z[o===-1?6:o]})}return t},T=()=>{C.value=!C.value,C.value||(E.value="",v.value="",k.value="",g(r.value.currentYear,r.value.currentMonth,r.value.currentDay))},W=()=>{$.value=!$.value,$.value||(v.value="",k.value="",g(r.value.currentYear,r.value.currentMonth,r.value.currentDay))},Q=e=>{v.value=e,W()},X=(e,t,l)=>{const a=l.target.getBoundingClientRect(),o=l.clientY-a.top,i=a.height;let n=0;o<i/3?n=0:o<i*2/3?n=20:n=40,v.value=e,k.value=`${t}:${n.toString().padStart(2,"0")}`,T(),console.log("currentScheduleTime:",k.value)},B=(e,t,l)=>{E.value=String(e),z.value=String(t),v.value=l,T()},ee=async e=>{if(confirm("해당 일정을 삭제하시겠습니까?")&&e)try{await ve(e),g(r.value.currentYear,r.value.currentMonth)}catch(t){console.error("Error deleting schedule:",t)}},g=async(e,t,l)=>{e=e||new Date().getFullYear(),t=t||new Date().getMonth()+1,l=l||new Date().getDate(),console.log("year:",e,"month:",t,"day:",l);try{const a=await ue(e,t,l);F.value=a.data,Y(e,t-1,l),console.log("schedule_data:",F.value)}catch(a){console.error("Error fetching monthly schedule data:",a)}},te=(e,t,l)=>{const a=new Date(e,t,l);console.log("date:",a);let o=a.getDay();o=o===0?6:o-1;const i=new Date(a);i.setDate(a.getDate()-o);const n=new Date(i);n.setDate(i.getDate()+6);const c=new Date(i);c.setDate(i.getDate()-1);const m=new Date(n);return m.setDate(n.getDate()+1),{currentYear:e,currentMonth:t+1,currentDay:l,weekStartDate:i,weekEndDate:n,prevStartDate:c,nextEndDate:m}},se=()=>{const e=r.value.prevStartDate.getFullYear(),t=r.value.prevStartDate.getMonth()+1,l=r.value.prevStartDate.getDate();Y(e,t,l),g(e,t,l)},le=()=>{const e=r.value.nextEndDate.getFullYear(),t=r.value.nextEndDate.getMonth()+1,l=r.value.nextEndDate.getDate();Y(e,t,l),g(e,t,l)},Y=(e,t,l)=>{r.value=te(e,t,l),r.value.weekDates=K(r.value.weekStartDate),console.log("set Date Info - currentDateInfo:",r.value)};return oe(()=>{v.value=V(new Date),k.value=J(new Date().getHours());const e=new Date().getFullYear(),t=new Date().getMonth()+1,l=new Date().getDate();Y(e,t,l),g(e,t,l)}),R(()=>S.selectedDate,e=>{e&&g(e.getFullYear(),e.getMonth()+1,e.getDate())}),R(()=>U.selectedTeachers,e=>{e&&g(S.selectedDate.getFullYear(),S.selectedDate.getMonth()+1,S.selectedDate.getDate())}),(e,t)=>{const l=re("router-link");return u(),h(x,null,[ke,s("div",De,[s("div",xe,[s("div",_e,[f(l,{to:"/admin/weekly",class:_(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/weekly"}])},{default:q(()=>[ye]),_:1},8,["class"]),f(l,{to:"/admin/monthly",class:_(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/monthly"}])},{default:q(()=>[Se]),_:1},8,["class"])]),s("div",Ce,[s("button",{onClick:t[0]||(t[0]=D(a=>se(),["stop"])),class:"p-2 rounded-full font-semibold"},[f(p(he),{class:"w-6 h-6"})]),s("h2",$e,d(V(r.value.weekStartDate))+" ~ "+d(V(r.value.weekEndDate)),1),s("button",{onClick:t[1]||(t[1]=D(a=>le(),["stop"])),class:"p-2 rounded-full font-semibold"},[f(p(be),{class:"w-6 h-6"})])]),s("div",Me,[s("button",{onClick:t[2]||(t[2]=a=>g(p(M).getFullYear(),p(M).getMonth()+1,p(M).getDate())),class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center"},Te),s("button",{onClick:T,class:"px-4 py-2 bg-blue-500 text-white rounded-md"}," 상담 등록 ")])])]),s("div",Ye,[s("div",Ee,[s("div",Fe,[s("div",je,[ze,(u(!0),h(x,null,y(r.value.weekDates,(a,o)=>(u(),h("div",{key:o,class:_(["row-start-[1] col-start-[{{ index + 2 }}] sticky top-0 dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2 text-center",a.date===p(M).toISOString().split("T")[0]?"bg-yellow-100":"bg-white"])},[s("span",We,d(a.date.split("-")[2]),1),P(" "+d(a.day),1)],2))),128))]),s("div",Be,[s("div",Ne,[(u(),h(x,null,y(11,a=>s("div",{key:a,class:"h-[90px] border-slate-100 dark:border-slate-200/5 border-r text-xs p-1.5 text-right text-slate-400 uppercase sticky left-0 bg-white dark:bg-slate-800 font-medium"},d(a+7)+" AM ",1)),64))]),(u(!0),h(x,null,y(F.value,(a,o)=>(u(),h("div",{key:o,class:"flex-row h-full items-center text-center border-slate-100 dark:border-slate-200/5 border-r divide-y divide-slate-100 dark:divide-slate-200"},[(u(!0),h(x,null,y(a,(i,n)=>(u(),h("div",{key:n,onClick:c=>X(o,n,c),class:_(["h-[90px] text-xs text-slate-400 font-medium p-[1px] relative",o===new Date().toISOString().split("T")[0]?"bg-yellow-100":""])},[Le,Oe,(u(!0),h(x,null,y(i.slice(0,2),(c,m)=>{var N,H,L,O,A,I;return u(),h("div",{class:_(["relative flex-row text-xs text-blue-600 border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(H=(N=b[o])==null?void 0:N[n])!=null&&H[m]?"scale-105 h-auto min-h-6 w-full pt-1 border-blue-700":"scale-100 h-6"]]),key:m,style:ne({backgroundColor:(O=(L=b[o])==null?void 0:L[n])!=null&&O[m]?"rgba(255, 255, 255, 1)":c.teacher_usercolor,zIndex:(I=(A=b[o])==null?void 0:A[n])!=null&&I[m]?10:1}),onClick:D(j=>G(o,n,m,j),["stop"])},[s("div",Ie,[s("span",Re,d(c.schedule_time),1),s("span",qe,"["+d(c.client_name)+"] "+d(c.program_name.length>10?c.program_name.slice(0,10)+"...":c.program_name),1)]),s("div",Pe,[Ue,s("span",Ze,d(c.teacher_fullname),1)]),s("div",Ge,[Je,s("span",Ke,d(c.start_time)+" ~ "+d(c.finish_time),1)]),s("div",Qe,[s("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:D(j=>B(c.schedule_id,c.id,c.schedule_date),["stop"])},[f(p(ge),{class:"w-4 h-4"})],8,Xe),s("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:D(j=>ee(c.id),["stop"])},[f(p(fe),{class:"w-4 h-4"})],8,et)])],14,Ae)}),128)),i.length>2?(u(),h("div",{key:0,class:"flex items-center justify-center ml-auto w-6 h-5 text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 bg-blue-400/20",onClick:D(c=>Q(o),["stop"])},[f(p(pe),{class:"w-5 h-4"}),P(" "+d(i.length-2),1)],8,tt)):ce("",!0)],10,He))),128))]))),128))])])]),st,f(ie,{isVisible:C.value,scheduleId:E.value,scheduleListId:z.value,scheduleDate:v.value,scheduleTime:k.value,onClose:T,class:"z-20"},null,8,["isVisible","scheduleId","scheduleListId","scheduleDate","scheduleTime"]),f(de,{isDailyViewSlidingVisible:$.value,scheduleDate:v.value,scheduleTime:k.value,onClose:W,onClickCalendarSchedule:B,class:"z-10"},null,8,["isDailyViewSlidingVisible","scheduleDate","scheduleTime"])])],64)}}};export{it as default};
