import{O as te,y as m,z as se,r as le,o as u,d as h,e as s,q as g,x as I,N as _,w as x,g as f,t as d,F as D,A as y,j as P,P as ae,H as oe}from"./index-Cmu6_IW5.js";import{_ as ne,a as re,h as ce,r as ie,b as de,c as ue,d as he,e as be,f as ge}from"./DailyViewSliding-Wsuv_Bz2.js";import"./client-CwkPjKvS.js";import"./program-apE7yaer.js";const fe=s("section",null,[s("div",{class:"w-full sm:container"},[s("div",{class:"border-black border-l-[5px] pl-5"},[s("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"주간 일정")])])],-1),ve={class:"max-w-full mx-auto p-4"},pe={class:"flex justify-between items-center"},me={class:"inline-flex rounded-lg border border-gray-200 bg-white p-1"},we=s("span",{class:"text-sm font-medium"}," 주간 ",-1),ke=s("span",{class:"text-sm font-medium"}," 월간 ",-1),xe={class:"flex items-center space-x-2"},De={class:"text-xl font-semibold"},_e={class:"flex space-x-2 text-sm font-semibold"},ye=s("span",null,"Today",-1),Se=[ye],Ce={class:"not-prose relative bg-slate-50 rounded-xl overflow-hidden w-full mx-auto dark:bg-slate-800/25"},$e={class:"relative rounded-xl overflow-auto"},Ve={class:"mx-4 my-4 box-content bg-white dark:bg-slate-800 shadow-xl overflow-hidden"},Me={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 h-auto"},Te=s("div",{class:"row-start-[1] col-start-[1] sticky top-0 bg-white dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2"},null,-1),Ee={class:"sm:inline-block rounded-full bg-slate-400 w-5 h-5 text-white font-semibold"},Ye={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 max-h-full h-full"},Fe={class:"flex-row h-full"},je=["onClick"],ze=s("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[30px]"},null,-1),Ne=s("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[60px]"},null,-1),We=["onClick"],Be={class:"flex justify-between items-center px-1 h-full w-full"},He={class:"inline-block"},Le={class:"ml-auto inline-block whitespace-nowrap overflow-hidden text-ellipsis"},Oe={class:"flex justify-between items-center px-1 h-full w-full"},Ae=s("span",{class:"inline-block"},"상담사",-1),Ie={class:"ml-auto inline-block"},Pe={class:"flex justify-between items-center px-1 h-full w-full"},qe=s("span",{class:"inline-block"},"상담시간",-1),Re={class:"ml-auto inline-block"},Ze={class:"flex justify-center items-center px-1 h-full w-full"},Ge=["onClick"],Je=["onClick"],Ke=["onClick"],Qe=s("div",{class:"absolute inset-0 pointer-events-none border border-black/5 rounded-xl dark:border-white/5"},null,-1),lt={__name:"WeeklyView",setup(Ue){const b=te({}),S=m(!1),C=m(!1),E=m(""),j=m(""),v=m(""),w=m(""),Y=m([]),n=m({}),$=new Date,q=["Mon","Tue","Web","Thu","Fri","Sat","Sun"],R=(e,t,l,a)=>{a.stopPropagation(),b[e]||(b[e]={}),b[e][t]||(b[e][t]={}),b[e][t][l]=!b[e][t][l];const o=a.target.closest(".relative");if(o){const i=o.parentElement.children;for(let r of i)r!==o&&(r.style.display=b[e][t][l]?"none":"")}};function Z(e){return e<10?`0${e}:00`:`${e}:00`}const V=e=>{const t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${l}-${a}`},G=e=>{const t=[];for(let l=0;l<7;l++){const a=new Date(e);a.setDate(e.getDate()+l);const o=a.getDay()-1;t.push({date:V(a),day:q[o===-1?6:o]})}return t},M=()=>{S.value=!S.value,S.value||(E.value="",v.value="",w.value="",k(n.value.currentYear,n.value.currentMonth,n.value.currentDay))},z=()=>{C.value=!C.value,C.value||(v.value="",w.value="",k(n.value.currentYear,n.value.currentMonth,n.value.currentDay))},J=e=>{v.value=e,z()},K=(e,t,l)=>{const a=l.target.getBoundingClientRect(),o=l.clientY-a.top,i=a.height;let r=0;o<i/3?r=0:o<i*2/3?r=20:r=40,v.value=e,w.value=`${t}:${r.toString().padStart(2,"0")}`,M(),console.log("currentScheduleTime:",w.value)},N=(e,t,l)=>{E.value=String(e),j.value=String(t),v.value=l,M()},Q=async e=>{if(confirm("해당 일정을 삭제하시겠습니까?")&&e)try{await ge(e),k(n.value.currentYear,n.value.currentMonth)}catch(t){console.error("Error deleting schedule:",t)}},k=async(e,t,l)=>{e=e||new Date().getFullYear(),t=t||new Date().getMonth()+1,l=l||new Date().getDate(),console.log("year:",e,"month:",t,"day:",l);try{const a=await ce(e,t,l);Y.value=a.data,T(e,t-1,l),console.log("schedule_data:",Y.value)}catch(a){console.error("Error fetching monthly schedule data:",a)}},U=(e,t,l)=>{const a=new Date(e,t,l);console.log("date:",a);let o=a.getDay();o=o===0?6:o-1;const i=new Date(a);i.setDate(a.getDate()-o);const r=new Date(i);r.setDate(i.getDate()+6);const c=new Date(i);c.setDate(i.getDate()-1);const p=new Date(r);return p.setDate(r.getDate()+1),{currentYear:e,currentMonth:t+1,currentDay:l,weekStartDate:i,weekEndDate:r,prevStartDate:c,nextEndDate:p}},X=()=>{const e=n.value.prevStartDate.getFullYear(),t=n.value.prevStartDate.getMonth()+1,l=n.value.prevStartDate.getDate();T(e,t,l),k(e,t,l)},ee=()=>{const e=n.value.nextEndDate.getFullYear(),t=n.value.nextEndDate.getMonth()+1,l=n.value.nextEndDate.getDate();T(e,t,l),k(e,t,l)},T=(e,t,l)=>{n.value=U(e,t,l),n.value.weekDates=G(n.value.weekStartDate),console.log("set Date Info - currentDateInfo:",n.value)};return se(()=>{v.value=V(new Date),w.value=Z(new Date().getHours());const e=new Date().getFullYear(),t=new Date().getMonth()+1,l=new Date().getDate();T(e,t,l),k(e,t,l)}),(e,t)=>{const l=le("router-link");return u(),h(D,null,[fe,s("div",ve,[s("div",pe,[s("div",me,[g(l,{to:"/admin/weekly",class:_(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/weekly"}])},{default:I(()=>[we]),_:1},8,["class"]),g(l,{to:"/admin/monthly",class:_(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/monthly"}])},{default:I(()=>[ke]),_:1},8,["class"])]),s("div",xe,[s("button",{onClick:t[0]||(t[0]=x(a=>X(),["stop"])),class:"p-2 rounded-full font-semibold"},[g(f(ie),{class:"w-6 h-6"})]),s("h2",De,d(V(n.value.weekStartDate))+" ~ "+d(V(n.value.weekEndDate)),1),s("button",{onClick:t[1]||(t[1]=x(a=>ee(),["stop"])),class:"p-2 rounded-full font-semibold"},[g(f(de),{class:"w-6 h-6"})])]),s("div",_e,[s("button",{onClick:t[2]||(t[2]=a=>k(f($).getFullYear(),f($).getMonth()+1,f($).getDate())),class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center"},Se),s("button",{onClick:M,class:"px-4 py-2 bg-blue-500 text-white rounded-md"}," 상담 등록 ")])])]),s("div",Ce,[s("div",$e,[s("div",Ve,[s("div",Me,[Te,(u(!0),h(D,null,y(n.value.weekDates,(a,o)=>(u(),h("div",{key:o,class:_(["row-start-[1] col-start-[{{ index + 2 }}] sticky top-0 dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2 text-center",a.date===f($).toISOString().split("T")[0]?"bg-yellow-100":"bg-white"])},[s("span",Ee,d(a.date.split("-")[2]),1),P(" "+d(a.day),1)],2))),128))]),s("div",Ye,[s("div",Fe,[(u(),h(D,null,y(11,a=>s("div",{key:a,class:"h-[90px] border-slate-100 dark:border-slate-200/5 border-r text-xs p-1.5 text-right text-slate-400 uppercase sticky left-0 bg-white dark:bg-slate-800 font-medium"},d(a+7)+" AM ",1)),64))]),(u(!0),h(D,null,y(Y.value,(a,o)=>(u(),h("div",{key:o,class:"flex-row h-full items-center text-center border-slate-100 dark:border-slate-200/5 border-r divide-y divide-slate-100 dark:divide-slate-200"},[(u(!0),h(D,null,y(a,(i,r)=>(u(),h("div",{key:r,onClick:c=>K(o,r,c),class:_(["h-[90px] text-xs text-slate-400 font-medium p-[1px] relative",o===new Date().toISOString().split("T")[0]?"bg-yellow-100":""])},[ze,Ne,(u(!0),h(D,null,y(i.slice(0,2),(c,p)=>{var W,B,H,L,O,A;return u(),h("div",{class:_(["relative flex-row text-xs text-blue-600 border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(B=(W=b[o])==null?void 0:W[r])!=null&&B[p]?"scale-105 h-auto min-h-6 w-full pt-1 border-blue-700":"scale-100 h-6"]]),key:p,style:ae({backgroundColor:(L=(H=b[o])==null?void 0:H[r])!=null&&L[p]?"rgba(255, 255, 255, 1)":c.teacher_usercolor,zIndex:(A=(O=b[o])==null?void 0:O[r])!=null&&A[p]?10:1}),onClick:x(F=>R(o,r,p,F),["stop"])},[s("div",Be,[s("span",He,d(c.schedule_time),1),s("span",Le,"["+d(c.client_name)+"] "+d(c.program_name.length>10?c.program_name.slice(0,10)+"...":c.program_name),1)]),s("div",Oe,[Ae,s("span",Ie,d(c.teacher_fullname),1)]),s("div",Pe,[qe,s("span",Re,d(c.start_time)+" ~ "+d(c.finish_time),1)]),s("div",Ze,[s("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:x(F=>N(c.schedule_id,c.id,c.schedule_date),["stop"])},[g(f(ue),{class:"w-4 h-4"})],8,Ge),s("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:x(F=>Q(c.id),["stop"])},[g(f(he),{class:"w-4 h-4"})],8,Je)])],14,We)}),128)),i.length>2?(u(),h("div",{key:0,class:"flex items-center justify-center ml-auto w-6 h-5 text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 bg-blue-400/20",onClick:x(c=>J(o),["stop"])},[g(f(be),{class:"w-5 h-4"}),P(" "+d(i.length-2),1)],8,Ke)):oe("",!0)],10,je))),128))]))),128))])])]),Qe,g(ne,{isVisible:S.value,scheduleId:E.value,scheduleListId:j.value,scheduleDate:v.value,scheduleTime:w.value,onClose:M,class:"z-20"},null,8,["isVisible","scheduleId","scheduleListId","scheduleDate","scheduleTime"]),g(re,{isDailyViewSlidingVisible:C.value,scheduleDate:v.value,scheduleTime:w.value,onClose:z,onClickCalendarSchedule:N,class:"z-10"},null,8,["isDailyViewSlidingVisible","scheduleDate","scheduleTime"])])],64)}}};export{lt as default};
