import{N as U,y as f,z as X,o as d,d as u,e as l,w as D,q as k,g,t as i,F as m,A as _,j as A,M as ee,O as te,H as se}from"./index-CE9o_E71.js";import{_ as le,a as ae,h as oe,r as re,b as ne,c as ce,d as ie,e as de,f as ue}from"./DailyViewSliding-5OUpk4jh.js";import"./client-DIR5M0oM.js";const be=l("section",null,[l("div",{class:"w-full sm:container"},[l("div",{class:"border-black border-l-[5px] pl-5"},[l("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"주간 일정")])])],-1),he={class:"flex justify-between items-center mb-4"},ve={class:"flex items-center space-x-2"},fe={class:"text-xl font-semibold"},ge={class:"flex space-x-2 text-sm font-semibold"},pe=l("span",null,"Today",-1),ke=[pe],we=l("button",{class:"px-4 py-2 bg-blue-500 text-white rounded-md"},"상담 등록",-1),De={class:"not-prose relative bg-slate-50 rounded-xl overflow-hidden w-full mx-auto dark:bg-slate-800/25"},me={class:"relative rounded-xl overflow-auto"},xe={class:"mx-4 my-4 box-content bg-white dark:bg-slate-800 shadow-xl overflow-hidden"},_e={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 h-auto"},ye=l("div",{class:"row-start-[1] col-start-[1] sticky top-0 bg-white dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2"},null,-1),Se={class:"sm:inline-block rounded-full bg-slate-400 w-5 h-5 text-white font-semibold"},Ce={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 max-h-full h-full"},$e={class:"flex-row h-full"},Me=["onClick"],Ve=["onClick"],Ee={class:"flex justify-between items-center px-1 h-full w-full"},Te={class:"inline-block whitespace-nowrap overflow-hidden text-ellipsis"},Fe={class:"ml-auto inline-block"},Ye={class:"flex justify-between items-center px-1 h-full w-full"},je=l("span",{class:"inline-block"},"상담사",-1),ze={class:"ml-auto inline-block"},Ne={class:"flex justify-between items-center px-1 h-full w-full"},We=l("span",{class:"inline-block"},"상담시간",-1),Be={class:"ml-auto inline-block"},Le={class:"flex justify-center items-center px-1 h-full w-full"},He=["onClick"],Ae=["onClick"],Oe=["onClick"],qe=l("div",{class:"absolute inset-0 pointer-events-none border border-black/5 rounded-xl dark:border-white/5"},null,-1),Je={__name:"WeeklyView",setup(Ie){const b=U({}),y=f(!1),S=f(!1),M=f(""),Y=f(""),h=f(""),w=f(""),V=f([]),o=f({}),E=new Date,O=["Mon","Tue","Web","Thu","Fri","Sat","Sun"],q=(e,t,s,a)=>{a.stopPropagation(),b[e]||(b[e]={}),b[e][t]||(b[e][t]={}),b[e][t][s]=!b[e][t][s];const n=a.target.closest(".relative");if(n){const c=n.parentElement.children;for(let r of c)r!==n&&(r.style.display=b[e][t][s]?"none":"")}};function I(e){return e<10?`0${e}:00`:`${e}:00`}const C=e=>{const t=e.getFullYear(),s=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${s}-${a}`},P=e=>{const t=[];for(let s=0;s<7;s++){const a=new Date(e);a.setDate(e.getDate()+s);const n=a.getDay()-1;t.push({date:C(a),day:O[n===-1?6:n]})}return t},T=()=>{y.value=!y.value,y.value||(M.value="",h.value="",w.value="",p(o.value.currentYear,o.value.currentMonth,o.value.currentDay))},j=()=>{S.value=!S.value,S.value||(h.value="",w.value="",p(o.value.currentYear,o.value.currentMonth,o.value.currentDay))},Z=e=>{h.value=e,j()},G=(e,t)=>{console.log("clickCalendarTime:",e,t),h.value=e,w.value=t,T()},z=(e,t,s)=>{M.value=String(e),Y.value=String(t),h.value=s,T()},J=async e=>{if(confirm("해당 일정을 삭제하시겠습니까?")&&e)try{await ue(e),p(o.value.currentYear,o.value.currentMonth)}catch(t){console.error("Error deleting schedule:",t)}},p=async(e,t,s)=>{e=e||new Date().getFullYear(),t=t||new Date().getMonth()+1,s=s||new Date().getDate(),console.log("year:",e,"month:",t,"day:",s);try{const a=await oe(e,t,s);V.value=a.data,$(e,t-1,s),console.log("schedule_data:",V.value)}catch(a){console.error("Error fetching monthly schedule data:",a)}},K=(e,t,s)=>{const a=new Date(e,t,s);console.log("date:",a);let n=a.getDay();n=n===0?6:n-1;const c=new Date(a);c.setDate(a.getDate()-n);const r=new Date(c);r.setDate(c.getDate()+6);const v=new Date(c);v.setDate(c.getDate()-1);const x=new Date(r);return x.setDate(r.getDate()+1),{currentYear:e,currentMonth:t+1,currentDay:s,weekStartDate:c,weekEndDate:r,prevStartDate:v,nextEndDate:x}},Q=()=>{const e=o.value.prevStartDate.getFullYear(),t=o.value.prevStartDate.getMonth()+1,s=o.value.prevStartDate.getDate();$(e,t,s),p(e,t,s)},R=()=>{const e=o.value.nextEndDate.getFullYear(),t=o.value.nextEndDate.getMonth()+1,s=o.value.nextEndDate.getDate();$(e,t,s),p(e,t,s)},$=(e,t,s)=>{o.value=K(e,t,s),o.value.weekDates=P(o.value.weekStartDate),console.log("set Date Info - currentDateInfo:",o.value)};return X(()=>{h.value=C(new Date),w.value=I(new Date().getHours());const e=new Date().getFullYear(),t=new Date().getMonth()+1,s=new Date().getDate();$(e,t,s),p(e,t,s)}),(e,t)=>(d(),u(m,null,[be,l("div",he,[l("div",ve,[l("button",{onClick:t[0]||(t[0]=D(s=>Q(),["stop"])),class:"p-2 rounded-full font-semibold"},[k(g(re),{class:"w-6 h-6"})]),l("h2",fe,i(C(o.value.weekStartDate))+" ~ "+i(C(o.value.weekEndDate)),1),l("button",{onClick:t[1]||(t[1]=D(s=>R(),["stop"])),class:"p-2 rounded-full font-semibold"},[k(g(ne),{class:"w-6 h-6"})])]),l("div",ge,[l("button",{onClick:t[2]||(t[2]=s=>p(g(E).getFullYear(),g(E).getMonth()+1,g(E).getDate())),class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center"},ke),we])]),l("div",De,[l("div",me,[l("div",xe,[l("div",_e,[ye,(d(!0),u(m,null,_(o.value.weekDates,(s,a)=>(d(),u("div",{key:a,class:"row-start-[1] col-start-[{{ index + 2 }}] sticky top-0 bg-white dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2 text-center"},[l("span",Se,i(s.date.split("-")[2]),1),A(" "+i(s.day),1)]))),128))]),l("div",Ce,[l("div",$e,[(d(),u(m,null,_(11,s=>l("div",{key:s,class:"h-[90px] border-slate-100 dark:border-slate-200/5 border-r text-xs p-1.5 text-right text-slate-400 uppercase sticky left-0 bg-white dark:bg-slate-800 font-medium"},i(s+7)+" AM ",1)),64))]),(d(!0),u(m,null,_(V.value,(s,a)=>(d(),u("div",{key:a,class:"flex-row h-full items-center text-center border-slate-100 dark:border-slate-200/5 border-r divide-y divide-slate-100 dark:divide-slate-200"},[(d(!0),u(m,null,_(s,(n,c)=>(d(),u("div",{key:c,onClick:r=>G(a,c),class:"h-[90px] text-xs text-slate-400 font-medium p-1.5"},[(d(!0),u(m,null,_(n.slice(0,2),(r,v)=>{var x,N,W,B,L,H;return d(),u("div",{class:ee(["relative flex-row text-xs text-blue-600 border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(N=(x=b[a])==null?void 0:x[c])!=null&&N[v]?"scale-105 h-auto min-h-6 w-full pt-1 border-blue-700":"scale-100 h-6"]]),key:v,style:te({backgroundColor:(B=(W=b[a])==null?void 0:W[c])!=null&&B[v]?"rgba(255, 255, 255, 1)":r.teacher_usercolor,zIndex:(H=(L=b[a])==null?void 0:L[c])!=null&&H[v]?10:1}),onClick:D(F=>q(a,c,v,F),["stop"])},[l("div",Ee,[l("span",Te,"["+i(r.client_name)+"] "+i(r.teacher_expertise),1),l("span",Fe,i(r.schedule_time),1)]),l("div",Ye,[je,l("span",ze,i(r.teacher_fullname),1)]),l("div",Ne,[We,l("span",Be,i(r.start_time)+" ~ "+i(r.finish_time),1)]),l("div",Le,[l("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:D(F=>z(r.schedule_id,r.id,r.schedule_date),["stop"])},[k(g(ce),{class:"w-4 h-4"})],8,He),l("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:D(F=>J(r.id),["stop"])},[k(g(ie),{class:"w-4 h-4"})],8,Ae)])],14,Ve)}),128)),n.length>2?(d(),u("div",{key:0,class:"flex items-center justify-center ml-auto w-6 h-5 text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 bg-blue-400/20",onClick:D(r=>Z(a),["stop"])},[k(g(de),{class:"w-5 h-4"}),A(" "+i(n.length-2),1)],8,Oe)):se("",!0)],8,Me))),128))]))),128))])])]),qe,k(le,{isVisible:y.value,scheduleId:M.value,scheduleListId:Y.value,scheduleDate:h.value,scheduleTime:w.value,onClose:T,class:"z-20"},null,8,["isVisible","scheduleId","scheduleListId","scheduleDate","scheduleTime"]),k(ae,{isDailyViewSlidingVisible:S.value,scheduleDate:h.value,scheduleTime:w.value,onClose:j,onClickCalendarSchedule:z,class:"z-10"},null,8,["isDailyViewSlidingVisible","scheduleDate","scheduleTime"])])],64))}};export{Je as default};
