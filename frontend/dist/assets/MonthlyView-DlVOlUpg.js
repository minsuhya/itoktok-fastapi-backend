import{S as R,y as f,z as U,U as T,r as W,o as g,d as _,e as t,q as h,x as B,O as k,g as y,t as d,F as j,A as L,B as Z,R as G,w as v,j as Q,H as X}from"./index-C8JNOHQq.js";import{_ as K,a as ee,g as te,r as se,b as le,c as oe,d as ne,e as ae,f as re}from"./DailyViewSliding-CuqycyUP.js";import{u as ce,a as ie}from"./teacherStore-CiNX_JwY.js";import"./client-C0SgaBTb.js";import"./program-D-3ClrrB.js";const ue=t("section",null,[t("div",{class:"w-full sm:container"},[t("div",{class:"border-black border-l-[5px] pl-5"},[t("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"월간 일정")])])],-1),de={class:"max-w-full mx-auto p-4"},me={class:"flex justify-between items-center mb-4"},he={class:"inline-flex rounded-lg border border-gray-200 bg-white p-1"},fe=t("span",{class:"text-sm font-medium"}," 주간 ",-1),ve=t("span",{class:"text-sm font-medium"}," 월간 ",-1),be={class:"flex items-center space-x-2"},pe={class:"text-xl font-semibold"},ge={class:"flex space-x-2 text-sm font-semibold"},_e=t("span",null,"Today",-1),xe=[_e],we={class:"grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-hidden text-sm"},ke=Z('<div class="bg-white py-2 text-center text-sm font-medium">Mon</div><div class="bg-white py-2 text-center text-sm font-medium">Tue</div><div class="bg-white py-2 text-center text-sm font-medium">Wed</div><div class="bg-white py-2 text-center text-sm font-medium">Thu</div><div class="bg-white py-2 text-center text-sm font-medium">Fri</div><div class="bg-white py-2 text-center text-sm font-medium">Sat</div><div class="bg-white py-2 text-center text-sm font-medium">Sun</div>',7),ye=["onClick"],Ce=["onClick"],Se=["onClick"],Me={class:"inline-block"},De={class:"ml-auto inline-block"},$e=["onClick"],Ve=t("span",{class:"inline-block"},"상담사",-1),Ye={class:"ml-auto inline-block"},Fe=["onClick"],Ne=t("span",{class:"inline-block"},"상담시간",-1),je={class:"ml-auto inline-block"},Ie=["onClick"],Ee=["onClick"],ze=["onClick"],Te=["onClick"],He={__name:"MonthlyView",setup(Be){const $=ce(),O=ie(),u=R({}),C=f(!1),S=f(!1),V=f(""),Y=f(""),b=f(""),x=(e,s,n)=>{n.stopPropagation(),u[e]||(u[e]={}),u[e][s]=!u[e][s],Object.keys(u).forEach(l=>{Object.keys(u[l]).forEach(o=>{l!==e&&o!==s&&(u[l][o]=!1)})});const a=n.target.closest(".relative");if(a){const l=a.parentElement.children;for(let o of l)o!==a&&(o.style.display=u[e][s]?"none":"")}},M=()=>{C.value=!C.value,C.value||(V.value="",Y.value="",b.value=""),m(r.value.currentYear,r.value.currentMonth)},I=()=>{S.value=!S.value,S.value||(b.value=""),m(r.value.currentYear,r.value.currentMonth)},A=e=>{b.value=e,I()},J=e=>{b.value=e,M()},E=(e,s,n)=>{V.value=String(e),Y.value=String(s),b.value=n,M()},q=async e=>{if(confirm("해당 일정을 삭제하시겠습니까?")&&e)try{await re(e),m(r.value.currentYear,r.value.currentMonth)}catch(s){console.error("Error deleting schedule:",s)}},F=["January","February","March","April","May","June","July","August","September","October","November","December"],N=f([]),r=f({}),D=f(""),H=e=>{const s=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${s}-${n}-${a}`};D.value=H(new Date),console.log("today:",D.value);const P=(e,s)=>{const n=new Date(e,s,1),a=n.getFullYear(),l=n.getMonth()+1;let o=a,c=l-1;c===0&&(c=12,o-=1);let w=a,p=l+1;return p===13&&(p=1,w+=1),console.log("currentYear:",a,"currentMonth:",l),{currentDate:n,currentYear:a,currentMonth:l,currentMonthName:F[l-1],prevYear:o,prevMonth:c,prevMonthName:F[c-1],nextYear:w,nextMonth:p,nextMonthName:F[p-1]}},m=async(e,s)=>{e||(e=new Date().getFullYear()),s||(s=new Date().getMonth()+1);try{const n=await te(e,s);N.value=n.data,z(e,s-1),console.log("schedule_data:",N.value)}catch(n){console.error("Error fetching monthly schedule data:",n)}},z=(e,s)=>{r.value=P(e,s)};return U(()=>{const e=new Date().getFullYear(),s=new Date().getMonth();z(e,s),m(r.value.currentYear,r.value.currentMonth)}),T(()=>$.selectedDate,e=>{e&&m(e.getFullYear(),e.getMonth()+1)}),T(()=>O.selectedTeachers,e=>{e&&m($.selectedDate.getFullYear(),$.selectedDate.getMonth()+1)}),(e,s)=>{const n=W("router-link");return g(),_(j,null,[ue,t("div",de,[t("div",me,[t("div",he,[h(n,{to:"/admin/weekly",class:k(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/weekly"}])},{default:B(()=>[fe]),_:1},8,["class"]),h(n,{to:"/admin/monthly",class:k(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/monthly"||e.$route.path==="/admin"}])},{default:B(()=>[ve]),_:1},8,["class"])]),t("div",be,[t("button",{class:"p-2 rounded-full font-semibold",onClick:s[0]||(s[0]=a=>m(r.value.prevYear,r.value.prevMonth))},[h(y(se),{class:"w-6 h-6"})]),t("h2",pe,d(r.value.currentMonthName)+" "+d(r.value.currentYear),1),t("button",{class:"p-2 rounded-full font-semibold",onClick:s[1]||(s[1]=a=>m(r.value.nextYear,r.value.nextMonth))},[h(y(le),{class:"w-6 h-6"})])]),t("div",ge,[t("button",{class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center",onClick:s[2]||(s[2]=a=>m())},xe),t("button",{class:"px-4 py-2 bg-blue-500 text-white rounded-md",onClick:M}," 상담 등록 ")])]),t("div",we,[ke,(g(!0),_(j,null,L(N.value,(a,l)=>(g(),_("div",{class:k(["h-32 p-2",l===D.value?"bg-yellow-100":"bg-white"]),key:l,onClick:o=>J(l)},[t("span",{class:k({"block text-sm bg-sky-500 text-white ring rounded-full font-semibold w-5 text-center":l===D.value})},d(l.split("-")[2]),3),(g(!0),_(j,null,L(a.slice(0,2),(o,c)=>{var w,p;return g(),_("div",{class:k(["relative flex-row text-xs text-blue-600 border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(w=u[l])!=null&&w[c]?"scale-105 h-auto min-h-6 w-full pt-1":"scale-100 h-6"]]),key:c,style:G({backgroundColor:(p=u[l])!=null&&p[c]?"rgba(255, 255, 255, 1)":o.teacher_usercolor}),onClick:v(i=>x(l,c,i),["stop"])},[t("div",{class:"flex justify-between items-center px-1 h-full w-full",onClick:v(i=>x(l,c,i),["stop"])},[t("span",Me,d(o.schedule_time),1),t("span",De,"["+d(o.client_name)+"] "+d(o.program_name.length>10?o.program_name.slice(0,10)+"...":o.program_name),1)],8,Se),t("div",{class:"flex justify-between items-center px-1 h-full w-full",onClick:v(i=>x(l,c,i),["stop"])},[Ve,t("span",Ye,d(o.teacher_fullname),1)],8,$e),t("div",{class:"flex justify-between items-center px-1 h-full w-full",onClick:v(i=>x(l,c,i),["stop"])},[Ne,t("span",je,d(o.start_time)+" ~ "+d(o.finish_time),1)],8,Fe),t("div",{class:"flex justify-center items-center px-1 h-full w-full",onClick:v(i=>x(l,c,i),["stop"])},[t("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:v(i=>E(o.schedule_id,o.id,o.schedule_date),["stop"])},[h(y(oe),{class:"w-4 h-4"})],8,Ee),t("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:v(i=>q(o.id),["stop"])},[h(y(ne),{class:"w-4 h-4"})],8,ze)],8,Ie)],14,Ce)}),128)),a.length>2?(g(),_("div",{key:0,class:"mt-4 flex items-center justify-center text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:v(o=>A(l),["stop"])},[h(y(ae),{class:"w-4 h-4"}),Q(" "+d(a.length-2)+" more ",1)],8,Te)):X("",!0)],10,ye))),128))]),h(K,{isVisible:C.value,scheduleId:V.value,scheduleListId:Y.value,scheduleDate:b.value,onClose:M,class:"z-20"},null,8,["isVisible","scheduleId","scheduleListId","scheduleDate"]),h(ee,{isDailyViewSlidingVisible:S.value,scheduleDate:b.value,onClose:I,onClickCalendarSchedule:E,class:"z-10"},null,8,["isDailyViewSlidingVisible","scheduleDate"])])],64)}}};export{He as default};
