import{C as k,i as T,y as g,c as q,a as w,N as z,P as U,S,o as b,d as v,e,m as B,t as y,q as u,x as E,g as d,D as V,M,E as j,F as C,A,G as N,j as I,U as O,f as K,v as G,V as L,w as D}from"./index-Ck04C7we.js";import{r as Z}from"./CheckIcon-BuUIdUPh.js";const H=async c=>{try{return(await k.post("/programs",c)).data}catch(t){throw console.error("Error creating program:",t),t}},J=async c=>{try{return(await k.get(`/programs/${c}`)).data}catch(t){throw console.error("Error reading program:",t),t}},F=async(c=1,t=10,l="")=>{try{return await k.get("/programs",{params:{page:c,size:t,search_qry:l}})}catch(a){throw console.error("Error reading programs:",a),a}},Q=async(c,t)=>{try{return(await k.put(`/programs/${c}`,t)).data}catch(l){throw console.error("Error updating program:",l),l}},R=async c=>{try{return(await k.delete(`/programs/${c}`)).data}catch(t){throw console.error("Error deleting program:",t),t}},W={class:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},X={class:"border-b pb-2 mb-4"},Y={class:"flex items-center justify-between mb-2"},ee={class:"font-title font-bold"},re=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),se=[re],te={class:"space-y-4 text-sm"},ae=e("label",{class:"block mb-1 text-gray-700"},[I("프로그램 유형 "),e("span",{class:"text-red-500"},"*")],-1),oe=e("option",{value:""},"프로그램 유형을 선택하세요",-1),le=e("option",{value:"미술"},"미술",-1),ne=e("option",{value:"음악"},"음악",-1),ie=e("option",{value:"무용"},"무용",-1),ce=e("option",{value:"기타"},"기타",-1),de=e("label",{class:"block mb-1 text-gray-700"},[I("프로그램명 "),e("span",{class:"text-red-500"},"*")],-1),ue=e("label",{class:"block mb-1 text-gray-700"},"담당 선생님",-1),me={class:"mb-2"},pe={class:"inline-flex items-center"},ge=e("span",{class:"ml-2"},"전체 선생님",-1),he=e("option",{value:""},"담당 선생님을 선택하세요",-1),_e=["value"],be={class:"flex justify-between pt-4"},ve={type:"submit",class:"bg-blue-600 text-white rounded-md px-4 py-2 hover:bg-blue-700"},ye={__name:"ProgramFormSliding",props:{isVisible:Boolean,programId:String},emits:["close"],setup(c,{emit:t}){const l=T("showModal"),a=c,m=t,h=g([]),_=g(!1),$=q({program_type:w().required("프로그램 유형을 선택하세요"),program_name:w().required("프로그램명을 입력하세요"),teacher_username:w().when("is_all_teachers",{is:!1,then:()=>w().required("담당 선생님을 선택하세요"),otherwise:()=>w().nullable()})}),o=z({program_type:"",program_name:"",is_all_teachers:!1,teacher_username:"",description:"",duration:60,max_participants:1,price:0}),P=s=>{s.target.checked&&(o.teacher_username=null),o.is_all_teachers=_.value=!!s.target.checked,console.log("formData.is_all_teachers:",o.is_all_teachers)},x=async()=>{try{const s=await O();h.value=s,console.log("teachers",h.value)}catch(s){console.error("Error fetching teachers:",s),l("선생님 목록을 불러오는데 실패했습니다.")}},f=async()=>{if(!a.programId){Object.assign(o,{program_type:"",program_name:"",is_all_teachers:!1,teacher_username:"",description:"",duration:60,max_participants:1,price:0});return}try{const s=await J(a.programId);Object.assign(o,s),console.log("loadProgram:",o)}catch(s){console.error("Error fetching program:",s),l("프로그램 정보를 불러오는데 실패했습니다.")}},n=async s=>{try{const r={...s,is_all_teachers:_.value,teacher_username:_.value?null:s.teacher_username};a.programId?(await Q(a.programId,r),l("프로그램이 수정되었습니다.")):(await H(r),l("프로그램이 등록되었습니다.")),m("close")}catch(r){console.error("Error saving program:",r),l("프로그램 저장 중 오류가 발생했습니다.")}};return U(()=>{x(),f()}),S(()=>a.programId,s=>{s&&f()}),S(()=>a.isVisible,s=>{s&&(a.programId?f():Object.assign(o,{program_type:"",program_name:"",is_all_teachers:!0,teacher_username:"",description:"",duration:60,max_participants:1,price:0}))}),(s,r)=>(b(),v(C,null,[e("div",B(s.$attrs,{onClick:r[0]||(r[0]=p=>m("close")),class:["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000",{"opacity-100 block":a.isVisible,"opacity-0 hidden":!a.isVisible}]}),null,16),e("div",B(s.$attrs,{class:["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!a.isVisible,"translate-x-0":a.isVisible}]}),[e("div",W,[e("div",X,[e("div",Y,[e("h2",ee,y(a.programId?"프로그램 수정":"프로그램 등록"),1),e("button",{class:"ml-auto",onClick:r[1]||(r[1]=p=>m("close"))},se)]),u(d(N),{onSubmit:n,"validation-schema":d($),"initial-values":o},{default:E(({errors:p})=>[e("div",te,[e("div",null,[ae,u(d(V),{name:"program_type",as:"select",class:M(["w-full bg-neutral-50 border border-gray-300 rounded-md p-2",{"border-red-500":p.program_type}]),modelValue:o.program_type,"onUpdate:modelValue":r[2]||(r[2]=i=>o.program_type=i)},{default:E(()=>[oe,le,ne,ie,ce]),_:2},1032,["modelValue","class"]),u(d(j),{name:"program_type",class:"text-red-500 text-xs mt-1"})]),e("div",null,[de,u(d(V),{name:"program_name",type:"text",class:M(["w-full bg-neutral-50 border border-gray-300 rounded-md p-2",{"border-red-500":p.program_name}]),modelValue:o.program_name,"onUpdate:modelValue":r[3]||(r[3]=i=>o.program_name=i),placeholder:"프로그램명을 입력하세요"},null,8,["modelValue","class"]),u(d(j),{name:"program_name",class:"text-red-500 text-xs mt-1"})]),e("div",null,[ue,e("div",me,[e("label",pe,[u(d(V),{name:"is_all_teachers",type:"checkbox",modelValue:o.is_all_teachers,"onUpdate:modelValue":r[4]||(r[4]=i=>o.is_all_teachers=i),onChange:P,class:"form-checkbox h-4 w-4 text-blue-600"},null,8,["modelValue"]),ge])]),u(d(V),{name:"teacher_username",as:"select",class:M(["w-full bg-neutral-50 border border-gray-300 rounded-md p-2",{"border-red-500":p.teacher_username}]),modelValue:o.teacher_username,"onUpdate:modelValue":r[5]||(r[5]=i=>o.teacher_username=i),disabled:_.value},{default:E(()=>[he,(b(!0),v(C,null,A(h.value,i=>(b(),v("option",{key:i.username,value:i.username},y(i.full_name),9,_e))),128))]),_:2},1032,["modelValue","class","disabled"]),u(d(j),{name:"teacher_username",class:"text-red-500 text-xs mt-1"})]),e("div",be,[e("button",{type:"button",onClick:r[6]||(r[6]=i=>m("close")),class:"bg-gray-400 text-white rounded-md px-4 py-2 hover:bg-gray-500"}," 취소 "),e("button",ve,y(a.programId?"수정":"등록"),1)])])]),_:1},8,["validation-schema","initial-values"])])])],16)],64))}},xe=e("section",null,[e("div",{class:"w-full sm:container"},[e("div",{class:"border-black border-l-[5px] pl-5"},[e("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"프로그램 관리")])])],-1),fe={class:"lg:flex lg:items-center lg:justify-between mb-2"},we={class:"min-w-0 flex-1"},ke={class:"relative"},$e=e("div",{class:"absolute inset-y-0 rtl:inset-r-0 start-0 flex items-center ps-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1),Ve={class:"mt-5 flex lg:ml-4 lg:mt-0"},Ce={class:"sm:ml-3"},Pe={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},Ee={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},Me=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"프로그램 유형"),e("th",{scope:"col",class:"px-6 py-3"},"프로그램명"),e("th",{scope:"col",class:"px-6 py-3"},"담당 선생님"),e("th",{scope:"col",class:"px-6 py-3"},"Action")])],-1),je={class:"px-6 py-4"},Ie={class:"px-6 py-4"},Se={class:"px-6 py-4"},Be={class:"px-6 py-4"},De={class:"flex items-center space-x-2"},Fe=["onClick"],Te=["onClick"],qe={__name:"ProgramView",setup(c){const t=T("showModal"),l=g(!1),a=g(""),m=g(""),h=g([]),_=g(1),$=g(10),o=(n="")=>{l.value=!l.value,a.value=n?String(n):"",l.value||x()},P=async()=>{try{const n=await F(_.value,$.value,m.value);h.value=n.items}catch(n){console.error("Error searching programs:",n)}},x=async()=>{try{const n=await F(_.value,$.value);console.log("response:",n),h.value=n.items}catch(n){console.error("Error fetching programs:",n)}},f=async n=>{if(confirm("프로그램을 삭제하시겠습니까?"))try{await R(n),t("프로그램이 삭제되었습니다."),x()}catch(s){console.error("Error deleting program:",s),t("프로그램 삭제 중 오류가 발생했습니다.")}};return U(x),(n,s)=>(b(),v(C,null,[xe,e("div",fe,[e("div",we,[e("div",ke,[$e,K(e("input",{type:"text",id:"table-search-users","onUpdate:modelValue":s[0]||(s[0]=r=>m.value=r),name:"search-text",class:"block pt-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"프로그램 검색",onKeyup:L(P,["enter"])},null,544),[[G,m.value]])])]),e("div",Ve,[e("span",Ce,[e("button",{type:"button",onClick:s[1]||(s[1]=r=>o()),class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[u(d(Z),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),I(" 프로그램 등록 ")])])])]),e("div",Pe,[e("table",Ee,[Me,e("tbody",null,[(b(!0),v(C,null,A(h.value,r=>{var p;return b(),v("tr",{key:r.id,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("td",je,y(r.program_type),1),e("td",Ie,y(r.program_name),1),e("td",Se,y(r.is_all_teachers?"전체":(p=r.teacher)==null?void 0:p.full_name),1),e("td",Be,[e("div",De,[e("a",{href:"#",onClick:D(i=>o(r.id),["prevent"]),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"}," 수정 ",8,Fe),e("a",{href:"#",onClick:D(i=>f(r.id),["prevent"]),class:"font-medium text-red-600 dark:text-red-500 hover:underline"}," 삭제 ",8,Te)])])])}),128))])])]),u(ye,{"is-visible":l.value,"program-id":a.value,onClose:o},null,8,["is-visible","program-id"])],64))}};export{qe as default};
