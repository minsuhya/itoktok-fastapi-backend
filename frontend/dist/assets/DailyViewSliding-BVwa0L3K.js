import{o as c,d as u,e,C as D,u as ce,i as re,y as M,c as ue,a as $,V as ie,z as me,a3 as he,P as de,W as q,m as ee,q as m,x as A,g as i,D as y,f as C,v as _e,F as V,A as T,t as v,H as Q,E as S,X as F,G as pe,j as L,a4 as fe,Q as ge,O as K,S as be,w as oe,a5 as ye}from"./index-CLeev8Ch.js";import{s as xe}from"./client-C2nlALXv.js";import{r as we}from"./program-C2YD2jlZ.js";import{a as ve}from"./teacherStore-l4NdXy0s.js";function Hs(o,p){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z","clip-rule":"evenodd"})])}function Ls(o,p){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z","clip-rule":"evenodd"})])}function ke(o,p){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"m5.433 13.917 1.262-3.155A4 4 0 0 1 7.58 9.42l6.92-6.918a2.121 2.121 0 0 1 3 3l-6.92 6.918c-.383.383-.84.685-1.343.886l-3.154 1.262a.5.5 0 0 1-.65-.65Z"}),e("path",{d:"M3.5 5.75c0-.69.56-1.25 1.25-1.25H10A.75.75 0 0 0 10 3H4.75A2.75 2.75 0 0 0 2 5.75v9.5A2.75 2.75 0 0 0 4.75 18h9.5A2.75 2.75 0 0 0 17 15.25V10a.75.75 0 0 0-1.5 0v5.25c0 .69-.56 1.25-1.25 1.25h-9.5c-.69 0-1.25-.56-1.25-1.25v-9.5Z"})])}function Es(o,p){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"})])}function Ve(o,p){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z","clip-rule":"evenodd"})])}const ne=ve(),$e=async o=>D.post("/schedules",o),Se=async o=>D.get(`/schedules/${o}`),De=async(o,p,k)=>D.put(`/schedules/${o}/${p}`,k),Me=async(o,p,k)=>D.delete(`/schedules/${o}/${p}`,{params:{update_range:k}}),js=async o=>D.delete(`/schedules/list/${o}`),Ns=async(o,p)=>D.get(`/schedules/calendar/${o}/${p}`,{params:{selected_teachers:ne.selectedTeachers.join(",")}}),As=async(o,p,k)=>D.get(`/schedules/calendar/${o}/${p}/${k}`,{params:{selected_teachers:ne.selectedTeachers.join(",")}}),Ce=async(o,p,k)=>D.get(`/schedules/calendar/daily/${o}/${p}/${k}`,{params:{selected_teachers:ne.selectedTeachers.join(",")}}),Fs=async o=>{try{return(await D.put("/schedules/update-date",null,{params:{schedule_id:o.scheduleId,schedule_list_id:o.scheduleListId,new_date:o.newDate,update_all_future:o.updateAllFuture}})).data}catch(p){throw console.error("Error updating schedule date:",p),p}},Os=async o=>{try{return(await D.put("/schedules/update-date-time",null,{params:{schedule_id:o.scheduleId,schedule_list_id:o.scheduleListId,new_date:o.newDate,new_time:o.newTime,update_all_future:o.updateAllFuture}})).data}catch(p){throw console.error("Error updating schedule date and time:",p),p}},Te={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},Ie={className:"border-b pb-2 mb-4"},Ue=e("h2",{class:"font-title font-bold"},"상담일정",-1),He=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),Le=[He],Ee={class:"mb-4"},je=e("label",{class:"block text-sm font-medium text-gray-700"},"일정 유형",-1),Ne={class:"mt-2 flex gap-4"},Ae={class:"inline-flex items-center"},Fe=e("span",{class:"ml-2"},"재활",-1),Oe={class:"inline-flex items-center"},Be=e("span",{class:"ml-2"},"상담/평가",-1),ze={key:0,class:"grid gap-4"},Ye={class:"mb-4"},Ze=e("label",{for:"client-search",class:"block text-sm font-medium text-gray-700"},"내담자를 선택하세요.",-1),qe={class:"relative mt-1"},Pe={class:"absolute inset-y-0 right-0 flex items-center pr-3"},We={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},Re=["onClick"],Ge={key:1,class:"absolute mt-2 text-sm text-gray-500"},Xe={class:"grid grid-cols-1 gap-4"},Je={class:"mb-4"},Qe=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[L("상담사 "),e("span",{class:"text-red-500"},"*")],-1),Ke=e("option",{value:""},"상담사를 선택하세요.",-1),et=["value"],tt={key:1,class:"grid grid-cols-2 gap-4"},st=e("label",{class:"block mb-1 text-gray-700"},[L("내담자 이름 "),e("span",{class:"text-red-500"},"*")],-1),at=e("label",{class:"block mb-1 text-gray-700"},[L("내담자 휴대전화번호 "),e("span",{class:"text-red-500"},"*")],-1),lt={key:2},ot={class:"mb-4"},nt=e("label",{for:"program_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[L("프로그램 "),e("span",{class:"text-red-500"},"*")],-1),rt=e("option",{value:""},"프로그램을 선택하세요",-1),it=["value"],dt={class:"mb-4"},ct=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"일정 반복 타입",-1),ut=e("option",{value:"1"},"매일",-1),mt=e("option",{value:"2"},"매주",-1),ht=e("option",{value:"3"},"매월",-1),_t={key:3,class:"mb-4"},pt=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"반복 요일",-1),ft={class:"flex gap-4 mt-2"},gt={class:"inline-flex items-center"},bt=e("span",{class:"ml-2"},"월",-1),yt={class:"inline-flex items-center"},xt=e("span",{class:"ml-2"},"화",-1),wt={class:"inline-flex items-center"},vt=e("span",{class:"ml-2"},"수",-1),kt={class:"inline-flex items-center"},Vt=e("span",{class:"ml-2"},"목",-1),$t={class:"inline-flex items-center"},St=e("span",{class:"ml-2"},"금",-1),Dt={class:"inline-flex items-center"},Mt=e("span",{class:"ml-2"},"토",-1),Ct={class:"inline-flex items-center"},Tt=e("span",{class:"ml-2"},"일",-1),It={class:"grid grid-cols-2 gap-4"},Ut={class:"mb-4"},Ht=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[L("일정시작일 "),e("span",{class:"text-red-500"},"*")],-1),Lt={class:"mb-4 hidden"},Et=e("label",{for:"finish_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[L("일정종료일 "),e("span",{class:"text-red-500"},"*")],-1),jt={class:"grid grid-cols-2 gap-4"},Nt={class:"mb-4"},At=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[L("시작시간 "),e("span",{class:"text-red-500"},"*")],-1),Ft=["value"],Ot={class:"mb-4"},Bt=e("label",{for:"finish_time",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[L("종료시간 "),e("span",{class:"text-red-500"},"*")],-1),zt=["value"],Yt=e("label",{class:"block mb-1 text-gray-700"},"메모",-1),Zt=e("div",{class:"text-right text-gray-500 text-sm"},"0 / 100",-1),qt={class:"mb-4"},Pt=e("label",{for:"schedule_status",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"상태",-1),Wt=e("option",{value:"1"},"예정",-1),Rt=e("option",{value:"2"},"완료",-1),Gt=e("option",{value:"3"},"취소",-1),Xt={key:4,class:"mb-4"},Jt=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"일정 수정 범위",-1),Qt={class:"flex items-center space-x-4 mt-2"},Kt={class:"inline-flex items-center"},es=e("span",{class:"ml-2"},"이번 일정만 변경",-1),ts={class:"inline-flex items-center"},ss=e("span",{class:"ml-2"},"이후 반복일정 모두 변경",-1),as={class:"flex justify-between mt-4"},ls={class:"flex gap-2"},os={type:"submit",class:"bg-green-600 text-white rounded-md p-2 w-[80px]"},Bs={__name:"ScheduleFormSliding",props:{isVisible:Boolean,scheduleId:String,scheduleListId:String,scheduleDate:{type:String,default:()=>{const o=new Date;return`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`}},scheduleTime:{type:String,default:()=>`${new Date().getHours().toString().padStart(2,"0")}:00}`}},emits:["close"],setup(o,{emit:p}){const k=ce(),I=re("showModal"),E=p,n=o,U=M(""),P=M([]),j=M([]),te=M({}),z=M([]),Y=M([]),O=new Date,se=async()=>{const l=U.value.toLowerCase();if(!l){j.value=[];return}try{const s=await xe(l);P.value=s.data,j.value=P.value}catch(s){console.error("Error fetching clients:",s)}},ae=async l=>{te.value=l,U.value=l.client_name,t.client_id=l.id,t.client_name=l.client_name,t.phone_number=l.phone_number,j.value=[];try{const s=await fe(l.consultant);t.teacher_username=s.username,B()}catch(s){console.error("Error fetching clients:",s)}},W=M([]),d=M([]),_=()=>{const l=[];let s=O;for(s.setHours(9,0,0,0);s.getHours()<18;)l.push(f(s)),s.setMinutes(s.getMinutes()+10);return l},f=l=>{const s=l.getHours().toString().padStart(2,"0"),a=l.getMinutes().toString().padStart(2,"0");return`${s}:${a}`};function h(l){if(!l){const w=new Date,le=w.getHours().toString().padStart(2,"0"),J=w.getMinutes();let N;return J>=40?N="40":J>=20?N="20":N="00",`${le}:${N}`}const s=String(l);if(!s.includes(":")){const w=parseInt(s);return w<10?`0${w}:00`:`${s}:00`}const[a,g]=s.split(":"),b=parseInt(a);return b<10?`0${b}:${g}`:`${a}:${g}`}const x=()=>{if(!t.start_time)return;const[l,s]=t.start_time.split(":").map(Number),a=O;a.setHours(l,s,0,0);const g=[],b=new Date(a);b.setHours(a.getHours()+1);let w=new Date(a);for(w.setMinutes(w.getMinutes()+10);w<=b;)g.push(f(w)),w.setMinutes(w.getMinutes()+10);d.value=g;const[le,J]=t.start_time.split(":").map(Number),N=new Date;N.setHours(le,J+50),t.finish_time=f(N)},H=ue({teacher_username:$().required("상담사를 선택해주세요."),client_name:$().required("내담자를 선택해주세요."),phone_number:$().required("휴대전화번호를 입력하세요."),program_id:$().when("teacher_username",{is:l=>l&&l.length>0,then:()=>$().required("프로그램을 선택해주세요."),otherwise:()=>$()}),start_date:$().required("일정시작일을 선택해주세요."),finish_date:$().transform((l,s,a)=>{var b;const g=(b=a==null?void 0:a.parent)==null?void 0:b.start_date;if(g){const w=new Date(g);return w.setFullYear(w.getFullYear()+1),w.toISOString().split("T")[0]}return l}),start_time:$().required("시작시간을 선택해주세요."),finish_time:$().required("종료시간을 선택해주세요."),repeat_type:$().required("반복 타입을 선택해주세요.")}),t=ie({id:"",teacher_username:"",client_id:"",schedule_type:1,client_name:"",program_id:"",repeat_type:1,repeat_days:{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1},schedule_status:1,start_date:n.scheduleDate,finish_date:n.scheduleDate,start_time:h(n.scheduleTime),finish_time:h(n.scheduleTime),memo:"",teacher:{},update_range:"single"}),r=()=>{E("close")},Z=async()=>{if(!n.scheduleListId){if(Object.keys(t).forEach(g=>{t[g]=""}),t.schedule_type=1,t.schedule_status=1,t.repeat_type=2,t.update_range="single",t.start_date=n.scheduleDate,t.finish_date=n.scheduleDate,n.scheduleTime)t.start_time=h(n.scheduleTime);else if(!t.start_time){const g=O.getHours();t.start_time=g>=9&&g<18?h(g):"09:00"}x();const l=["sun","mon","tue","wed","thu","fri","sat"],s=new Date(n.scheduleDate),a=l[s.getDay()];t.repeat_days={mon:a==="mon",tue:a==="tue",wed:a==="wed",thu:a==="thu",fri:a==="fri",sat:a==="sat",sun:a==="sun"};return}try{const l=await Se(n.scheduleListId);console.log("scheduleInfo:",l);const{clientinfo:s,teacher:a,schedule:g,...b}=l;Object.assign(t,b,g),t.memo=b.schedule_memo,t.schedule_type=g.schedule_type,console.log("form.schedule_type:",t.schedule_type),t.client_name=(s==null?void 0:s.client_name)||"",t.phone_number=(s==null?void 0:s.phone_number)||"",t.teacher_username=(a==null?void 0:a.username)||"",t.teacher_username&&await B(),t.start_time=t.start_time||h(O.getHours()),x(),t.repeat_days=(()=>{try{return typeof t.repeat_days=="string"?JSON.parse(t.repeat_days.replace(/'/g,'"').replace(/True/g,"true").replace(/False/g,"false")):t.repeat_days||{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1}}catch{return{mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1}}})()}catch(l){console.error("Error fetching user:",l)}},R=async()=>{try{const l=await ge();z.value=l.map(s=>({value:s.username,text:s.full_name}))}catch(l){console.error("Error fetching client:",l)}},B=async()=>{try{const l=await we(1,100,"",t.teacher_username);console.log("response:",l),Y.value=l.items.map(s=>({value:s.id,text:s.program_name}))}catch(l){console.error("프로그램 목록 조회 중 오류:",l)}};me(()=>{Z(),R()}),he(()=>{U.value="",t.start_date||(t.start_date=new Date().toISOString().split("T")[0],t.finish_date=t.start_date),t.start_time||(t.start_time=h(new Date().getHours())),t.start_time>="18:00"&&(t.start_time="17:50"),x()}),de(()=>{W.value=_()});const G=async l=>{try{const s={...l,repeat_days:t.repeat_days,finish_date:new Date(new Date(l.start_date).setFullYear(new Date(l.start_date).getFullYear()+1)).toISOString().split("T")[0],update_range:t.update_range};if(delete s.created_at,delete s.updated_at,delete s.deleted_at,t.id){const a=t.update_range==="all"?"이 일정과 향후 모든 반복 일정이 수정됩니다. 계속하시겠습니까?":"이 일정만 수정됩니다. 계속하시겠습니까?";if(!confirm(a))return;await De(t.id,n.scheduleListId,s),I("상담일정 정보가 수정되었습니다.")}else await $e(s),I("상담일정 정보가 등록되었습니다.");t.id=null,t.client_id=null,t.client_name="",t.schedule_type=1,t.phone_number="",t.teacher_username="",t.program_id="",t.start_date=new Date().toISOString().split("T")[0],t.finish_date=t.start_date,t.start_time=h(new Date().getHours()),t.finish_time="",t.repeat_type=1,t.memo="",t.repeat_days={mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1,sun:!1},t.update_range="single"}catch(s){I("상담일정 정보 저장 중 오류가 발생했습니다."),console.error("Error registering schedule data:",s)}E("close")};q(()=>n.scheduleListId,(l,s)=>{l!==s&&Z()}),q(()=>n.scheduleDate,(l,s)=>{if(l!==s&&(t.start_date=l,t.finish_date=l,!n.scheduleListId&&l)){const a=["sun","mon","tue","wed","thu","fri","sat"],g=new Date(l),b=a[g.getDay()];t.repeat_days={mon:b==="mon",tue:b==="tue",wed:b==="wed",thu:b==="thu",fri:b==="fri",sat:b==="sat",sun:b==="sun"}}}),q(()=>n.scheduleTime,(l,s)=>{t.start_time=h(l),x()}),q(()=>t.schedule_type,(l,s)=>{t.schedule_type=l});const X=async()=>{try{if(!n.scheduleListId)return;const l=t.update_range==="all"?"이 일정과 향후 모든 반복 일정이 삭제됩니다. 계속하시겠습니까?":"이 일정만 삭제됩니다. 계속하시겠습니까?";if(!confirm(l))return;await Me(t.id,n.scheduleListId,t.update_range),I("일정이 삭제되었습니다."),E("close")}catch(l){console.error("Error deleting schedule:",l),I("일정 삭제 중 오류가 발생했습니다.")}};return(l,s)=>(c(),u(V,null,[e("div",ee({onClick:r},l.$attrs,{class:["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000 z-49",{"opacity-100 block":o.isVisible,"opacity-0 hidden":!o.isVisible}]}),null,16),e("div",ee(l.$attrs,{class:["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!o.isVisible,"translate-x-0":o.isVisible}]}),[e("div",Te,[e("div",Ie,[e("div",{class:"flex items-center justify-evenly mb-2"},[Ue,e("button",{class:"ml-auto",onClick:r},Le)]),m(i(pe),{onSubmit:G,"validation-schema":i(H),"initial-values":t,class:"space-y-4 text-sm"},{default:A(()=>[m(i(y),{type:"hidden",name:"id",modelValue:t.id,"onUpdate:modelValue":s[0]||(s[0]=a=>t.id=a)},null,8,["modelValue"]),m(i(y),{type:"hidden",name:"client_id",modelValue:t.client_id,"onUpdate:modelValue":s[1]||(s[1]=a=>t.client_id=a)},null,8,["modelValue"]),e("div",Ee,[je,e("div",Ne,[e("label",Ae,[m(i(y),{type:"radio",name:"schedule_type",value:1,modelValue:t.schedule_type,"onUpdate:modelValue":s[2]||(s[2]=a=>t.schedule_type=a),class:"form-radio text-indigo-600"},null,8,["modelValue"]),Fe]),e("label",Oe,[m(i(y),{type:"radio",name:"schedule_type",value:2,modelValue:t.schedule_type,"onUpdate:modelValue":s[3]||(s[3]=a=>t.schedule_type=a),class:"form-radio text-indigo-600"},null,8,["modelValue"]),Be])])]),!n.scheduleId&&!n.scheduleListId?(c(),u("div",ze,[e("div",Ye,[Ze,e("div",qe,[C(e("input",{"onUpdate:modelValue":s[4]||(s[4]=a=>U.value=a),onInput:se,type:"text",id:"client-search",placeholder:"내담자 검색...",class:"block w-full py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,544),[[_e,U.value]]),e("div",Pe,[m(i(Ve),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),e("div",null,[j.value.length>0?(c(),u("ul",We,[(c(!0),u(V,null,T(j.value,a=>(c(),u("li",{key:a.id,onClick:g=>ae(a),class:"cursor-pointer px-3 py-2 hover:bg-indigo-600 hover:text-white"},v(a.client_name),9,Re))),128))])):(c(),u("p",Ge,"검색 결과가 없습니다."))])])])])):Q("",!0),e("div",Xe,[e("div",Je,[Qe,m(i(y),{name:"teacher_username",modelValue:t.teacher_username,"onUpdate:modelValue":s[5]||(s[5]=a=>t.teacher_username=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",onChange:B},{default:A(()=>[Ke,(c(!0),u(V,null,T(z.value,a=>(c(),u("option",{key:a.value,value:a.value},v(a.text),9,et))),128))]),_:1},8,["modelValue"]),m(i(S),{name:"teacher_username",class:"text-red-500 text-xs italic mt-2"})])]),i(k).user.user_type==1&&i(k).user.is_superuser==1?(c(),u("div",tt,[e("div",null,[st,m(i(y),{name:"client_name",as:"input",type:"text",modelValue:t.client_name,"onUpdate:modelValue":s[6]||(s[6]=a=>t.client_name=a),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 이름을 입력하세요."},null,8,["modelValue"]),m(i(S),{name:"client_name",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[at,m(i(y),{name:"phone_number",as:"input",type:"text",modelValue:t.phone_number,"onUpdate:modelValue":s[7]||(s[7]=a=>t.phone_number=a),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 휴대전화번호를 입력하세요."},null,8,["modelValue"]),m(i(S),{name:"phone_number",class:"text-red-500 text-xs italic mt-2"})])])):(c(),u("div",lt,[m(i(y),{name:"client_name",type:"hidden",modelValue:t.client_name,"onUpdate:modelValue":s[8]||(s[8]=a=>t.client_name=a)},null,8,["modelValue"]),m(i(y),{name:"phone_number",type:"hidden",modelValue:t.phone_number,"onUpdate:modelValue":s[9]||(s[9]=a=>t.phone_number=a)},null,8,["modelValue"])])),e("div",null,[e("div",ot,[nt,m(i(y),{name:"program_id",modelValue:t.program_id,"onUpdate:modelValue":s[10]||(s[10]=a=>t.program_id=a),as:"select",class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},{default:A(()=>[rt,(c(!0),u(V,null,T(Y.value,a=>(c(),u("option",{key:a.value,value:a.value},v(a.text),9,it))),128))]),_:1},8,["modelValue"]),m(i(S),{name:"program_id",class:"text-red-500 text-xs italic mt-2"})])]),e("div",dt,[ct,m(i(y),{name:"repeat_type",modelValue:t.repeat_type,"onUpdate:modelValue":s[11]||(s[11]=a=>t.repeat_type=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:A(()=>[ut,mt,ht]),_:1},8,["modelValue"]),m(i(S),{name:"repeat_type",class:"text-red-500 text-xs italic mt-2"})]),t.repeat_type=="2"?(c(),u("div",_t,[pt,e("div",ft,[e("label",gt,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[12]||(s[12]=a=>t.repeat_days.mon=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[F,t.repeat_days.mon]]),bt]),e("label",yt,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=a=>t.repeat_days.tue=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[F,t.repeat_days.tue]]),xt]),e("label",wt,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[14]||(s[14]=a=>t.repeat_days.wed=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[F,t.repeat_days.wed]]),vt]),e("label",kt,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[15]||(s[15]=a=>t.repeat_days.thu=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[F,t.repeat_days.thu]]),Vt]),e("label",$t,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[16]||(s[16]=a=>t.repeat_days.fri=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[F,t.repeat_days.fri]]),St]),e("label",Dt,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[17]||(s[17]=a=>t.repeat_days.sat=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[F,t.repeat_days.sat]]),Mt]),e("label",Ct,[C(e("input",{type:"checkbox","onUpdate:modelValue":s[18]||(s[18]=a=>t.repeat_days.sun=a),class:"form-checkbox h-4 w-4 text-blue-600"},null,512),[[F,t.repeat_days.sun]]),Tt])])])):Q("",!0),e("div",It,[e("div",Ut,[Ht,m(i(y),{type:"date",name:"start_date",modelValue:t.start_date,"onUpdate:modelValue":s[19]||(s[19]=a=>t.start_date=a),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),m(i(S),{name:"start_date",class:"text-red-500 text-xs italic mt-2"})]),e("div",Lt,[Et,m(i(y),{type:"date",name:"finish_date",modelValue:t.finish_date,"onUpdate:modelValue":s[20]||(s[20]=a=>t.finish_date=a),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),m(i(S),{name:"finish_date",class:"text-red-500 text-xs italic mt-2"})])]),e("div",jt,[e("div",Nt,[At,m(i(y),{name:"start_time",id:"start_time",modelValue:t.start_time,"onUpdate:modelValue":s[21]||(s[21]=a=>t.start_time=a),as:"select",onChange:x,class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:A(()=>[(c(!0),u(V,null,T(W.value,a=>(c(),u("option",{key:a,value:a},v(a),9,Ft))),128))]),_:1},8,["modelValue"]),m(i(S),{name:"start_time",class:"text-red-500 text-xs italic mt-2"})]),e("div",Ot,[Bt,m(i(y),{name:"finish_time",id:"finish_time",modelValue:t.finish_time,"onUpdate:modelValue":s[22]||(s[22]=a=>t.finish_time=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:A(()=>[(c(!0),u(V,null,T(d.value,a=>(c(),u("option",{key:a,value:a},v(a),9,zt))),128))]),_:1},8,["modelValue"]),m(i(S),{name:"finish_time",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[Yt,m(i(y),{name:"memo",as:"textarea",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",rows:"3",modelValue:t.memo,"onUpdate:modelValue":s[23]||(s[23]=a=>t.memo=a),placeholder:"내담자의 상담정보를 메모해보세요. 최대 100자 까지 입력하실 수 있습니다."},null,8,["modelValue"]),m(i(S),{name:"memo",class:"text-red-500 text-xs italic mt-2"}),Zt]),e("div",qt,[Pt,m(i(y),{name:"schedule_status",id:"schedule_status",modelValue:t.schedule_status,"onUpdate:modelValue":s[24]||(s[24]=a=>t.schedule_status=a),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:A(()=>[Wt,Rt,Gt]),_:1},8,["modelValue"])]),n.scheduleId&&n.scheduleListId?(c(),u("div",Xt,[Jt,e("div",Qt,[e("label",Kt,[m(i(y),{type:"radio",name:"update_range",value:"single",modelValue:t.update_range,"onUpdate:modelValue":s[25]||(s[25]=a=>t.update_range=a),class:"form-radio"},null,8,["modelValue"]),es]),e("label",ts,[m(i(y),{type:"radio",name:"update_range",value:"all",modelValue:t.update_range,"onUpdate:modelValue":s[26]||(s[26]=a=>t.update_range=a),class:"form-radio"},null,8,["modelValue"]),ss])])])):Q("",!0),e("div",as,[e("div",null,[e("button",{type:"button",onClick:r,class:"bg-gray-400 text-white rounded-md p-2 w-[80px]"}," 취소 ")]),e("div",ls,[n.scheduleListId?(c(),u("button",{key:0,type:"button",onClick:X,class:"bg-red-600 text-white rounded-md p-2 w-[80px]"}," 삭제 ")):Q("",!0),e("button",os,v(n.scheduleListId?"수정":"등록"),1)])])]),_:1},8,["validation-schema","initial-values"])])])],16)],64))}},ns={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},rs={className:"border-b pb-2 mb-4"},is=e("h2",{class:"font-title font-bold"},"상담일정",-1),ds=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),cs=[ds],us={class:"text-lg font-semibold text-gray-500 flex items-center justify-center"},ms={class:"grid grid-cols-1"},hs={class:"w-12 text-xs font-semibold"},_s={class:"w-full min-h-24 relative"},ps=e("div",{class:"absolute left-0 w-full border-t border-gray-200 top-1/3"},null,-1),fs=e("div",{class:"absolute left-0 w-full border-t border-gray-200 top-2/3"},null,-1),gs={class:"relative w-full"},bs=["onClick"],ys=["onClick"],xs={class:"inline-block font-semibold"},ws={class:"ml-auto inline-block whitespace-nowrap overflow-hidden text-ellipsis"},vs={class:"transition-all duration-300 ease-in-out"},ks=e("span",{class:"inline-block"},"상담사",-1),Vs={class:"ml-auto inline-block"},$s=e("span",{class:"inline-block"},"상담시간",-1),Ss={class:"ml-auto inline-block font-semibold"},Ds={class:"flex justify-center items-center px-1 h-8"},Ms=["onClick"],zs={__name:"DailyViewSliding",props:{isDailyViewSlidingVisible:Boolean,scheduleDate:String,scheduleTime:String},emits:["close","clickCalendarSchedule"],setup(o,{emit:p}){re("showModal");const k=o,I=p,E=M([]),n=ie({}),U=(d,_,f)=>{console.log("zoom index:",d,"item_index:",_),f.stopPropagation(),n[d]||(n[d]={}),n[d][_]=!n[d][_],console.log("isZoomed:",n[d][_]),Object.keys(n).forEach(h=>{Object.keys(n[h]).forEach(x=>{h!==d&&x!==_&&(n[h][x]=!1)})}),console.log("isZoomed:",n[d][_])},P=(d,_,f)=>{I("clickCalendarSchedule",d,_,f)};function j(d){const _=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],f=new Date(d);return _[f.getDay()]}const te=d=>{const _=d>=12?"PM":"AM";return`${d%12||12} ${_}`},z=()=>{I("close")},Y=async()=>{if(!k.scheduleDate)return;const[d,_,f]=k.scheduleDate.split("-");try{const h=await Ce(d,_,f);E.value=h.data,console.log("daily sliding schedule_data:",E.value)}catch(h){console.error("Error fetching monthly schedule data:",h)}};de(()=>{Y()}),q(()=>k.scheduleDate,(d,_)=>{d!==_&&Y()});const O=(d,_)=>{const[f,h]=d.split(":").map(Number),[x,H]=_.split(":").map(Number);return(x-f)*60+(H-h)},se=d=>d.reduce((_,f,h)=>{const x=f.start_time,H=_.find(t=>t.some(r=>r.start_time===x));return H?H.push({...f,index:h}):_.push([{...f,index:h}]),_},[]),ae=(d,_)=>{const f=O(d,_),h=90;return f>=50?h:Math.max(f/50*h,30)},W=d=>{const[_,f]=d.split(":").map(Number),h=f,x=50/90;return h*(1/x)};return(d,_)=>(c(),u(V,null,[e("div",ee({onClick:z,class:"fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000 z-39"},d.$attrs,{class:{"opacity-100 block":o.isDailyViewSlidingVisible,"opacity-0 hidden":!o.isDailyViewSlidingVisible}}),null,16),e("div",ee({class:"fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-40 transition-transform duration-1000 ease-in-out"},d.$attrs,{class:{"translate-x-full":!o.isDailyViewSlidingVisible,"translate-x-0":o.isDailyViewSlidingVisible}}),[e("div",ns,[e("div",rs,[e("div",{class:"flex items-center justify-evenly mb-2"},[is,e("button",{class:"ml-auto",onClick:z},cs)]),e("div",null,[e("div",us,[e("span",null,v(o.scheduleDate)+"("+v(j(o.scheduleDate))+")",1)])]),e("div",ms,[(c(!0),u(V,null,T(E.value,(f,h)=>(c(),u("div",{key:h,class:"flex text-gray-500 border-b min-h-24 flex items-center pl-2 divide-x divide-gray-300 w-full"},[e("div",hs,v(te(h)),1),e("div",_s,[ps,fs,(c(!0),u(V,null,T(f,(x,H)=>(c(),u("div",{key:H,class:"flex-row items-center justify-between w-full"},[e("div",gs,[(c(!0),u(V,null,T(se(x),t=>(c(),u(V,{key:t[0].schedule_time},[(c(!0),u(V,null,T(t,(r,Z)=>{var R,B,G,X,l;return c(),u("div",{key:r.index,class:K(["flex-row text-xs text-black border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(R=n[r.schedule_time])!=null&&R[r.index]?"scale-105":"scale-100"]]),style:be({backgroundColor:(B=n[r.schedule_time])!=null&&B[r.index]?"rgb(255, 255, 255)":`${r.teacher_usercolor}`,position:"absolute",zIndex:(G=n[r.schedule_time])!=null&&G[r.index]?10:1,left:`${Z*15}%`,width:(X=n[r.schedule_time])!=null&&X[r.index]?"85%":`${85-Z*15}%`,height:`${ae(r.start_time,r.finish_time)}px`,top:`${W(r.start_time)}px`,right:"auto"}),onClick:oe(s=>U(r.schedule_time,r.index,s),["stop"])},[e("div",{class:K(["flex justify-between items-center px-1 h-6",{"line-through":r.schedule_status==="3"}]),onClick:oe(s=>U(r.schedule_time,r.index,s),["stop"])},[e("span",xs,v(r.schedule_time),1),e("span",ws," ["+v(r.client_name)+"] "+v(r.teacher_expertise),1)],10,ys),C(e("div",vs,[e("div",{class:K(["flex justify-between items-center px-1 h-6",{"line-through":r.schedule_status==="3"}])},[ks,e("span",Vs,v(r.teacher_fullname),1)],2),e("div",{class:K(["flex justify-between items-center px-1 h-6",{"line-through":r.schedule_status==="3"}])},[$s,e("span",Ss,v(r.start_time)+" ~ "+v(r.finish_time),1)],2),e("div",Ds,[e("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:oe(s=>P(r.schedule_id,r.id,r.schedule_date),["stop"])},[m(i(ke),{class:"w-4 h-4"})],8,Ms)])],512),[[ye,(l=n[r.schedule_time])==null?void 0:l[r.index]]])],14,bs)}),128))],64))),128))])]))),128))])]))),128))])])])],16)],64))}};export{Bs as _,zs as a,Ls as b,ke as c,Es as d,js as e,As as f,Ns as g,Os as h,Hs as r,Fs as u};
