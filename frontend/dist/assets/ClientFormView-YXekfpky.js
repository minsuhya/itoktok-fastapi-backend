import{r as S,u as q,a as B}from"./client-BmLc_bHX.js";import{l as M,y as U,i as C,z as F,c as I,a as r,R as L,S as E,O as N,x as c,H as T,o as b,e,q as l,g as o,L as n,M as i,d as _,B as j,t as x,F as O,N as R,j as u}from"./index-DyikdeVs.js";import{M as D}from"./MobileLayout-CeX199-E.js";const $={class:"p-4"},z={class:"bg-white rounded-lg shadow-sm p-4"},H=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" 이름 "),e("span",{class:"text-red-500"},"*")],-1),A={class:"bg-white rounded-lg shadow-sm p-4"},G=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" 전화번호 "),e("span",{class:"text-red-500"},"*")],-1),J={class:"bg-white rounded-lg shadow-sm p-4"},K=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" 생년월일 "),e("span",{class:"text-red-500"},"*")],-1),P={class:"bg-white rounded-lg shadow-sm p-4"},Q=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" 성별 "),e("span",{class:"text-red-500"},"*")],-1),W=e("option",{value:""},"성별을 선택하세요",-1),X=e("option",{value:"M"},"남성",-1),Y=e("option",{value:"F"},"여성",-1),Z={class:"bg-white rounded-lg shadow-sm p-4"},ee=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"주소",-1),te={class:"bg-white rounded-lg shadow-sm p-4"},ae=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" 등록일 "),e("span",{class:"text-red-500"},"*")],-1),se={class:"bg-white rounded-lg shadow-sm p-4"},oe=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"담당자",-1),le=e("option",{value:""},"담당자를 선택하세요",-1),de=["value"],ne={class:"flex gap-3 pb-4"},re={type:"submit",class:"flex-1 bg-blue-600 text-white rounded-md py-3 font-semibold"},be={__name:"ClientFormView",setup(ie){const p=M(),f=U(),m=C("showModal",()=>{}),h=F([]),w=I({client_name:r().required("이름을 입력해주세요."),phone_number:r().required("전화번호를 입력해주세요."),birthdate:r().required("생년월일을 선택해주세요."),gender:r().required("성별을 선택해주세요."),registration_date:r().required("등록일을 선택해주세요.")}),a=L({id:"",client_name:"",phone_number:"",birthdate:"",gender:"",address:"",registration_date:new Date().toISOString().split("T")[0],consultant:""}),y=async()=>{const d=f.params.id;if(d)try{const t=await S(d);Object.assign(a,t.data||t)}catch(t){console.error("이용자 정보 조회 오류:",t),m("이용자 정보를 불러오는 중 오류가 발생했습니다.")}},v=async()=>{try{const d=await T();h.value=d.map(t=>({value:t.username,text:t.full_name}))}catch(d){console.error("Error fetching teacher list:",d)}},g=()=>{p.back()},V=()=>{document.querySelector("form").requestSubmit()},k=async d=>{try{a.id?(await q(a.id,d),m("이용자 정보가 수정되었습니다.")):(await B(d),m("이용자 정보가 등록되었습니다.")),p.back()}catch(t){m("이용자 정보 저장 중 오류가 발생했습니다."),console.error("Error saving client data:",t)}};return E(async()=>{await v(),await y()}),(d,t)=>(b(),N(D,{"header-title":"이용자 등록","show-back":!0,"show-save":!0,"active-tab":"home",onBack:g,onSave:V},{default:c(()=>[e("div",$,[l(o(R),{onSubmit:k,"validation-schema":o(w),"initial-values":a,class:"space-y-4"},{default:c(()=>[l(o(n),{type:"hidden",name:"id",modelValue:a.id,"onUpdate:modelValue":t[0]||(t[0]=s=>a.id=s)},null,8,["modelValue"]),e("div",z,[H,l(o(n),{name:"client_name",as:"input",type:"text",modelValue:a.client_name,"onUpdate:modelValue":t[1]||(t[1]=s=>a.client_name=s),class:"w-full bg-white border border-gray-300 rounded-md p-2",placeholder:"이름을 입력하세요"},null,8,["modelValue"]),l(o(i),{name:"client_name",class:"text-red-500 text-xs italic mt-1"})]),e("div",A,[G,l(o(n),{name:"phone_number",as:"input",type:"text",modelValue:a.phone_number,"onUpdate:modelValue":t[2]||(t[2]=s=>a.phone_number=s),class:"w-full bg-white border border-gray-300 rounded-md p-2",placeholder:"전화번호를 입력하세요"},null,8,["modelValue"]),l(o(i),{name:"phone_number",class:"text-red-500 text-xs italic mt-1"})]),e("div",J,[K,l(o(n),{name:"birthdate",as:"input",type:"date",modelValue:a.birthdate,"onUpdate:modelValue":t[3]||(t[3]=s=>a.birthdate=s),class:"w-full bg-white border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),l(o(i),{name:"birthdate",class:"text-red-500 text-xs italic mt-1"})]),e("div",P,[Q,l(o(n),{name:"gender",as:"select",modelValue:a.gender,"onUpdate:modelValue":t[4]||(t[4]=s=>a.gender=s),class:"w-full bg-white border border-gray-300 rounded-md p-2"},{default:c(()=>[W,X,Y]),_:1},8,["modelValue"]),l(o(i),{name:"gender",class:"text-red-500 text-xs italic mt-1"})]),e("div",Z,[ee,l(o(n),{name:"address",as:"input",type:"text",modelValue:a.address,"onUpdate:modelValue":t[5]||(t[5]=s=>a.address=s),class:"w-full bg-white border border-gray-300 rounded-md p-2",placeholder:"주소를 입력하세요"},null,8,["modelValue"])]),e("div",te,[ae,l(o(n),{name:"registration_date",as:"input",type:"date",modelValue:a.registration_date,"onUpdate:modelValue":t[6]||(t[6]=s=>a.registration_date=s),class:"w-full bg-white border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),l(o(i),{name:"registration_date",class:"text-red-500 text-xs italic mt-1"})]),e("div",se,[oe,l(o(n),{name:"consultant",as:"select",modelValue:a.consultant,"onUpdate:modelValue":t[7]||(t[7]=s=>a.consultant=s),class:"w-full bg-white border border-gray-300 rounded-md p-2"},{default:c(()=>[le,(b(!0),_(O,null,j(h.value,s=>(b(),_("option",{key:s.value,value:s.value},x(s.text),9,de))),128))]),_:1},8,["modelValue"])]),e("div",ne,[e("button",{type:"button",onClick:g,class:"flex-1 bg-gray-400 text-white rounded-md py-3 font-semibold"}," 취소 "),e("button",re,x(a.id?"수정":"등록"),1)])]),_:1},8,["validation-schema","initial-values"])])]),_:1}))}};export{be as default};
