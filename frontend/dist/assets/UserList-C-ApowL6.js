import{u as S,i as z,c as B,a as n,l as F,M as E,s as M,O as P,o as V,d as U,e,J as j,n as a,p as D,g as l,A as d,E as u,B as N,F as C,j as w,q as h,f as O,v as R,P as A,x as K,t as f}from"./index-DIc3l8qW.js";import{c as L,a as T,u as J,d as Q,e as q}from"./user-DmLmzRlf.js";import{_ as Z}from"./PaginationView-Dwa-Rtmf.js";import{r as G}from"./CheckIcon-0bGrAVls.js";const H={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},W={className:"border-b pb-2 mb-4"},X=e("h2",{class:"font-title font-bold"},"상담사 정보",-1),Y=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),ee=[Y],se={class:"grid grid-cols-3 gap-4"},te={class:"mb-4"},re=e("label",{for:"username",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("상담사ID "),e("span",{class:"text-red-500"},"*")],-1),oe={class:"mb-4"},ae=e("label",{for:"full_name",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("상담사명 "),e("span",{class:"text-red-500"},"*")],-1),le={class:"mb-4"},de=e("label",{class:"block text-sm font-medium text-gray-700"},"색상 정보 ",-1),ne={class:"grid grid-cols-2 gap-4"},ie={class:"mb-4"},ue=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"비밀번호",-1),ce={class:"mb-4"},me=e("label",{for:"password_confirm",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"비밀번호 확인",-1),pe={class:"grid grid-cols-2 gap-4"},be={class:"mb-4"},ge=e("label",{for:"expertise",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("전문분야 "),e("span",{class:"text-red-500"},"*")],-1),xe={class:"mb-4"},ye=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("이메일 "),e("span",{class:"text-red-500"},"*")],-1),he={class:"grid grid-cols-2 gap-4"},fe={class:"mb-4"},_e=e("label",{for:"hp_number",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[w("휴대폰번호 "),e("span",{class:"text-red-500"},"*")],-1),ke={class:"mb-4"},we=e("label",{for:"phone_number",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"전화번호",-1),ve={class:"grid grid-cols-2 gap-4"},Ve={class:"mb-4"},Ue=e("label",{for:"birth_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"생년월일",-1),$e={class:"mb-4"},Ce=e("label",{for:"zip_code",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"우편번호",-1),Ie={class:"mb-4"},je=e("label",{for:"address",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"주소",-1),qe={class:"mb-4"},ze=e("label",{for:"address_extra",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"주소 상세",-1),Me={class:"grid grid-cols-3 gap-4 justify-stretch"},Se={class:"mb-4 flex items-center pt-4"},Be=e("label",{for:"checkbox",class:"text-gray-700 ml-2"}," 정상",-1),Fe=e("button",{type:"submit",class:"bg-green-600 text-white rounded-md p-2 w-[80px]"}," 확인 ",-1),Ee={__name:"UserFormSliding",props:{isVisible:Boolean,userId:String},emits:["close"],setup(_,{emit:p}){const b=S(),c=_,m=z("showModal"),g=p,v=B({id:n().nullable(),username:n().when("id",{is:o=>!o||o==="",then:()=>n().min(4,"4자 이상 입력해주세요.").required("아이디를 입력해주세요.").test("usernameDup","이미 등록된 아이디입니다.",async o=>!(await L(o)).exists),otherwise:()=>n().notRequired()}),password:n().when("id",{is:o=>!o||o==="",then:()=>n().required("비밀번호를 입력해주세요."),otherwise:()=>n().notRequired()}),password_confirm:n().when("password",{is:o=>o&&o.length>0,then:()=>n().oneOf([F("password")],"비밀번호가 일치하지 않습니다.").required("비밀번호 확인을 입력해주세요."),otherwise:()=>n().notRequired()}),full_name:n().required("상담사명을 입력해주세요."),email:n().required("이메일을 입력해주세요.").email("올바른 이메일을 입력하세요."),hp_number:n().required("휴대폰번호를 입력해주세요.").transform(o=>{const s=(""+o).replace(/\D/g,"").match(/^(\d{3})(\d{3,4})(\d{4})$/);return s?`${s[1]}-${s[2]}-${s[3]}`:o}).test("is-valid-phone","올바른 휴대폰번호를 입력하세요.",o=>/^(010|011)-\d{3,4}-\d{4}$/.test(o)),expertise:n().required("전문분야를 입력해주세요.")}),t=E({id:"",username:"",password:"",email:"",full_name:"",birth_date:"",center_username:b.user.center_username,phone_number:"",hp_number:"",address:"",address_extra:"",zip_code:"",user_type:"2",is_active:"1",is_superuser:"0",expertise:""}),x=()=>{g("close")},k=async()=>{if(!c.userId){Object.keys(t).forEach(o=>{t[o]=""}),t.center_username=b.user.center_username,t.user_type="2",t.is_active="1",t.is_superuser="0";return}console.log("props.userId: ",c.userId);try{const o=await T(c.userId);console.log("userInfo:",o),o.password="",Object.assign(t,o)}catch(o){console.error("Error fetching user:",o)}};M(()=>{k(),console.log("userStore.user.center_username: ",b.user.center_username)});const $=async o=>{console.log("submitting:",o),Object.assign(t,o);try{t.id?(await J(t.id,t),m("상당사 정보가 수정되었습니다.")):(await Q(t),m("상담사 정보가 등록되었습니다."))}catch(r){m("상담사 정보 저장 중 오류가 발생했습니다."),console.error("Error registering consultant data:",r)}g("close")};return P(()=>c.userId,(o,r)=>{o!==r&&k()}),(o,r)=>(V(),U(C,null,[e("div",{onClick:x,class:j(["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000",{"opacity-100 block":_.isVisible,"opacity-0 hidden":!_.isVisible}])},null,2),e("div",{class:j(["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!_.isVisible,"translate-x-0":_.isVisible}])},[e("div",H,[e("div",W,[e("div",{class:"flex items-center justify-evenly mb-2"},[X,e("button",{class:"ml-auto",onClick:x},ee)]),a(l(N),{onSubmit:$,"validation-schema":l(v),"initial-values":t,class:"space-y-4 text-sm"},{default:D(()=>[a(l(d),{type:"hidden",name:"id",modelValue:t.id,"onUpdate:modelValue":r[0]||(r[0]=s=>t.id=s)},null,8,["modelValue"]),a(l(d),{type:"hidden",name:"center_username",modelValue:t.center_username,"onUpdate:modelValue":r[1]||(r[1]=s=>t.center_username=s)},null,8,["modelValue"]),a(l(d),{type:"hidden",name:"user_type",modelValue:t.user_type,"onUpdate:modelValue":r[2]||(r[2]=s=>t.user_type=s)},null,8,["modelValue"]),a(l(d),{type:"hidden",name:"is_superuser",modelValue:t.is_superuser,"onUpdate:modelValue":r[3]||(r[3]=s=>t.is_superuser=s)},null,8,["modelValue"]),e("div",se,[e("div",te,[re,a(l(d),{type:"text",name:"username",modelValue:t.username,"onUpdate:modelValue":r[4]||(r[4]=s=>t.username=s),readonly:!!t.id,class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue","readonly"]),a(l(u),{name:"username",class:"text-red-500 text-xs italic mt-2"})]),e("div",oe,[ae,a(l(d),{type:"text",name:"full_name",modelValue:t.full_name,"onUpdate:modelValue":r[5]||(r[5]=s=>t.full_name=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),a(l(u),{name:"full_name",class:"text-red-500 text-xs italic mt-2"})]),e("div",le,[de,a(l(d),{type:"color",name:"usercolor",id:"usercolor",class:"p-1 h-11 w-full mt-1 block rounded-lg border-gray-400",modelValue:t.usercolor,"onUpdate:modelValue":r[6]||(r[6]=s=>t.usercolor=s),title:"Choose your color"},null,8,["modelValue"]),a(l(u),{name:"usercolor",class:"text-red-500 text-sm"})])]),e("div",ne,[e("div",ie,[ue,a(l(d),{type:"password",name:"password",modelValue:t.password,"onUpdate:modelValue":r[7]||(r[7]=s=>t.password=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),a(l(u),{name:"password",class:"text-red-500 text-xs italic mt-2"})]),e("div",ce,[me,a(l(d),{type:"password",name:"password_confirm",modelValue:t.password,"onUpdate:modelValue":r[8]||(r[8]=s=>t.password=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),a(l(u),{name:"password_confirm",class:"text-red-500 text-xs italic mt-2"})])]),e("div",pe,[e("div",be,[ge,a(l(d),{type:"text",name:"expertise",modelValue:t.expertise,"onUpdate:modelValue":r[9]||(r[9]=s=>t.expertise=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white",placeholder:"ex) 미술치료, 심리치료"},null,8,["modelValue"]),a(l(u),{name:"expertise",class:"text-red-500 text-xs italic mt-2"})]),e("div",xe,[ye,a(l(d),{type:"email",name:"email",modelValue:t.email,"onUpdate:modelValue":r[10]||(r[10]=s=>t.email=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),a(l(u),{name:"email",class:"text-red-500 text-xs italic mt-2"})])]),e("div",he,[e("div",fe,[_e,a(l(d),{type:"text",name:"hp_number",modelValue:t.hp_number,"onUpdate:modelValue":r[11]||(r[11]=s=>t.hp_number=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),a(l(u),{name:"hp_number",class:"text-red-500 text-xs italic mt-2"})]),e("div",ke,[we,a(l(d),{type:"text",name:"phone_number",modelValue:t.phone_number,"onUpdate:modelValue":r[12]||(r[12]=s=>t.phone_number=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),a(l(u),{name:"phone_number",class:"text-red-500 text-xs italic mt-2"})])]),e("div",ve,[e("div",Ve,[Ue,a(l(d),{type:"date",name:"birth_date",modelValue:t.birth_date,"onUpdate:modelValue":r[13]||(r[13]=s=>t.birth_date=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"])]),e("div",$e,[Ce,a(l(d),{type:"text",name:"zip_code",modelValue:t.zip_code,"onUpdate:modelValue":r[14]||(r[14]=s=>t.zip_code=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"])])]),e("div",Ie,[je,a(l(d),{type:"text",name:"address",modelValue:t.address,"onUpdate:modelValue":r[15]||(r[15]=s=>t.address=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"])]),e("div",qe,[ze,a(l(d),{type:"text",name:"address_extra",modelValue:t.address_extra,"onUpdate:modelValue":r[16]||(r[16]=s=>t.address_extra=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"])]),e("div",Me,[e("div",Se,[a(l(d),{type:"checkbox",name:"is_active",modelValue:t.is_active,"onUpdate:modelValue":r[17]||(r[17]=s=>t.is_active=s),class:"form-checkbox h-5 w-5 text-blue-600 transition duration-150 ease-in-out",value:1},null,8,["modelValue"]),Be])]),e("div",{class:"flex justify-between mt-4"},[e("button",{type:"button",onClick:x,class:"bg-gray-400 text-white rounded-md p-2 w-[80px]"}," 취소 "),Fe])]),_:1},8,["validation-schema","initial-values"])])])],2)],64))}},Pe=e("section",null,[e("div",{class:"w-full sm:container"},[e("div",{class:"border-black border-l-[5px] pl-5"},[e("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"상담자 관리")])])],-1),De={class:"lg:flex lg:items-center lg:justify-between mb-2"},Ne={class:"min-w-0 flex-1"},Oe={class:"relative"},Re=e("div",{class:"absolute inset-y-0 rtl:inset-r-0 start-0 flex items-center ps-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1),Ae={class:"mt-5 flex lg:ml-4 lg:mt-0"},Ke={class:"sm:ml-3"},Le={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},Te={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},Je=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"아이디"),e("th",{scope:"col",class:"px-6 py-3"},"상담사명"),e("th",{scope:"col",class:"px-6 py-3"},"이메일"),e("th",{scope:"col",class:"px-6 py-3"},"센터명"),e("th",{scope:"col",class:"px-6 py-3"},"휴대폰번호"),e("th",{scope:"col",class:"px-6 py-3"},"전화번호"),e("th",{scope:"col",class:"px-6 py-3"},"Action")])],-1),Qe={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},Ze={class:"px-6 py-4"},Ge={class:"px-6 py-4"},He={class:"px-6 py-4"},We={class:"px-6 py-4"},Xe={class:"px-6 py-4"},Ye={class:"px-6 py-4"},es=["onClick"],ls={__name:"UserList",setup(_){z("showModal");const p=h(1),b=h(10),c=h(0),m=h(!1),g=h(""),v=h(""),t=h([]),x=()=>{m.value=!m.value,m.value||(g.value="",k(p.value))},k=async s=>{const y=await q(s);t.value=y.items,p.value=y.page,b.value=y.size,c.value=y.total},$=async()=>{try{const s=await q(1,10,v.value);t.value=s.items,p.value=s.page,b.value=s.size,c.value=s.total}catch(s){console.error("Error fetching users:",s)}},o=s=>{k(s),p.value=s},r=(s="")=>{s?g.value=String(s):g.value="",x()};return M(k),(s,y)=>(V(),U(C,null,[Pe,e("div",De,[e("div",Ne,[e("div",Oe,[Re,O(e("input",{type:"text",id:"table-search-users",name:"search-text","onUpdate:modelValue":y[0]||(y[0]=i=>v.value=i),class:"block pt-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"상담사 검색",onKeyup:A($,["enter"])},null,544),[[R,v.value]])])]),e("div",Ae,[e("span",Ke,[e("button",{type:"button",onClick:x,class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[a(l(G),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),w(" 상담사 등록 ")])])])]),e("div",Le,[e("table",Te,[Je,e("tbody",null,[(V(!0),U(C,null,K(t.value,i=>{var I;return V(),U("tr",{key:i.id,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("th",Qe,f(i.username),1),e("td",Ze,f(i.full_name),1),e("td",Ge,f(i.email),1),e("td",He,f((I=i.center_info)==null?void 0:I.center_name)+"("+f(i.center_username)+")",1),e("td",We,f(i.hp_number),1),e("td",Xe,f(i.phone_number),1),e("td",Ye,[e("a",{href:"#",onClick:ss=>r(i.id),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"상담자정보",8,es)])])}),128))])]),a(Z,{"total-items":c.value,"current-page":p.value,"items-per-page":b.value,onPageChanged:o},null,8,["total-items","current-page","items-per-page"]),a(Ee,{isVisible:m.value,userId:g.value,onClose:x},null,8,["isVisible","userId"])])],64))}};export{ls as default};
