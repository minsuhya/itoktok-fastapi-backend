import{S as re,y as m,z as ne,U,r as ce,o as d,d as u,e as s,q as p,x as Z,O as y,w as D,g as h,t as b,F as _,A as S,j as z,R as H,H as W}from"./index-DMpnuQob.js";import{_ as ie,a as de,h as ue,r as he,b as be,c as ge,d as fe,e as pe,f as ve}from"./DailyViewSliding-BfZmFKLN.js";import{u as we,a as me}from"./teacherStore-B5_L6PC1.js";import"./client-DqAIiP8Y.js";import"./program-sycwA94y.js";const ke=s("section",null,[s("div",{class:"w-full sm:container"},[s("div",{class:"border-black border-l-[5px] pl-5"},[s("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"주간 일정")])])],-1),xe={class:"max-w-full mx-auto p-4"},De={class:"flex justify-between items-center"},_e={class:"inline-flex rounded-lg border border-gray-200 bg-white p-1"},ye=s("span",{class:"text-sm font-medium"}," 주간 ",-1),Se=s("span",{class:"text-sm font-medium"}," 월간 ",-1),Ce={class:"flex items-center space-x-2"},$e={class:"text-xl font-semibold"},Me={class:"flex space-x-2 text-sm font-semibold"},Te=s("span",null,"Today",-1),Ve=[Te],Ye={class:"not-prose relative bg-slate-50 rounded-xl overflow-hidden w-full mx-auto dark:bg-slate-800/25"},Fe={class:"relative rounded-xl overflow-auto"},Ee={class:"mx-4 mt-4 box-content bg-white dark:bg-slate-800 shadow-xl overflow-hidden"},je={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 h-auto"},ze=s("div",{class:"row-start-[1] col-start-[1] sticky top-0 bg-white dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2"},null,-1),He={class:"sm:inline-block rounded-full bg-slate-400 w-5 h-5 text-white font-semibold"},We={class:"mx-4 mb-4 box-content bg-white dark:bg-slate-800 shadow-xl overflow-y-auto max-h-[calc(100vh-200px)]"},Be={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 max-h-full h-full"},Ne={class:"flex-row h-full"},Le=s("div",{class:"w-0 h-0 border-t-[6px] border-t-transparent border-b-[6px] border-b-transparent border-l-[10px] border-l-red-500"},null,-1),Oe=[Le],Ae=["onClick"],Pe=s("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[30px]"},null,-1),Re=s("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[60px]"},null,-1),qe=["onClick"],Ie={class:"flex justify-between items-center px-1 h-full w-full"},Ue={class:"inline-block"},Ze={class:"ml-auto inline-block whitespace-nowrap overflow-hidden text-ellipsis"},Ge={class:"flex justify-between items-center px-1 h-full w-full"},Je=s("span",{class:"inline-block"},"상담사",-1),Ke={class:"ml-auto inline-block"},Qe={class:"flex justify-between items-center px-1 h-full w-full"},Xe=s("span",{class:"inline-block"},"상담시간",-1),et={class:"ml-auto inline-block"},tt={class:"flex justify-center items-center px-1 h-full w-full"},st=["onClick"],lt=["onClick"],at=["onClick"],ot=s("div",{class:"absolute inset-0 pointer-events-none border border-black/5 rounded-xl dark:border-white/5"},null,-1),ht={__name:"WeeklyView",setup(rt){const C=we(),G=me(),g=re({}),$=m(!1),M=m(!1),F=m(""),B=m(""),v=m(""),k=m(""),E=m([]),r=m({}),x=new Date,J=["Mon","Tue","Web","Thu","Fri","Sat","Sun"],K=(e,t,l,a)=>{a.stopPropagation(),g[e]||(g[e]={}),g[e][t]||(g[e][t]={}),g[e][t][l]=!g[e][t][l];const o=a.target.closest(".relative");if(o){const i=o.parentElement.children;for(let n of i)n!==o&&(n.style.display=g[e][t][l]?"none":"")}};function Q(e){return e<10?`0${e}:00`:`${e}:00`}const T=e=>{const t=e.getFullYear(),l=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${l}-${a}`},X=e=>{const t=[];for(let l=0;l<7;l++){const a=new Date(e);a.setDate(e.getDate()+l);const o=a.getDay()-1;t.push({date:T(a),day:J[o===-1?6:o]})}return t},V=()=>{$.value=!$.value,$.value||(F.value="",v.value="",k.value="",f(r.value.currentYear,r.value.currentMonth,r.value.currentDay))},N=()=>{M.value=!M.value,M.value||(v.value="",k.value="",f(r.value.currentYear,r.value.currentMonth,r.value.currentDay))},ee=e=>{v.value=e,N()},te=(e,t,l)=>{const a=l.target.getBoundingClientRect(),o=l.clientY-a.top,i=a.height;let n=0;o<i/3?n=0:o<i*2/3?n=20:n=40,v.value=e,k.value=`${t}:${n.toString().padStart(2,"0")}`,V(),console.log("currentScheduleTime:",k.value)},L=(e,t,l)=>{F.value=String(e),B.value=String(t),v.value=l,V()},se=async e=>{if(confirm("해당 일정을 삭제하시겠습니까?")&&e)try{await ve(e),f(r.value.currentYear,r.value.currentMonth)}catch(t){console.error("Error deleting schedule:",t)}},f=async(e,t,l)=>{e=e||new Date().getFullYear(),t=t||new Date().getMonth()+1,l=l||new Date().getDate(),console.log("year:",e,"month:",t,"day:",l);try{const a=await ue(e,t,l);E.value=a.data,Y(e,t-1,l),console.log("schedule_data:",E.value)}catch(a){console.error("Error fetching monthly schedule data:",a)}},le=(e,t,l)=>{const a=new Date(e,t,l);console.log("date:",a);let o=a.getDay();o=o===0?6:o-1;const i=new Date(a);i.setDate(a.getDate()-o);const n=new Date(i);n.setDate(i.getDate()+6);const c=new Date(i);c.setDate(i.getDate()-1);const w=new Date(n);return w.setDate(n.getDate()+1),{currentYear:e,currentMonth:t+1,currentDay:l,weekStartDate:i,weekEndDate:n,prevStartDate:c,nextEndDate:w}},ae=()=>{const e=r.value.prevStartDate.getFullYear(),t=r.value.prevStartDate.getMonth()+1,l=r.value.prevStartDate.getDate();Y(e,t,l),f(e,t,l)},oe=()=>{const e=r.value.nextEndDate.getFullYear(),t=r.value.nextEndDate.getMonth()+1,l=r.value.nextEndDate.getDate();Y(e,t,l),f(e,t,l)},Y=(e,t,l)=>{r.value=le(e,t,l),r.value.weekDates=X(r.value.weekStartDate),console.log("set Date Info - currentDateInfo:",r.value)};return ne(()=>{v.value=T(new Date),k.value=Q(new Date().getHours());const e=new Date().getFullYear(),t=new Date().getMonth()+1,l=new Date().getDate();Y(e,t,l),f(e,t,l)}),U(()=>C.selectedDate,e=>{e&&f(e.getFullYear(),e.getMonth()+1,e.getDate())}),U(()=>G.selectedTeachers,e=>{e&&f(C.selectedDate.getFullYear(),C.selectedDate.getMonth()+1,C.selectedDate.getDate())}),(e,t)=>{const l=ce("router-link");return d(),u(_,null,[ke,s("div",xe,[s("div",De,[s("div",_e,[p(l,{to:"/admin/weekly",class:y(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/weekly"}])},{default:Z(()=>[ye]),_:1},8,["class"]),p(l,{to:"/admin/monthly",class:y(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/monthly"}])},{default:Z(()=>[Se]),_:1},8,["class"])]),s("div",Ce,[s("button",{onClick:t[0]||(t[0]=D(a=>ae(),["stop"])),class:"p-2 rounded-full font-semibold"},[p(h(he),{class:"w-6 h-6"})]),s("h2",$e,b(T(r.value.weekStartDate))+" ~ "+b(T(r.value.weekEndDate)),1),s("button",{onClick:t[1]||(t[1]=D(a=>oe(),["stop"])),class:"p-2 rounded-full font-semibold"},[p(h(be),{class:"w-6 h-6"})])]),s("div",Me,[s("button",{onClick:t[2]||(t[2]=a=>f(h(x).getFullYear(),h(x).getMonth()+1,h(x).getDate())),class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center"},Ve),s("button",{onClick:V,class:"px-4 py-2 bg-blue-500 text-white rounded-md"}," 상담 등록 ")])])]),s("div",Ye,[s("div",Fe,[s("div",Ee,[s("div",je,[ze,(d(!0),u(_,null,S(r.value.weekDates,(a,o)=>(d(),u("div",{key:o,class:y(["row-start-[1] col-start-[{{ index + 2 }}] sticky top-0 dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2 text-center",a.date===h(x).toISOString().split("T")[0]?"bg-yellow-100":"bg-white"])},[s("span",He,b(a.date.split("-")[2]),1),z(" "+b(a.day),1)],2))),128))])]),s("div",We,[s("div",Be,[s("div",Ne,[(d(),u(_,null,S(11,a=>s("div",{key:a,class:"h-[90px] border-slate-100 dark:border-slate-200/5 border-r text-xs p-1.5 text-right text-slate-400 uppercase sticky left-0 bg-white dark:bg-slate-800 font-medium relative"},[h(x).getHours()>=a+7&&h(x).getHours()<a+8?(d(),u("div",{key:0,class:"absolute left-0",style:H({top:`${h(x).getMinutes()/60*90}px`})},Oe,4)):W("",!0),z(" "+b(a+7>=12?`${(a+7)%12||12} PM`:`${a+7} AM`),1)])),64))]),(d(!0),u(_,null,S(E.value,(a,o)=>(d(),u("div",{key:o,class:"flex-row h-full items-center text-center border-slate-100 dark:border-slate-200/5 border-r divide-y divide-slate-100 dark:divide-slate-200"},[(d(!0),u(_,null,S(a,(i,n)=>(d(),u("div",{key:n,onClick:c=>te(o,n,c),class:y(["h-[90px] text-xs text-slate-400 font-medium p-[1px] relative",o===new Date().toISOString().split("T")[0]?"bg-yellow-100":""])},[Pe,Re,o==new Intl.DateTimeFormat("fr-CA").format(new Date)&&n==Math.floor(new Date().getHours())?(d(),u("div",{key:0,class:"absolute left-0 w-full border-t border-red-500 border-dashed",style:H({top:`${new Date().getMinutes()/60*90}px`})},null,4)):W("",!0),(d(!0),u(_,null,S(i.slice(0,2),(c,w)=>{var O,A,P,R,q,I;return d(),u("div",{class:y(["relative flex-row text-xs text-blue-600 border border-blue-700/40 rounded-md m-1 space-y-1",["transform transition duration-500 ease-in-out overflow-hidden",(A=(O=g[o])==null?void 0:O[n])!=null&&A[w]?"scale-105 h-auto min-h-6 w-full pt-1 border-blue-700":"scale-100 h-6"]]),key:w,style:H({backgroundColor:(R=(P=g[o])==null?void 0:P[n])!=null&&R[w]?"rgba(255, 255, 255, 1)":c.teacher_usercolor,zIndex:(I=(q=g[o])==null?void 0:q[n])!=null&&I[w]?10:1}),onClick:D(j=>K(o,n,w,j),["stop"])},[s("div",Ie,[s("span",Ue,b(c.schedule_time),1),s("span",Ze,"["+b(c.client_name)+"] "+b(c.program_name.length>10?c.program_name.slice(0,10)+"...":c.program_name),1)]),s("div",Ge,[Je,s("span",Ke,b(c.teacher_fullname),1)]),s("div",Qe,[Xe,s("span",et,b(c.start_time)+" ~ "+b(c.finish_time),1)]),s("div",tt,[s("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:D(j=>L(c.schedule_id,c.id,c.schedule_date),["stop"])},[p(h(ge),{class:"w-4 h-4"})],8,st),s("button",{class:"text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20",onClick:D(j=>se(c.id),["stop"])},[p(h(fe),{class:"w-4 h-4"})],8,lt)])],14,qe)}),128)),i.length>2?(d(),u("div",{key:1,class:"flex items-center justify-center ml-auto w-6 h-5 text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 bg-blue-400/20",onClick:D(c=>ee(o),["stop"])},[p(h(pe),{class:"w-5 h-4"}),z(" "+b(i.length-2),1)],8,at)):W("",!0)],10,Ae))),128))]))),128))])])]),ot,p(ie,{isVisible:$.value,scheduleId:F.value,scheduleListId:B.value,scheduleDate:v.value,scheduleTime:k.value,onClose:V,class:"z-20"},null,8,["isVisible","scheduleId","scheduleListId","scheduleDate","scheduleTime"]),p(de,{isDailyViewSlidingVisible:M.value,scheduleDate:v.value,scheduleTime:k.value,onClose:N,onClickCalendarSchedule:L,class:"z-10"},null,8,["isDailyViewSlidingVisible","scheduleDate","scheduleTime"])])],64)}}};export{ht as default};
