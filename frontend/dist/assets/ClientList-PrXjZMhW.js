import{u as z,i as P,q as p,c as L,a as d,M as T,s as q,O as A,o as g,d as _,e,J as j,t as w,n as l,p as I,g as o,A as i,F as U,x as N,E as c,B as O,j as V,f as F,v as D,P as K,C as B,Q}from"./index-B8DgOXJA.js";import{r as J,u as Z,a as G,b as E,c as H}from"./client-Nu66AEKO.js";import{_ as R}from"./PaginationView-CulI04m4.js";import{b as W}from"./user-BJoIGgNa.js";import{r as X}from"./CheckIcon-Bgfzk8Nl.js";const Y={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},ee={className:"border-b pb-2 mb-4"},te={class:"flex items-center justify-evenly mb-2"},se={class:"font-title font-bold"},ae=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),le=[ae],oe=e("label",{class:"block mb-1 text-gray-700"},[V("상담사 "),e("span",{class:"text-red-500"},"*")],-1),ne=e("option",{value:""},"상담사를 선택하세요.",-1),re=["value"],de={class:"grid grid-cols-2 gap-4"},ie=e("label",{class:"block mb-1 text-gray-700"},[V("내담자 이름 "),e("span",{class:"text-red-500"},"*")],-1),ce=e("label",{class:"block mb-1 text-gray-700"},[V("내담자 휴대전화번호 "),e("span",{class:"text-red-500"},"*")],-1),ue=e("label",{class:"block mb-1 text-gray-700"},"관련 태그 입력",-1),me=e("label",{class:"block mb-1 text-gray-700"},"메모(주소소 문제)",-1),be=e("div",{class:"text-right text-gray-500 text-sm"},"0 / 100",-1),pe={class:"grid grid-cols-2 gap-4"},ge=e("label",{class:"block mb-1 text-gray-700"},"생년월일",-1),_e=e("label",{class:"block mb-1 text-gray-700"},"성별",-1),he=e("option",{value:""},"성별을 선택하세요.",-1),xe=e("option",{value:"M"},"남성",-1),ve=e("option",{value:"F"},"여성",-1),ye=e("label",{class:"block mb-1 text-gray-700"},"이메일 주소",-1),fe=e("label",{class:"block mb-1 text-gray-700"},"주소",-1),we={class:"grid grid-cols-2 gap-4"},ke=e("label",{class:"block mb-1 text-gray-700"},[V("상담 신청 경로 "),e("span",{class:"text-red-500"},"*")],-1),Ve=e("option",{value:""},"상담 신청 경로를 선택하세요.",-1),$e=e("option",{value:"1"},"가족/지인추천",-1),Ce=e("option",{value:"2"},"병원/상담센터를 통해",-1),Ie=e("option",{value:"3"},"PC/모바일광고",-1),Ue=e("option",{value:"4"},"카페/커뮤니티",-1),Me=e("button",{type:"submit",class:"bg-green-600 text-white rounded-md p-2 w-[80px]"}," 확인 ",-1),Se={__name:"ClientFormSliding",props:{isVisible:Boolean,clientId:String},emits:["close"],setup(h,{emit:$}){const u=z(),m=h,v=P("showModal"),x=$,y=p([]),k=L({consultant:d().required("상담사를 선택하세요."),consultant_status:d().required("상담상태를 선택하세요."),client_name:d().required("내담자 이름을 입력하세요."),phone_number:d().required("내담자 휴대전화번호를 입력하세요."),tags:d(),memo:d().max(100,"최대 100자까지 입력할 수 있습니다."),birth_date:d(),gendar:d(),email_address:d().email("올바른 이메일 주소를 입력하세요."),address_region:d(),address_city:d(),family_members:d(),consultation_path:d().required("상담 신청 경로를 선택하세요."),center_username:d()}),a=T({id:"",consultant:"",consultant_status:"1",client_name:"",phone_number:"",tags:"",memo:"",birth_date:"",gender:"",email_address:"",address_region:"",address_city:"",family_members:"",consultation_path:"",center_username:u.user.center_username}),b=()=>{x("close")},f=async()=>{if(m.clientId){console.log("props.clientId: ",m.clientId);try{const n=await J(m.clientId);console.log("clientInfo:",n),Object.assign(a,n)}catch(n){console.error("Error fetching client:",n)}}},M=async()=>{try{const n=await W();console.log("teacherList:",n),y.value=n.map(t=>({value:t.username,text:t.full_name}))}catch(n){console.error("Error fetching client:",n)}};q(()=>{f(),M(),console.log("userStore.user.center_username: ",u.user.center_username)});const S=async n=>{console.log("submitting:",n),Object.assign(a,n),a.id?(await Z(a.id,a),v("내담자 정보가 수정되었습니다.")):(await G(),v("내담자 정보가 등록되었습니다.")),x("close")};return A(()=>m.clientId,(n,t)=>{n!==t&&n&&f()}),(n,t)=>(g(),_(U,null,[e("div",{onClick:b,class:j(["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000",{"opacity-100 block":h.isVisible,"opacity-0 hidden":!h.isVisible}])},null,2),e("div",{class:j(["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!h.isVisible,"translate-x-0":h.isVisible}])},[e("div",Y,[e("div",ee,[e("div",te,[e("h2",se,"내담자 등록 "+w(h.clientId),1),e("button",{class:"ml-auto",onClick:b},le)]),l(o(O),{onSubmit:S,"validation-schema":o(k),"initial-values":a,class:"space-y-4 text-sm"},{default:I(()=>[l(o(i),{name:"id",as:"input",type:"hidden",modelValue:a.id,"onUpdate:modelValue":t[0]||(t[0]=s=>a.id=s)},null,8,["modelValue"]),l(o(i),{name:"family_members",as:"input",type:"hidden"}),l(o(i),{name:"center_username",as:"input",type:"hidden"}),e("div",null,[oe,l(o(i),{name:"consultant",modelValue:a.consultant,"onUpdate:modelValue":t[1]||(t[1]=s=>a.consultant=s),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:I(()=>[ne,(g(!0),_(U,null,N(y.value,s=>(g(),_("option",{key:s.value,value:s.value},w(s.text),9,re))),128))]),_:1},8,["modelValue"]),l(o(c),{name:"consultant_options",class:"text-red-500 text-xs italic mt-2"})]),e("div",de,[e("div",null,[ie,l(o(i),{name:"client_name",as:"input",type:"text",modelValue:a.client_name,"onUpdate:modelValue":t[2]||(t[2]=s=>a.client_name=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 이름을 입력하세요."},null,8,["modelValue"]),l(o(c),{name:"client_name",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[ce,l(o(i),{name:"phone_number",as:"input",type:"text",modelValue:a.phone_number,"onUpdate:modelValue":t[3]||(t[3]=s=>a.phone_number=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 휴대전화번호를 입력하세요."},null,8,["modelValue"]),l(o(c),{name:"phone_number",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[ue,l(o(i),{name:"tags",as:"input",type:"text",modelValue:a.tags,"onUpdate:modelValue":t[4]||(t[4]=s=>a.tags=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),l(o(c),{name:"tags",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[me,l(o(i),{name:"memo",as:"textarea",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",rows:"3",modelValue:a.memo,"onUpdate:modelValue":t[5]||(t[5]=s=>a.memo=s),placeholder:"내담자의 주소 문제를 메모해보세요. 최대 100자 까지 입력하실 수 있습니다."},null,8,["modelValue"]),l(o(c),{name:"memo",class:"text-red-500 text-xs italic mt-2"}),be]),e("div",pe,[e("div",null,[ge,l(o(i),{name:"birth_date",as:"input",type:"date",modelValue:a.birth_date,"onUpdate:modelValue":t[6]||(t[6]=s=>a.birth_date=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"2000.01.01"},null,8,["modelValue"]),l(o(c),{name:"birth_date",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[_e,l(o(i),{modelValue:a.gender,"onUpdate:modelValue":t[7]||(t[7]=s=>a.gender=s),name:"gender",as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:I(()=>[he,xe,ve]),_:1},8,["modelValue"]),l(o(c),{name:"gender",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[ye,l(o(i),{name:"email_address",as:"input",type:"email",modelValue:a.email_address,"onUpdate:modelValue":t[8]||(t[8]=s=>a.email_address=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),l(o(c),{name:"email_address",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[fe,e("div",we,[l(o(i),{name:"address_region",as:"input",modelValue:a.address_region,"onUpdate:modelValue":t[9]||(t[9]=s=>a.address_region=s),class:"bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"]),l(o(i),{name:"address_city",as:"input",modelValue:a.address_city,"onUpdate:modelValue":t[10]||(t[10]=s=>a.address_city=s),class:"bg-neutral-50 border border-gray-300 rounded-md p-2"},null,8,["modelValue"])]),l(o(c),{name:"address_region",class:"text-red-500 text-xs italic mt-2"}),l(o(c),{name:"address_city",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[ke,l(o(i),{name:"consultation_path",as:"select",modelValue:a.consultation_path,"onUpdate:modelValue":t[11]||(t[11]=s=>a.consultation_path=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:I(()=>[Ve,$e,Ce,Ie,Ue]),_:1},8,["modelValue"]),l(o(c),{name:"consultation_path",class:"text-red-500 text-xs italic mt-2"})]),e("div",{class:"flex justify-between mt-4"},[e("button",{type:"button",onClick:b,class:"bg-gray-400 text-white rounded-md p-2 w-[80px]"}," 취소 "),Me])]),_:1},8,["validation-schema","initial-values"])])])],2)],64))}},je=e("section",null,[e("div",{class:"w-full sm:container"},[e("div",{class:"border-black border-l-[5px] pl-5"},[e("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"내담자 관리")])])],-1),Fe={class:"lg:flex lg:items-center lg:justify-between mb-2"},Be={class:"min-w-0 flex-1"},Ee={class:"relative"},Pe=e("div",{class:"absolute inset-y-0 rtl:inset-r-0 start-0 flex items-center ps-3 pointer-events-none"},[e("svg",{class:"w-4 h-4 text-gray-500 dark:text-gray-400","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 20 20"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m19 19-4-4m0-7A7 7 0 1 1 1 8a7 7 0 0 1 14 0Z"})])],-1),qe={class:"mt-5 flex lg:ml-4 lg:mt-0"},Ne={class:"sm:ml-3"},ze={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},Le={class:"w-full text-sm text-left rtl:text-right text-gray-500 dark:text-gray-400"},Te=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3"},"내담자명"),e("th",{scope:"col",class:"px-6 py-3"},"내담자 휴대전화"),e("th",{scope:"col",class:"px-6 py-3"},"내담자 이메일"),e("th",{scope:"col",class:"px-6 py-3"},"상담사"),e("th",{scope:"col",class:"px-6 py-3"},"상담상태"),e("th",{scope:"col",class:"px-6 py-3"},"Action")])],-1),Ae={scope:"row",class:"px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white"},Oe={class:"px-6 py-4"},De={class:"px-6 py-4"},Ke={class:"px-6 py-4"},Qe={key:0,class:"flex items-center"},Je={key:1,class:"flex items-center"},Ze=["onClick"],Ge={class:"px-6 py-4"},He=["onUpdate:modelValue","onChange"],Re=e("option",{value:"1"},"상담진행",-1),We=e("option",{value:"2"},"상담보류",-1),Xe=e("option",{value:"3"},"상담종결",-1),Ye=[Re,We,Xe],et={class:"px-6 py-4"},tt={class:"flex items-center space-x-2"},st=["onClick"],dt={__name:"ClientList",setup(h){const $=P("showModal"),u=p(1),m=p(10),v=p(0),x=p(!1),y=p(""),k=p(""),a=p([]),b=t=>{y.value=String(t),x.value=!x.value,x.value||(y.value="",f(u.value))},f=async t=>{const s=await E(t);a.value=s.items,u.value=s.page,m.value=s.size,v.value=s.total},M=async()=>{try{const t=await E(1,10,k.value);a.value=t.items,u.value=t.page,m.value=t.size,v.value=t.total}catch(t){console.error("Error fetching clients:",t)}},S=t=>{f(t),u.value=t},n=async t=>{console.log("client:",t);try{await H(t.id,t.consultant_status),$("상담상태 정보가 수정되었습니다.")}catch(s){$("상담상태 정보 등록 중 오류가 발생했습니다."),console.error("Error registering client data:",s)}};return q(f),(t,s)=>(g(),_(U,null,[je,e("div",Fe,[e("div",Be,[e("div",Ee,[Pe,F(e("input",{type:"text",id:"table-search-users",name:"search-text","onUpdate:modelValue":s[0]||(s[0]=r=>k.value=r),class:"block pt-2 ps-10 text-sm text-gray-900 border border-gray-300 rounded-lg w-80 bg-gray-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500",placeholder:"내담자 검색",onKeyup:K(M,["enter"])},null,544),[[D,k.value]])])]),e("div",qe,[e("span",Ne,[e("button",{type:"button",onClick:b,class:"inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[l(o(X),{class:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),V(" 내담자 등록 ")])])])]),e("div",ze,[e("table",Le,[Te,e("tbody",null,[(g(!0),_(U,null,N(a.value,r=>(g(),_("tr",{key:r.id,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("th",Ae,w(r.client_name),1),e("td",Oe,w(r.phone_number),1),e("td",De,w(r.email_address),1),e("td",Ke,[r.consultant?(g(),_("div",Qe,w(r.consultant),1)):B("",!0),r.consultant?B("",!0):(g(),_("div",Je,[e("button",{class:"text-blue-600 dark:text-blue-500 hover:underline font-semibold border py-1 px-3 rounded-lg bg-blue-100 dark:bg-blue-800 dark:border-blue-600 dark:hover:bg-blue-700 dark:hover:border-blue-700 dark:text-white dark:hover:text-white dark:hover:bg-blue-700 dark:hover:border-blue-700",onClick:C=>b(r.id)}," 상담자배정 ",8,Ze)]))]),e("td",Ge,[F(e("select",{class:"w-24 h-9 bg-gray-100 border border-gray-300 rounded-md px-2 text-sm","onUpdate:modelValue":C=>r.consultant_status=C,onChange:C=>n(r)},Ye,40,He),[[Q,r.consultant_status]])]),e("td",et,[e("div",tt,[e("a",{href:"#",onClick:C=>b(r.id),class:"font-medium text-blue-600 dark:text-blue-500 hover:underline"},"내담자정보",8,st)])])]))),128))])]),l(R,{"total-items":v.value,"current-page":u.value,"items-per-page":m.value,onPageChanged:S},null,8,["total-items","current-page","items-per-page"]),l(Se,{isVisible:x.value,clientId:y.value,onClose:b},null,8,["isVisible","clientId"])])],64))}};export{dt as default};
