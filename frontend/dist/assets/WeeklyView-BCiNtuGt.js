import{V as oe,y as v,z as re,W as R,r as ne,o as d,d as u,e as t,q as x,x as Z,O as _,w as F,g,t as h,F as D,A as k,j as W,S as N,H as j}from"./index-DKmjRwNS.js";import{_ as ce,a as ie,f as de,r as ue,b as he,d as be}from"./DailyViewSliding-2KpxxwFg.js";import{u as ge,a as pe}from"./teacherStore-C4-Ezgdg.js";import"./client-DEiPUpvg.js";import"./program-BfI7pwnr.js";const fe=t("section",null,[t("div",{class:"w-full sm:container"},[t("div",{class:"border-black border-l-[5px] pl-5"},[t("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"주간 일정")])])],-1),ve={class:"max-w-full mx-auto p-4"},me={class:"flex justify-between items-center"},we={class:"inline-flex rounded-lg border border-gray-200 bg-white p-1"},xe=t("span",{class:"text-sm font-medium"}," 주간 ",-1),De=t("span",{class:"text-sm font-medium"}," 월간 ",-1),_e={class:"flex items-center space-x-2"},ke={class:"text-xl font-semibold"},ye={class:"flex space-x-2 text-sm font-semibold"},Se=t("span",null,"Today",-1),Ce=[Se],$e={class:"not-prose relative bg-slate-50 rounded-xl overflow-hidden w-full mx-auto dark:bg-slate-800/25"},Me={class:"relative rounded-xl overflow-auto"},Te={class:"mx-4 mt-4 box-content bg-white dark:bg-slate-800 shadow-xl overflow-hidden"},Ve={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 h-auto"},Fe=t("div",{class:"row-start-[1] col-start-[1] sticky top-0 bg-white dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2"},null,-1),Ye={class:"sm:inline-block rounded-full bg-slate-400 w-5 h-5 text-white font-semibold"},He={class:"mx-4 mb-4 box-content bg-white dark:bg-slate-800 shadow-xl overflow-y-auto max-h-[calc(100vh-200px)]"},Ee={class:"grid grid-cols-[70px,repeat(7,1fr)] grid-rows-1 max-h-full h-full"},We={class:"flex-row h-full"},Ne=t("div",{class:"w-0 h-0 border-t-[6px] border-t-transparent border-b-[6px] border-b-transparent border-l-[10px] border-l-red-500"},null,-1),je=[Ne],ze=["onClick"],Be=t("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[30px]"},null,-1),Ie=t("div",{class:"absolute left-0 w-full border-t border-slate-100 top-[60px]"},null,-1),Le=["onClick"],Oe={class:"flex justify-between items-center px-1 w-full"},Ae={class:"inline-block"},qe={class:"ml-auto inline-block whitespace-nowrap overflow-hidden text-ellipsis"},Pe={class:"flex justify-between items-center px-1 w-full"},Re=t("span",{class:"inline-block"},"상담사",-1),Ze={class:"ml-auto inline-block"},Ge={class:"flex justify-between items-center px-1 w-full"},Je=t("span",{class:"inline-block"},"상담시간",-1),Ke={class:"ml-auto inline-block"},Qe=["onClick"],Ue=t("div",{class:"absolute inset-0 pointer-events-none border border-black/5 rounded-xl dark:border-white/5"},null,-1),rt={__name:"WeeklyView",setup(Xe){const y=ge(),G=pe(),Y=oe({}),S=v(!1),C=v(!1),$=v(""),H=v(""),p=v(""),m=v(""),E=v([]),n=v({}),w=new Date,J=["Mon","Tue","Web","Thu","Fri","Sat","Sun"];function K(e){return e<10?`0${e}:00`:`${e}:00`}const M=e=>{const s=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return`${s}-${a}-${l}`},Q=e=>{const s=[];for(let a=0;a<7;a++){const l=new Date(e);l.setDate(e.getDate()+a);const o=l.getDay()-1;s.push({date:M(l),day:J[o===-1?6:o]})}return s},T=()=>{S.value=!S.value,S.value||($.value="",p.value="",m.value="",f(n.value.currentYear,n.value.currentMonth,n.value.currentDay))},z=()=>{C.value=!C.value,C.value||(p.value="",m.value="",f(n.value.currentYear,n.value.currentMonth,n.value.currentDay))},U=e=>{p.value=e,z()},X=(e,s,a)=>{const l=a.target.getBoundingClientRect(),o=a.clientY-l.top,i=l.height;let c=0;o<i/3?c=0:o<i*2/3?c=20:c=40,$.value="",H.value="",p.value="",p.value=e,m.value=`${s}:${c.toString().padStart(2,"0")}`,T(),console.log("currentScheduleTime:",m.value)},B=(e,s,a)=>{$.value=String(e),H.value=String(s),p.value=a,T()},f=async(e,s,a)=>{e=e||new Date().getFullYear(),s=s||new Date().getMonth()+1,a=a||new Date().getDate(),console.log("year:",e,"month:",s,"day:",a);try{const l=await de(e,s,a);E.value=l.data,V(e,s-1,a),console.log("schedule_data:",E.value)}catch(l){console.error("Error fetching monthly schedule data:",l)}},ee=(e,s,a)=>{const l=new Date(e,s,a);console.log("date:",l);let o=l.getDay();o=o===0?6:o-1;const i=new Date(l);i.setDate(l.getDate()-o);const c=new Date(i);c.setDate(i.getDate()+6);const r=new Date(i);r.setDate(i.getDate()-1);const b=new Date(c);return b.setDate(c.getDate()+1),{currentYear:e,currentMonth:s+1,currentDay:a,weekStartDate:i,weekEndDate:c,prevStartDate:r,nextEndDate:b}},te=()=>{const e=n.value.prevStartDate.getFullYear(),s=n.value.prevStartDate.getMonth()+1,a=n.value.prevStartDate.getDate();V(e,s,a),f(e,s,a)},se=()=>{const e=n.value.nextEndDate.getFullYear(),s=n.value.nextEndDate.getMonth()+1,a=n.value.nextEndDate.getDate();V(e,s,a),f(e,s,a)},V=(e,s,a)=>{n.value=ee(e,s,a),n.value.weekDates=Q(n.value.weekStartDate),console.log("set Date Info - currentDateInfo:",n.value)},ae=(e,s)=>{const a=new Date(`2000-01-01 ${e}`),o=(new Date(`2000-01-01 ${s}`)-a)/(1e3*60);return o>=50?80:o/50*80},le=e=>{const[s,a]=e.split(":").map(Number);return a/60*90};return re(()=>{p.value=M(new Date),m.value=K(new Date().getHours());const e=new Date().getFullYear(),s=new Date().getMonth()+1,a=new Date().getDate();V(e,s,a),f(e,s,a)}),R(()=>y.selectedDate,e=>{e&&f(e.getFullYear(),e.getMonth()+1,e.getDate())}),R(()=>G.selectedTeachers,e=>{e&&f(y.selectedDate.getFullYear(),y.selectedDate.getMonth()+1,y.selectedDate.getDate())}),(e,s)=>{const a=ne("router-link");return d(),u(D,null,[fe,t("div",ve,[t("div",me,[t("div",we,[x(a,{to:"/admin/weekly",class:_(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/weekly"}])},{default:Z(()=>[xe]),_:1},8,["class"]),x(a,{to:"/admin/monthly",class:_(["inline-flex items-center gap-2 rounded-md px-4 py-2 text-sm text-gray-700 hover:text-gray-900",{"bg-blue-500 text-white":e.$route.path==="/admin/monthly"}])},{default:Z(()=>[De]),_:1},8,["class"])]),t("div",_e,[t("button",{onClick:s[0]||(s[0]=F(l=>te(),["stop"])),class:"p-2 rounded-full font-semibold"},[x(g(ue),{class:"w-6 h-6"})]),t("h2",ke,h(M(n.value.weekStartDate))+" ~ "+h(M(n.value.weekEndDate)),1),t("button",{onClick:s[1]||(s[1]=F(l=>se(),["stop"])),class:"p-2 rounded-full font-semibold"},[x(g(he),{class:"w-6 h-6"})])]),t("div",ye,[t("button",{onClick:s[2]||(s[2]=l=>f(g(w).getFullYear(),g(w).getMonth()+1,g(w).getDate())),class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center"},Ce),t("button",{onClick:T,class:"px-4 py-2 bg-blue-500 text-white rounded-md"}," 상담 등록 ")])])]),t("div",$e,[t("div",Me,[t("div",Te,[t("div",Ve,[Fe,(d(!0),u(D,null,k(n.value.weekDates,(l,o)=>(d(),u("div",{key:o,class:_(["row-start-[1] col-start-[{{ index + 2 }}] sticky top-0 dark:bg-gradient-to-b dark:from-slate-600 dark:to-slate-700 border-slate-100 dark:border-black/10 bg-clip-padding text-slate-900 dark:text-slate-200 border-b text-sm font-medium py-2 text-center",l.date===g(w).toISOString().split("T")[0]?"bg-yellow-100":"bg-white"])},[t("span",Ye,h(l.date.split("-")[2]),1),W(" "+h(l.day),1)],2))),128))])]),t("div",He,[t("div",Ee,[t("div",We,[(d(),u(D,null,k(11,l=>t("div",{key:l,class:"h-[90px] border-slate-100 dark:border-slate-200/5 border-r text-xs p-1.5 text-right text-slate-400 uppercase sticky left-0 bg-white dark:bg-slate-800 font-medium relative"},[g(w).getHours()>=l+7&&g(w).getHours()<l+8?(d(),u("div",{key:0,class:"absolute left-0",style:N({top:`${g(w).getMinutes()/60*90}px`})},je,4)):j("",!0),W(" "+h(l+7>=12?`${(l+7)%12||12} PM`:`${l+7} AM`),1)])),64))]),(d(!0),u(D,null,k(E.value,(l,o)=>(d(),u("div",{key:o,class:"flex-row h-full items-center text-center border-slate-100 dark:border-slate-200/5 border-r divide-y divide-slate-100 dark:divide-slate-200"},[(d(!0),u(D,null,k(l,(i,c)=>(d(),u("div",{key:c,onClick:r=>X(o,c,r),class:_(["h-[90px] text-xs text-slate-400 font-medium p-[1px] relative",o===new Date().toISOString().split("T")[0]?"bg-yellow-100":""])},[Be,Ie,o==new Intl.DateTimeFormat("fr-CA").format(new Date)&&c==Math.floor(new Date().getHours())?(d(),u("div",{key:0,class:"absolute left-0 w-full border-t border-red-500 border-dashed",style:N({top:`${new Date().getMinutes()/60*90}px`})},null,4)):j("",!0),(d(!0),u(D,null,k(i,(r,b)=>{var I,L,O,A,q,P;return d(),u("div",{class:_(["absolute flex-row text-xs text-black border border-gray-700 rounded-md m-1 space-y-1 w-full pt-1 border-blue-700",["transform transition duration-500 ease-in-out overflow-hidden absolute",(L=(I=Y[o])==null?void 0:I[c])!=null&&L[b]?"scale-105 w-full pt-1 border-blue-700":"scale-100"]]),key:b,style:N({backgroundColor:(A=(O=Y[o])==null?void 0:O[c])!=null&&A[b]?"rgb(255, 255, 255)":`${r.teacher_usercolor}`,zIndex:(P=(q=Y[o])==null?void 0:q[c])!=null&&P[b]?10:1,height:ae(r.start_time,r.finish_time)+"px",left:b>0?b*20+"px":"0px",width:b>0?"calc(98% - "+b*20+"px)":"98%",top:le(r.start_time)+"px"}),onClick:F(et=>B(r.schedule_id,r.id,r.schedule_date),["stop"])},[t("div",Oe,[t("span",Ae,h(r.schedule_time),1),t("span",qe,"["+h(r.client_name)+"] "+h(r.program_name.length>10?r.program_name.slice(0,10)+"...":r.program_name),1)]),t("div",Pe,[Re,t("span",Ze,h(r.teacher_fullname),1)]),t("div",Ge,[Je,t("span",Ke,h(r.start_time)+" ~ "+h(r.finish_time),1)])],14,Le)}),128)),i.length>2?(d(),u("div",{key:1,class:"flex items-center justify-center ml-auto w-6 h-5 text-xs text-black border border-blue-700/10 rounded-md m-1 bg-blue-400/20",onClick:F(r=>U(o),["stop"])},[x(g(be),{class:"w-5 h-4"}),W(" "+h(i.length-2),1)],8,Qe)):j("",!0)],10,ze))),128))]))),128))])])]),Ue,x(ce,{isVisible:S.value,scheduleId:$.value,scheduleListId:H.value,scheduleDate:p.value,scheduleTime:m.value,onClose:T,class:"z-20"},null,8,["isVisible","scheduleId","scheduleListId","scheduleDate","scheduleTime"]),x(ie,{isDailyViewSlidingVisible:C.value,scheduleDate:p.value,scheduleTime:m.value,onClose:z,onClickCalendarSchedule:B,class:"z-10"},null,8,["isDailyViewSlidingVisible","scheduleDate","scheduleTime"])])],64)}}};export{rt as default};
