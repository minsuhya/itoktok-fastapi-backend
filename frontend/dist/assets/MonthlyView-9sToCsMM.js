import{o as c,d as u,e,z as Z,u as W,i as G,q as m,c as K,a as $,M as L,s as Q,N as P,O as R,J as H,n as r,p as A,g as n,A as x,f as X,v as ee,F as U,x as E,t as k,E as w,B as te,j as C,y as se,C as ae}from"./index-CE53uhnG.js";import{e as le}from"./user-BfN4M55-.js";import{s as oe}from"./client-B0BWABNs.js";import{r as ne,a as re}from"./ChevronRightIcon-14dceJlg.js";function de(g,p){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z"})])}function ie(g,p){return c(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z","clip-rule":"evenodd"})])}const ce=async g=>Z.post("/schedules",g),ue=async(g,p)=>Z.get(`/schedules/calendar/${g}/${p}`),me={className:"w-full bg-neutral-50 shadow-lg rounded-lg p-6"},he={className:"border-b pb-2 mb-4"},be=e("h2",{class:"font-title font-bold"},"상담일정",-1),ge=e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18 18 6M6 6l12 12"})],-1),pe=[ge],fe={class:"grid gap-4"},ve={class:"mb-4"},xe=e("label",{for:"client-search",class:"block text-sm font-medium text-gray-700"},"내담자를 선택하세요.",-1),_e={class:"relative mt-1"},ye={class:"absolute inset-y-0 right-0 flex items-center pr-3"},we={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto"},ke=["onClick"],Ve={key:1,class:"absolute mt-2 text-sm text-gray-500"},Me={class:"grid grid-cols-1 gap-4"},De={class:"mb-4"},$e=e("label",{for:"password",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[C("상담사 "),e("span",{class:"text-red-500"},"*")],-1),Ce={class:"grid grid-cols-2 gap-4"},Se=e("label",{class:"block mb-1 text-gray-700"},[C("내담자 이름 "),e("span",{class:"text-red-500"},"*")],-1),Ie=e("label",{class:"block mb-1 text-gray-700"},[C("내담자 휴대전화번호 "),e("span",{class:"text-red-500"},"*")],-1),Ne={class:"mb-4"},Ue=e("label",{for:"email",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[C("일정제목 "),e("span",{class:"text-red-500"},"*")],-1),Fe={class:"grid grid-cols-2 gap-4"},Ye={class:"mb-4"},je=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[C("일정시작일 "),e("span",{class:"text-red-500"},"*")],-1),Te={class:"mb-4"},Be=e("label",{for:"finish_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[C("일정종료일 "),e("span",{class:"text-red-500"},"*")],-1),Ee={class:"grid grid-cols-2 gap-4"},qe={class:"mb-4"},Oe=e("label",{for:"start_date",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[C("시작시간 "),e("span",{class:"text-red-500"},"*")],-1),He=["value"],ze={class:"mb-4"},Ae=e("label",{for:"finish_time",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[C("종료시간 "),e("span",{class:"text-red-500"},"*")],-1),Je=["value"],Ze=e("label",{class:"block mb-1 text-gray-700"},"메모",-1),Le=e("div",{class:"text-right text-gray-500 text-sm"},"0 / 100",-1),Pe=e("button",{type:"submit",class:"bg-green-600 text-white rounded-md p-2 w-[80px]"}," 확인 ",-1),We={__name:"ScheduleFormSliding",props:{isVisible:Boolean,scheduleId:String,scheduleDate:String},emits:["close"],setup(g,{emit:p}){W();const q=G("showModal"),S=p,f=g,V=m(""),F=m([]),I=m([]),b=m({id:"",name:""}),j=async()=>{const a=V.value.toLowerCase();if(!a){I.value=[];return}try{const t=await oe(a);F.value=t.data,I.value=F.value}catch(t){console.error("Error fetching clients:",t)}},v=async a=>{b.value=a,V.value=a.client_name,l.client_name=a.client_name,l.phone_number=a.phone_number,I.value=[];try{const t=await le(a.consultant);b.value.consultant=t.username,b.value.consultant_name=t.full_name}catch(t){console.error("Error fetching clients:",t)}},M=m(null),T=m(null),B=m([]),D=m([]),O=()=>{const a=[];let t=new Date;for(t.setHours(9,0,0,0);t.getHours()<18;)a.push(o(t)),t.setMinutes(t.getMinutes()+10);return a},o=a=>{const t=a.getHours().toString().padStart(2,"0"),s=a.getMinutes().toString().padStart(2,"0");return`${t}:${s}`},d=()=>{if(!M.value)return;const[a,t]=M.value.split(":").map(Number),s=new Date;s.setHours(a,t,0,0);const z=[],J=new Date(s);J.setHours(s.getHours()+1);let Y=new Date(s);for(Y.setMinutes(Y.getMinutes()+10);Y<=J;)z.push(o(Y)),Y.setMinutes(Y.getMinutes()+10);D.value=z,T.value=D.value[0]},i=K({consultant_name:$().required("내담자를 선택해주세요."),client_name:$().required("내담자를 선택해주세요."),phone_number:$().required("휴대전화번호를 입력하세요."),title:$().required("일정제목을 입력해주세요."),start_date:$().required("일정시작일을 선택해주세요."),finish_date:$().required("일정종료일을 선택해주세요."),start_time:$().required("시작시간을 선택해주세요."),finish_time:$().required("종료시간을 선택해주세요.")}),l=L({id:"",teacher_username:"",client_id:"",title:"",start_date:f.scheduleDate,finish_date:f.scheduleDate,start_time:o(new Date),finish_time:o(new Date),memo:""}),h=()=>{S("close")},_=async()=>{if(!f.scheduleId){Object.keys(l).forEach(a=>{l[a]=""}),console.log("scheduleDate:",f.scheduleDate),l.start_date=f.scheduleDate,l.finish_date=f.scheduleDate;return}console.log("scheduleId",f.scheduleId);try{const a=await readSchedule(f.scheduleId);console.log("scheduleInfo:",a),Object.assign(l,a)}catch(a){console.error("Error fetching user:",a)}},y=async()=>{try{await ce(l),q("상담일정 정보가 등록되었습니다.")}catch(a){q("상담일정 정보 등록 중 오류가 발생했습니다."),console.error("Error registering client data:",a)}};Q(()=>{_()}),P(()=>{B.value=O(),console.log(B.value)});const N=async a=>{console.log("submitting:",a),Object.assign(l,a),await y(),S("close")};return R(()=>f.scheduleDate,(a,t)=>{console.log("newScheduleDate:",a),l.start_date=a,l.finish_date=a}),(a,t)=>(c(),u(U,null,[e("div",{onClick:h,class:H(["fixed inset-0 bg-black bg-opacity-50 transition-opacity duration-1000",{"opacity-100 block":g.isVisible,"opacity-0 hidden":!g.isVisible}])},null,2),e("div",{class:H(["fixed top-0 right-0 w-1/3 h-full bg-white shadow-lg p-4 overflow-auto z-50 transition-transform duration-1000 ease-in-out",{"translate-x-full":!g.isVisible,"translate-x-0":g.isVisible}])},[e("div",me,[e("div",he,[e("div",{class:"flex items-center justify-evenly mb-2"},[be,e("button",{class:"ml-auto",onClick:h},pe)]),r(n(te),{onSubmit:N,"validation-schema":n(i),"initial-values":l,class:"space-y-4 text-sm"},{default:A(()=>[r(n(x),{type:"hidden",name:"teacher_username",modelValue:b.value.consultant,"onUpdate:modelValue":t[0]||(t[0]=s=>b.value.consultant=s)},null,8,["modelValue"]),r(n(x),{type:"hidden",name:"client_id",modelValue:b.value.id,"onUpdate:modelValue":t[1]||(t[1]=s=>b.value.id=s)},null,8,["modelValue"]),e("div",fe,[e("div",ve,[xe,e("div",_e,[X(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>V.value=s),onInput:j,type:"text",id:"client-search",placeholder:"내담자 검색...",class:"block w-full py-2 pr-10 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,544),[[ee,V.value]]),e("div",ye,[r(n(ie),{class:"h-5 w-5 text-gray-400","aria-hidden":"true"})]),e("div",null,[I.value.length>0?(c(),u("ul",we,[(c(!0),u(U,null,E(I.value,s=>(c(),u("li",{key:s.id,onClick:z=>v(s),class:"cursor-pointer px-3 py-2 hover:bg-indigo-600 hover:text-white"},k(s.client_name),9,ke))),128))])):(c(),u("p",Ve,"검색 결과가 없습니다."))])])])]),e("div",Me,[e("div",De,[$e,r(n(x),{type:"text",name:"consultant_name",readonly:"",modelValue:b.value.consultant_name,"onUpdate:modelValue":t[3]||(t[3]=s=>b.value.consultant_name=s),class:"mt-1 block w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),r(n(w),{name:"consultant_name",class:"text-red-500 text-xs italic mt-2"})])]),e("div",Ce,[e("div",null,[Se,r(n(x),{name:"client_name",as:"input",type:"text",modelValue:l.client_name,"onUpdate:modelValue":t[4]||(t[4]=s=>l.client_name=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 이름을 입력하세요."},null,8,["modelValue"]),r(n(w),{name:"client_name",class:"text-red-500 text-xs italic mt-2"})]),e("div",null,[Ie,r(n(x),{name:"phone_number",as:"input",type:"text",modelValue:l.phone_number,"onUpdate:modelValue":t[5]||(t[5]=s=>l.phone_number=s),class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",placeholder:"내담자 휴대전화번호를 입력하세요."},null,8,["modelValue"]),r(n(w),{name:"phone_number",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[e("div",Ne,[Ue,r(n(x),{type:"text",name:"title",modelValue:l.title,"onUpdate:modelValue":t[6]||(t[6]=s=>l.title=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),r(n(w),{name:"title",class:"text-red-500 text-xs italic mt-2"})])]),e("div",Fe,[e("div",Ye,[je,r(n(x),{type:"date",name:"start_date",modelValue:l.start_date,"onUpdate:modelValue":t[7]||(t[7]=s=>l.start_date=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),r(n(w),{name:"start_date",class:"text-red-500 text-xs italic mt-2"})]),e("div",Te,[Be,r(n(x),{type:"date",name:"finish_date",modelValue:l.finish_date,"onUpdate:modelValue":t[8]||(t[8]=s=>l.finish_date=s),class:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white"},null,8,["modelValue"]),r(n(w),{name:"finish_date",class:"text-red-500 text-xs italic mt-2"})])]),e("div",Ee,[e("div",qe,[Oe,r(n(x),{name:"start_time",id:"start_time",modelValue:M.value,"onUpdate:modelValue":t[9]||(t[9]=s=>M.value=s),as:"select",onChange:d,class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:A(()=>[(c(!0),u(U,null,E(B.value,s=>(c(),u("option",{key:s,value:s},k(s),9,He))),128))]),_:1},8,["modelValue"]),r(n(w),{name:"start_time",class:"text-red-500 text-xs italic mt-2"})]),e("div",ze,[Ae,r(n(x),{name:"finish_time",id:"finish_time",modelValue:T.value,"onUpdate:modelValue":t[10]||(t[10]=s=>T.value=s),as:"select",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2"},{default:A(()=>[(c(!0),u(U,null,E(D.value,s=>(c(),u("option",{key:s,value:s},k(s),9,Je))),128))]),_:1},8,["modelValue"]),r(n(w),{name:"finish_time",class:"text-red-500 text-xs italic mt-2"})])]),e("div",null,[Ze,r(n(x),{name:"memo",as:"textarea",class:"w-full bg-neutral-50 border border-gray-300 rounded-md p-2",rows:"3",modelValue:l.memo,"onUpdate:modelValue":t[11]||(t[11]=s=>l.memo=s),placeholder:"내담자의 상담정보를 메모해보세요. 최대 100자 까지 입력하실 수 있습니다."},null,8,["modelValue"]),r(n(w),{name:"memo",class:"text-red-500 text-xs italic mt-2"}),Le]),e("div",{class:"flex justify-between mt-4"},[e("button",{type:"button",onClick:h,class:"bg-gray-400 text-white rounded-md p-2 w-[80px]"}," 취소 "),Pe])]),_:1},8,["validation-schema","initial-values"])])])],2)],64))}},Ge=e("section",null,[e("div",{class:"w-full sm:container"},[e("div",{class:"border-black border-l-[5px] pl-5"},[e("h2",{class:"text-dark mb-2 text-2xl font-semibold dark:text-white"},"Monthly Schedule")])])],-1),Ke={class:"max-w-full mx-auto p-4"},Qe={class:"flex justify-between items-center mb-4"},Re={class:"flex items-center space-x-2"},Xe={class:"text-xl font-semibold"},et={class:"flex space-x-2 text-sm font-semibold"},tt=e("span",null,"Today",-1),st=[tt],at={class:"grid grid-cols-7 gap-px bg-gray-200 rounded-lg overflow-hidden text-sm"},lt=se('<div class="bg-white py-2 text-center text-sm font-medium">Mon</div><div class="bg-white py-2 text-center text-sm font-medium">Tue</div><div class="bg-white py-2 text-center text-sm font-medium">Wed</div><div class="bg-white py-2 text-center text-sm font-medium">Thu</div><div class="bg-white py-2 text-center text-sm font-medium">Fri</div><div class="bg-white py-2 text-center text-sm font-medium">Sat</div><div class="bg-white py-2 text-center text-sm font-medium">Sun</div>',7),ot=["onClick"],nt=["onClick"],rt={class:"flex justify-between"},dt={class:"inline-block"},it={class:"ml-auto inline-block text-blue-700"},ct={key:0,class:"mt-4 flex items-center justify-center text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-0.5 bg-blue-400/20"},gt={__name:"MonthlyView",setup(g){const p=L({}),q=(o,d,i)=>{i.stopPropagation(),p[o]||(p[o]={}),p[o][d]=!p[o][d]},S=m(!1),f=m(""),V=m(""),F=()=>{S.value=!S.value,S.value||(f.value="",V.value="")};m("");const I=o=>{console.log("clickedDate:",o),V.value=o,F()},b=["January","February","March","April","May","June","July","August","September","October","November","December"],j=m([]),v=m({}),M=m(""),T=o=>{const d=o.getFullYear(),i=String(o.getMonth()+1).padStart(2,"0"),l=String(o.getDate()).padStart(2,"0");return`${d}-${i}-${l}`};M.value=T(new Date),console.log("today:",M.value);const B=(o,d)=>{const i=new Date(o,d,1),l=i.getFullYear(),h=i.getMonth()+1;let _=l,y=h-1;y===0&&(y=12,_-=1);let N=l,a=h+1;return a===13&&(a=1,N+=1),console.log("currentYear:",l,"currentMonth:",h),{currentDate:i,currentYear:l,currentMonth:h,currentMonthName:b[h-1],prevYear:_,prevMonth:y,prevMonthName:b[y-1],nextYear:N,nextMonth:a,nextMonthName:b[a-1]}},D=async(o,d)=>{o||(o=new Date().getFullYear()),d||(d=new Date().getMonth()+1);try{const i=await ue(o,d);j.value=i.data,O(o,d-1),console.log("schedule_data:",j.value)}catch(i){console.error("Error fetching monthly schedule data:",i)}},O=(o,d)=>{v.value=B(o,d)};return P(()=>{const o=new Date().getFullYear(),d=new Date().getMonth();O(o,d),D(v.value.currentYear,v.value.currentMonth)}),(o,d)=>(c(),u(U,null,[Ge,e("div",Ke,[e("div",Qe,[e("div",Re,[e("button",{class:"p-2 rounded-full font-semibold",onClick:d[0]||(d[0]=i=>D(v.value.prevYear,v.value.prevMonth))},[r(n(ne),{class:"w-6 h-6"})]),e("h2",Xe,k(v.value.currentMonthName)+" "+k(v.value.currentYear),1),e("button",{class:"p-2 rounded-full font-semibold",onClick:d[1]||(d[1]=i=>D(v.value.nextYear,v.value.nextMonth))},[r(n(re),{class:"w-6 h-6"})])]),e("div",et,[e("button",{class:"px-4 py-2 bg-white border border-gray-300 rounded-md flex items-center",onClick:d[2]||(d[2]=i=>D())},st),e("button",{class:"px-4 py-2 bg-blue-500 text-white rounded-md",onClick:F},"상담 등록")])]),e("div",at,[lt,(c(!0),u(U,null,E(j.value,(i,l)=>(c(),u("div",{class:"bg-white h-32 p-2",key:l,onClick:h=>I(l)},[e("span",{class:H({"block text-sm bg-sky-500 text-white ring rounded-full font-semibold w-5 text-center":l===M.value})},k(l.split("-")[2]),3),(c(!0),u(U,null,E(i,(h,_)=>{var y,N;return c(),u("p",{class:H(["flex-row text-xs text-blue-600 border border-blue-700/10 rounded-md m-1 p-1 bg-blue-400/20 *:scale-100 [& *]:scale-100",{"transform transition duration-500 ease-in-out overflow-hidden":!0,"scale-100 h-6":!((y=p[l])!=null&&y[_]),"scale-150 h-auto":(N=p[l])==null?void 0:N[_]}]),key:_,onClick:a=>q(l,_,a)},[e("div",rt,[e("span",dt,"["+k(h.client_name)+"] "+k(h.title),1),e("span",it,k(h.schedule_time),1)])],10,nt)}),128)),i.length>2?(c(),u("div",ct,[r(n(de),{class:"w-4 h-4"})])):ae("",!0)],8,ot))),128))]),r(We,{isVisible:S.value,scheduleId:f.value,scheduleDate:V.value,onClose:F},null,8,["isVisible","scheduleId","scheduleDate"])])],64))}};export{gt as default};
